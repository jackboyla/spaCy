<!DOCTYPE html><html><head><meta charSet="utf-8"/><title>Dependencies and Relations · Prodigy  · An annotation tool for AI, Machine Learning &amp; NLP</title><link rel="icon" href="/favicon.ico"/><link rel="icon" href="/icon.png" type="image/png"/><link rel="apple-touch-icon" href="/icon.png" type="image/png"/><meta name="description" content="A downloadable annotation tool for LLMs, NLP and computer vision tasks such as named entity recognition, text classification, object detection, image segmentation, evaluation and more."/><meta property="og:url" content="prodi.gy"/><meta property="og:type" content="website"/><meta property="og:title" content="Dependencies and Relations · Prodigy  · An annotation tool for AI, Machine Learning &amp; NLP"/><meta property="og:description" content="A downloadable annotation tool for LLMs, NLP and computer vision tasks such as named entity recognition, text classification, object detection, image segmentation, evaluation and more."/><meta property="og:image" content="https://prodi.gy/social/local_relations.jpg"/><meta name="twitter:card" content="summary_large_image"/><meta property="twitter:domain" content="prodi.gy"/><meta property="twitter:url" content="https://prodi.gy/docs/dependencies-relations"/><meta name="twitter:title" content="Dependencies and Relations · Prodigy  · An annotation tool for AI, Machine Learning &amp; NLP"/><meta name="twitter:description" content="A downloadable annotation tool for LLMs, NLP and computer vision tasks such as named entity recognition, text classification, object detection, image segmentation, evaluation and more."/><meta name="twitter:image" content="https://prodi.gy/social/local_relations.jpg"/><meta name="twitter:creator" content="@explosion_ai"/><meta name="format-detection" content="telephone=no, date=no, email=no, address=no"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><link rel="preconnect" href="https://SCISPIJD8J-dsn.algolia.net" crossorigin="anonymous"/><meta name="next-head-count" content="21"/><link rel="preload" href="/_next/static/css/1efca3867242c893.css" as="style" crossorigin=""/><link rel="stylesheet" href="/_next/static/css/1efca3867242c893.css" crossorigin="" data-n-g=""/><link rel="preload" href="/_next/static/css/068467a0ba4a97d9.css" as="style" crossorigin=""/><link rel="stylesheet" href="/_next/static/css/068467a0ba4a97d9.css" crossorigin="" data-n-p=""/><link rel="preload" href="/_next/static/css/0f409e0135a0abde.css" as="style" crossorigin=""/><link rel="stylesheet" href="/_next/static/css/0f409e0135a0abde.css" crossorigin="" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" crossorigin="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-4cc149b93db63ee2.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/framework-0c7baedefba6b077.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/main-c379b48138cf9870.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/pages/_app-e5449eb6d34ad582.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/32e56759-c8500b4ce10e90e6.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/870-d3e05d3f0cd4956b.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/341-988af7ccc059c2e6.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/217-fb33acb6f97d09ce.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/pages/docs/%5Bid%5D-f84ef4dd9cd08356.js" defer="" crossorigin=""></script><script src="/_next/static/IUmjHA5LMQ1eQb0MNTwvU/_buildManifest.js" defer="" crossorigin=""></script><script src="/_next/static/IUmjHA5LMQ1eQb0MNTwvU/_ssgManifest.js" defer="" crossorigin=""></script></head><body class="__variable_2367ea __variable_cf10f9 __variable_fd30fa __variable_c7d2e2 __variable_9f41a4 __variable_4ac632"><div id="__next"><div></div><main class="layout_main__vhPRk __variable_2367ea __variable_cf10f9 __variable_fd30fa __variable_c7d2e2 __variable_9f41a4 __variable_4ac632"><header><span class="typography_logo__2WacH layout_logo__rhs7B docs_logo__Ecjzt"><a class="" href="/"><svg viewBox="0 0 540 158" width="1em" height="1em" fill="currentColor" class="typography_logo-logo__pKr4A" aria-label="Prodigy"><path d="M70.6 48.6c7 7.3 10.5 17 10.5 29.2s-3.3 22-10.4 29.2c-7 7.3-16 11-27 11-9.4 0-16.8-2.6-21.7-8v44.7H0V39h20.7v8c4.8-6.3 12.4-9.5 23-9.5 11 0 20 3.7 27 11zM22 76v3.6c0 12 7.2 19.8 18.2 19.8 11.2 0 18.7-8 18.7-21.6S51.3 56.2 40 56.2C29.2 56.2 22 64 22 76zM133.8 59.4c-12.6 0-20.5 7-20.5 17.8v39.3h-22V39h21v8.8c4-6.4 11.3-9.6 21.4-9.6v21.2zM209.5 107c-7.6 7.4-17.5 11.2-29.5 11.2s-22-3.8-29.7-11c-7.6-7.6-11.5-17.3-11.5-29.3 0-12.2 4-22 11.5-29.3 7.8-7.3 17.7-11 29.7-11s22 3.7 29.5 11c7.8 7.3 11.7 17 11.7 29.2 0 11.8-4 21.6-11.7 29zM180 56.3c-5.7 0-10.3 2-13.8 5.8s-5.2 9-5.2 15.7c0 6.7 1.8 12 5.2 15.7 3.4 3.8 8 5.7 13.8 5.7s10.3-1.8 13.8-5.6 5.2-9 5.2-15.7c0-6.8-1.8-12-5.2-15.7-3.5-3.8-8-5.8-13.8-5.8zM313 116.5h-20.5v-8c-4.4 5.6-12.7 9.7-23 9.7-11 0-20-3.8-27-11-7-7.5-10.5-17.2-10.5-29.4s3.5-22 10.3-29.2c7-7.3 16-11 27-11 9.7 0 17 2.6 22 8V0H313v116.5zm-58.8-38.7c0 13.6 7.5 21.4 18.7 21.4 10.8 0 18.2-7.3 18.2-19.8V76c0-12.2-7.3-19.8-18.3-19.8-11.3 0-18.8 8-18.8 21.6zM354 13.6c0 3.6-1.2 6.8-3.8 9.3-5 4.8-13.6 4.8-18.6 0C323.2 15.3 330-.3 341 .3c7.3 0 13 6 13 13.2zm-2 103h-22V39h22v77.5zM425 47v-8h20.6v80.4c0 11.2-3.6 20-10.6 26.8-7 6.7-16.6 10-28.5 10-23.4 0-37-11.4-40-29.8l21.8-.8c1 7.6 7.6 12 17.4 12 11.2 0 18-5.8 18-16.6v-11c-5 5.4-12.4 8-21.8 8-11 0-20-3.7-27-11s-10.4-17-10.4-29.2 3.5-22 10.3-29.2c7-7.3 16-11 27-11 10.6 0 18.3 3 23 9.5zM387 78c0 13.6 7.5 21.6 18.7 21.6 11 0 18.3-7.6 18.3-19.8V76c0-12.2-7.3-19.8-18.3-19.8-11.2 0-18.7 8-18.7 21.6zM488.8 154.8H465l19.8-45L454.5 39h24l18 46.2L514 39h24.3l-49.7 115.8z"></path></svg> <!-- -->local</a></span><nav class="layout_nav__4gLls docs_nav__o8Z8R"><ul><li class="layout_nav-item__N5stU"><a class="" href="/buy">Get Prodigy</a></li><li class="layout_nav-item__N5stU"><a class="" href="/docs">Documentation</a></li><li class="layout_nav-item__N5stU layout_has-sub__yK0O9"><a class="" href="/docs/dependencies-relations#">Features</a><div class="layout_nav-sub__Y0Nlh"><ul class="layout_nav-sub-list__8ABHi"><li><a class="layout_nav-sub-item__BrwrY" href="/features/information-extraction"><strong>Information Extraction<!-- --> </strong><div class="layout_nav-sub-meta___UATk">Get structured data from text</div></a></li><li><a class="layout_nav-sub-item__BrwrY" href="/features/language-model-training"><strong>Language Model Training<!-- --> </strong><div class="layout_nav-sub-meta___UATk">Train and fine-tune models</div></a></li><li><a class="layout_nav-sub-item__BrwrY" href="/features/computer-vision"><strong>Computer Vision<!-- --> </strong><div class="layout_nav-sub-meta___UATk">Classify and segment images</div></a></li><li><a class="layout_nav-sub-item__BrwrY" href="/features/audio-video"><strong>Audio &amp; Video<!-- --> </strong><div class="layout_nav-sub-meta___UATk">Classify and segment AV data</div></a></li><li><a class="layout_nav-sub-item__BrwrY" href="/features/prompt-engineering"><strong>Prompt Engineering<!-- --> </strong><div class="layout_nav-sub-meta___UATk">Develop better LLM prompts</div></a></li><li><a class="layout_nav-sub-item__BrwrY" href="/features/custom-workflows"><strong>Custom Workflows<!-- --> </strong><div class="layout_nav-sub-meta___UATk">Fully customize your experience</div></a></li></ul></div></li><li class="layout_nav-item__N5stU layout_has-sub__yK0O9"><a class="" href="/docs/dependencies-relations#">Industries</a><div class="layout_nav-sub__Y0Nlh"><ul class="layout_nav-sub-list__8ABHi"><li><a class="layout_nav-sub-item__BrwrY" href="/industries/banking-finance"><strong>Banking &amp; Finance<!-- --> </strong><div class="layout_nav-sub-meta___UATk">Financial data, risk assessment and market analysis</div></a></li><li><a class="layout_nav-sub-item__BrwrY" href="/industries/healthcare-biomedical"><strong>Healthcare &amp; Biomedical<!-- --> </strong><div class="layout_nav-sub-meta___UATk">Medical documents, clinical notes and pharmaceutical data</div></a></li><li><a class="layout_nav-sub-item__BrwrY" href="/industries/media-content-creation"><strong>Media &amp; Content Creation<!-- --> </strong><div class="layout_nav-sub-meta___UATk">Multi-media data, archives and user-generated content</div></a></li><li><a class="layout_nav-sub-item__BrwrY" href="/industries/legal-insurance"><strong>Legal &amp; Insurance<!-- --> </strong><div class="layout_nav-sub-meta___UATk">Legislative text, contracts, regulation and compliance</div></a></li><li><a class="layout_nav-sub-item__BrwrY" href="/industries/conversation-insights"><strong>Conversation &amp; Insights<!-- --> </strong><div class="layout_nav-sub-meta___UATk">Dialog systems, user interactions and actionable insights</div></a></li><li><a class="layout_nav-sub-item__BrwrY" href="/industries/research-education"><strong>Research &amp; Education<!-- --> </strong><div class="layout_nav-sub-meta___UATk">Academic papers, corpus creation and educational data</div></a></li></ul></div></li><li class="layout_nav-item__N5stU"><a target="_blank" class="" href="https://demo.prodi.gy">Demo</a></li><li class="layout_nav-item__N5stU"><a target="_blank" class="" href="https://explosion.ai/_/project/prodigy">Blog</a></li><li class="layout_nav-item__N5stU"><a target="_blank" class="" href="https://support.prodi.gy">Support</a></li></ul><div class="layout_search__wBRHo"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></nav></header><div class="layout_content__tnd92"><div class="docs_root__ya389"><div class="docs_sidebar__VY9X9"><nav><h3 class="typography_logo__2WacH docs_sidebar-logo__R40RP"><a class="" href="/"><svg viewBox="0 0 540 158" width="1em" height="1em" fill="currentColor" class="typography_logo-logo__pKr4A" aria-label="Prodigy"><path d="M70.6 48.6c7 7.3 10.5 17 10.5 29.2s-3.3 22-10.4 29.2c-7 7.3-16 11-27 11-9.4 0-16.8-2.6-21.7-8v44.7H0V39h20.7v8c4.8-6.3 12.4-9.5 23-9.5 11 0 20 3.7 27 11zM22 76v3.6c0 12 7.2 19.8 18.2 19.8 11.2 0 18.7-8 18.7-21.6S51.3 56.2 40 56.2C29.2 56.2 22 64 22 76zM133.8 59.4c-12.6 0-20.5 7-20.5 17.8v39.3h-22V39h21v8.8c4-6.4 11.3-9.6 21.4-9.6v21.2zM209.5 107c-7.6 7.4-17.5 11.2-29.5 11.2s-22-3.8-29.7-11c-7.6-7.6-11.5-17.3-11.5-29.3 0-12.2 4-22 11.5-29.3 7.8-7.3 17.7-11 29.7-11s22 3.7 29.5 11c7.8 7.3 11.7 17 11.7 29.2 0 11.8-4 21.6-11.7 29zM180 56.3c-5.7 0-10.3 2-13.8 5.8s-5.2 9-5.2 15.7c0 6.7 1.8 12 5.2 15.7 3.4 3.8 8 5.7 13.8 5.7s10.3-1.8 13.8-5.6 5.2-9 5.2-15.7c0-6.8-1.8-12-5.2-15.7-3.5-3.8-8-5.8-13.8-5.8zM313 116.5h-20.5v-8c-4.4 5.6-12.7 9.7-23 9.7-11 0-20-3.8-27-11-7-7.5-10.5-17.2-10.5-29.4s3.5-22 10.3-29.2c7-7.3 16-11 27-11 9.7 0 17 2.6 22 8V0H313v116.5zm-58.8-38.7c0 13.6 7.5 21.4 18.7 21.4 10.8 0 18.2-7.3 18.2-19.8V76c0-12.2-7.3-19.8-18.3-19.8-11.3 0-18.8 8-18.8 21.6zM354 13.6c0 3.6-1.2 6.8-3.8 9.3-5 4.8-13.6 4.8-18.6 0C323.2 15.3 330-.3 341 .3c7.3 0 13 6 13 13.2zm-2 103h-22V39h22v77.5zM425 47v-8h20.6v80.4c0 11.2-3.6 20-10.6 26.8-7 6.7-16.6 10-28.5 10-23.4 0-37-11.4-40-29.8l21.8-.8c1 7.6 7.6 12 17.4 12 11.2 0 18-5.8 18-16.6v-11c-5 5.4-12.4 8-21.8 8-11 0-20-3.7-27-11s-10.4-17-10.4-29.2 3.5-22 10.3-29.2c7-7.3 16-11 27-11 10.6 0 18.3 3 23 9.5zM387 78c0 13.6 7.5 21.6 18.7 21.6 11 0 18.3-7.6 18.3-19.8V76c0-12.2-7.3-19.8-18.3-19.8-11.2 0-18.7 8-18.7 21.6zM488.8 154.8H465l19.8-45L454.5 39h24l18 46.2L514 39h24.3l-49.7 115.8z"></path></svg> </a></h3><ul><li class="docs_sidebar-label__ECVjt">Get Started</li><li><a class="docs_sidebar-item__lo3cL" href="/docs"><span>Prodigy 101</span></a></li><li><a class="docs_sidebar-item__lo3cL" href="/docs/install"><span>Installation &amp; Setup</span></a></li><li><a class="docs_sidebar-item__lo3cL" href="/docs/changelog"><span>Changelog</span></a></li></ul><ul><li class="docs_sidebar-label__ECVjt">Usage</li><li><a class="docs_sidebar-item__lo3cL" href="/docs/named-entity-recognition"><span>Named Entity Recognition</span></a></li><li><a class="docs_sidebar-item__lo3cL" href="/docs/span-categorization"><span>Span Categorization</span></a></li><li><a class="docs_sidebar-item__lo3cL" href="/docs/text-classification"><span>Text Classification</span></a></li><li><a class="docs_sidebar-item__lo3cL docs_sidebar-active__9XUV1" href="/docs/dependencies-relations"><span>Dependencies &amp; Relations</span></a></li><li><a class="docs_sidebar-item__lo3cL" href="/docs/computer-vision"><span>Computer Vision</span></a></li><li><a class="docs_sidebar-item__lo3cL" href="/docs/audio-video"><span>Audio &amp; Video</span></a></li><li><a class="docs_sidebar-item__lo3cL" href="/docs/task-routing"><span>Task Routing</span></a></li><li><a class="docs_sidebar-item__lo3cL" href="/docs/large-language-models"><span>Large Language Models</span></a></li><li><a class="docs_sidebar-item__lo3cL" href="/docs/review"><span>Review</span></a></li><li><a class="docs_sidebar-item__lo3cL" href="/docs/custom-recipes"><span>Custom Recipes</span></a></li><li><a class="docs_sidebar-item__lo3cL" href="/docs/custom-interfaces"><span>Custom Interfaces</span></a></li><li><a class="docs_sidebar-item__lo3cL" href="/docs/metrics"><span>Metrics</span></a></li><li><a class="docs_sidebar-item__lo3cL" href="/docs/deployment"><span>Deployment</span></a></li></ul><ul><li class="docs_sidebar-label__ECVjt">API</li><li><a class="docs_sidebar-item__lo3cL" href="/docs/recipes"><span>Recipes</span></a></li><li><a class="docs_sidebar-item__lo3cL" href="/docs/api-interfaces"><span>Annotation Interfaces</span></a></li><li><a class="docs_sidebar-item__lo3cL" href="/docs/api-web-app"><span>Web Application</span></a></li><li><a class="docs_sidebar-item__lo3cL" href="/docs/api-loaders"><span>Loaders &amp; Input Data</span></a></li><li><a class="docs_sidebar-item__lo3cL" href="/docs/api-components"><span>Components &amp; Functions</span></a></li><li><a class="docs_sidebar-item__lo3cL" href="/docs/api-database"><span>Database</span></a></li></ul><ul><li class="docs_sidebar-label__ECVjt">Plugins</li><li><a class="docs_sidebar-item__lo3cL" href="/docs/plugins"><span>Open Source Plugins</span></a></li><li><a class="docs_sidebar-item__lo3cL" href="/docs/sso"><span>Single Sign-on</span></a></li><li><a class="docs_sidebar-item__lo3cL" href="/docs/modal"><span>Modal</span></a></li></ul></nav></div><div class="docs_dropdown__xSnPc"><label for="navigation"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon_root__gN1Pq docs_dropdown-icon__tHms9" style="min-width:18px"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></label><select class="docs_dropdown-select__B4Lz4" id="navigation"><option disabled="">Select page...</option><option value="/docs">Get Started<!-- --> › <!-- -->Prodigy 101</option><option value="/docs/install">Get Started<!-- --> › <!-- -->Installation &amp; Setup</option><option value="/docs/changelog">Get Started<!-- --> › <!-- -->Changelog</option><option value="/docs/named-entity-recognition">Usage<!-- --> › <!-- -->Named Entity Recognition</option><option value="/docs/span-categorization">Usage<!-- --> › <!-- -->Span Categorization</option><option value="/docs/text-classification">Usage<!-- --> › <!-- -->Text Classification</option><option value="/docs/dependencies-relations" selected="">Usage<!-- --> › <!-- -->Dependencies &amp; Relations</option><option value="/docs/computer-vision">Usage<!-- --> › <!-- -->Computer Vision</option><option value="/docs/audio-video">Usage<!-- --> › <!-- -->Audio &amp; Video</option><option value="/docs/task-routing">Usage<!-- --> › <!-- -->Task Routing</option><option value="/docs/large-language-models">Usage<!-- --> › <!-- -->Large Language Models</option><option value="/docs/review">Usage<!-- --> › <!-- -->Review</option><option value="/docs/custom-recipes">Usage<!-- --> › <!-- -->Custom Recipes</option><option value="/docs/custom-interfaces">Usage<!-- --> › <!-- -->Custom Interfaces</option><option value="/docs/metrics">Usage<!-- --> › <!-- -->Metrics</option><option value="/docs/deployment">Usage<!-- --> › <!-- -->Deployment</option><option value="/docs/recipes">API<!-- --> › <!-- -->Recipes</option><option value="/docs/api-interfaces">API<!-- --> › <!-- -->Annotation Interfaces</option><option value="/docs/api-web-app">API<!-- --> › <!-- -->Web Application</option><option value="/docs/api-loaders">API<!-- --> › <!-- -->Loaders &amp; Input Data</option><option value="/docs/api-components">API<!-- --> › <!-- -->Components &amp; Functions</option><option value="/docs/api-database">API<!-- --> › <!-- -->Database</option><option value="/docs/plugins">Plugins<!-- --> › <!-- -->Open Source Plugins</option><option value="/docs/sso">Plugins<!-- --> › <!-- -->Single Sign-on</option><option value="/docs/modal">Plugins<!-- --> › <!-- -->Modal</option></select></div><article class="docs_article__lCdGi"><header class="docs_header__8wjdR"><h1 class="typography_h__bPrgs typography_h1__V49R7 docs_title__5sJvQ"> <!-- -->Dependencies and Relations<!-- --> <span><span class="typography_tag__XZ_A7 typography_tag-new__7j_5S">New: <!-- -->1.10</span></span></h1></header><p>The <a class="" href="/docs/api-interfaces#relations"><code class="code_inline-code__YR06d link_content-link__oWAFe"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon_root__gN1Pq" style="min-width:14px"><rect x="3" y="3" width="18" height="18" rx="2" ry="2" fill="none"></rect><circle cx="8.5" cy="8.5" r="1.5" fill="none"></circle><polyline points="21 15 16 10 5 21" fill="none"></polyline></svg> <!-- -->relations</code></a> interface can be used for a wide range of classic natural
language processing tasks, such as syntactic and semantic dependency parsing,
coreference resolution, or discourse analysis. Relations can be directed or
undirected, labelled or unlabelled, and anchored either by single words or
phrases. Phrases can be recognised either as a preprocess, or jointly during the
relations annotation.</p>
<h2 id="quickstart" class="typography_h__bPrgs typography_h2__ZLgRo"><a class="" href="/docs/dependencies-relations#quickstart"> <!-- -->Quickstart <!-- --> </a></h2>
<details class="boxes_accordion__ITHv7"><summary class="boxes_accordion-title__mDMNo"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 14 14" fill="currentColor" class="icon_root__gN1Pq boxes_accordion-icon__tAdkU" style="min-width:18px"><path d="M6 4h2v2H6V4Zm0 4h2v2H6V8ZM4 2h2v2H4V2Zm4 4h2v2H8V6Zm-4 4h2v2H4v-2Z"></path></svg> <!-- -->I want to improve an existing spaCy dependency parsing model.</summary><p>The <a class="" href="/docs/recipes#dep-correct"><code class="code_inline-code__YR06d link_content-link__oWAFe"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" class="icon_root__gN1Pq" style="min-width:14px"><path d="M21 5c-1.1-.3-2.3-.5-3.5-.5-2 0-4 .4-5.5 1.5-1.4-1.1-3.5-1.5-5.5-1.5S2.5 4.9 1 6v14.7c0 .2.3.4.5.4h.3C3 20.4 5 20 6.5 20c2 0 4 .4 5.5 1.5a12 12 0 015.5-1.5c1.6 0 3.4.3 4.8 1l.2.1c.3 0 .5-.3.5-.5V6c-.6-.5-1.3-.8-2-1zm0 13.5a11.6 11.6 0 00-9 1V8a11.6 11.6 0 019-1v11.5z"></path><path d="M17.5 10.5c.9 0 1.7 0 2.5.3V9.2a13.5 13.5 0 00-7 .6v1.7c1.1-.7 2.7-1 4.5-1zM13 12.5v1.7c1.1-.7 2.7-1 4.5-1 .9 0 1.7 0 2.5.2V12a13.5 13.5 0 00-7 .6zM17.5 14.3c-1.7 0-3.2.3-4.5.9v1.6c1.1-.6 2.7-1 4.5-1 .9 0 1.7.1 2.5.3v-1.5c-.8-.2-1.6-.3-2.5-.3z"></path></svg> <!-- -->dep.correct</code></a> recipe lets you stream in the model’s predictions and
correct them if needed. You can either annotate all available dependency labels,
or focus on a subset of them that you care most about for your specific
application. spaCy can be updated with complete parses, as well as incomplete
annotations.</p><p>Once you’ve create a dataset, you can use the <a class="" href="/docs/recipes#train"><code class="code_inline-code__YR06d link_content-link__oWAFe"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" class="icon_root__gN1Pq" style="min-width:14px"><path d="M21 5c-1.1-.3-2.3-.5-3.5-.5-2 0-4 .4-5.5 1.5-1.4-1.1-3.5-1.5-5.5-1.5S2.5 4.9 1 6v14.7c0 .2.3.4.5.4h.3C3 20.4 5 20 6.5 20c2 0 4 .4 5.5 1.5a12 12 0 015.5-1.5c1.6 0 3.4.3 4.8 1l.2.1c.3 0 .5-.3.5-.5V6c-.6-.5-1.3-.8-2-1zm0 13.5a11.6 11.6 0 00-9 1V8a11.6 11.6 0 019-1v11.5z"></path><path d="M17.5 10.5c.9 0 1.7 0 2.5.3V9.2a13.5 13.5 0 00-7 .6v1.7c1.1-.7 2.7-1 4.5-1zM13 12.5v1.7c1.1-.7 2.7-1 4.5-1 .9 0 1.7 0 2.5.2V12a13.5 13.5 0 00-7 .6zM17.5 14.3c-1.7 0-3.2.3-4.5.9v1.6c1.1-.6 2.7-1 4.5-1 .9 0 1.7.1 2.5.3v-1.5c-.8-.2-1.6-.3-2.5-.3z"></path></svg> <!-- -->train</code></a> recipe to update the
existing model with the annotations. You can also use the <a class="" href="/docs/recipes#data-to-spacy"><code class="code_inline-code__YR06d link_content-link__oWAFe"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" class="icon_root__gN1Pq" style="min-width:14px"><path d="M21 5c-1.1-.3-2.3-.5-3.5-.5-2 0-4 .4-5.5 1.5-1.4-1.1-3.5-1.5-5.5-1.5S2.5 4.9 1 6v14.7c0 .2.3.4.5.4h.3C3 20.4 5 20 6.5 20c2 0 4 .4 5.5 1.5a12 12 0 015.5-1.5c1.6 0 3.4.3 4.8 1l.2.1c.3 0 .5-.3.5-.5V6c-.6-.5-1.3-.8-2-1zm0 13.5a11.6 11.6 0 00-9 1V8a11.6 11.6 0 019-1v11.5z"></path><path d="M17.5 10.5c.9 0 1.7 0 2.5.3V9.2a13.5 13.5 0 00-7 .6v1.7c1.1-.7 2.7-1 4.5-1zM13 12.5v1.7c1.1-.7 2.7-1 4.5-1 .9 0 1.7 0 2.5.2V12a13.5 13.5 0 00-7 .6zM17.5 14.3c-1.7 0-3.2.3-4.5.9v1.6c1.1-.6 2.7-1 4.5-1 .9 0 1.7.1 2.5.3v-1.5c-.8-.2-1.6-.3-2.5-.3z"></path></svg> <!-- -->data-to-spacy</code></a>
command to convert your annotations to JSON-formatted training data to use with
<code class="code_inline-code__YR06d">spacy train</code>.</p></details>
<details class="boxes_accordion__ITHv7"><summary class="boxes_accordion-title__mDMNo"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 14 14" fill="currentColor" class="icon_root__gN1Pq boxes_accordion-icon__tAdkU" style="min-width:18px"><path d="M6 4h2v2H6V4Zm0 4h2v2H6V8ZM4 2h2v2H4V2Zm4 4h2v2H8V6Zm-4 4h2v2H4v-2Z"></path></svg> <!-- -->I want to plug in and correct a non-spaCy dependency parser.</summary><p>Prodigy represents dependency annotations in a
<a class="link_link__DWI2E" href="/docs/api-interfaces#relations">simple JSON format</a> with a <code class="code_inline-code__YR06d">&quot;text&quot;</code>, a
<code class="code_inline-code__YR06d">&quot;relations&quot;</code> property describing the head and child indices and label of each
dependency relation, and a list of <code class="code_inline-code__YR06d">&quot;tokens&quot;</code>. So you could extract the
suggestions from your model in this format, and then use the <a class="" href="/docs/recipes#mark"><code class="code_inline-code__YR06d link_content-link__oWAFe"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" class="icon_root__gN1Pq" style="min-width:14px"><path d="M21 5c-1.1-.3-2.3-.5-3.5-.5-2 0-4 .4-5.5 1.5-1.4-1.1-3.5-1.5-5.5-1.5S2.5 4.9 1 6v14.7c0 .2.3.4.5.4h.3C3 20.4 5 20 6.5 20c2 0 4 .4 5.5 1.5a12 12 0 015.5-1.5c1.6 0 3.4.3 4.8 1l.2.1c.3 0 .5-.3.5-.5V6c-.6-.5-1.3-.8-2-1zm0 13.5a11.6 11.6 0 00-9 1V8a11.6 11.6 0 019-1v11.5z"></path><path d="M17.5 10.5c.9 0 1.7 0 2.5.3V9.2a13.5 13.5 0 00-7 .6v1.7c1.1-.7 2.7-1 4.5-1zM13 12.5v1.7c1.1-.7 2.7-1 4.5-1 .9 0 1.7 0 2.5.2V12a13.5 13.5 0 00-7 .6zM17.5 14.3c-1.7 0-3.2.3-4.5.9v1.6c1.1-.6 2.7-1 4.5-1 .9 0 1.7.1 2.5.3v-1.5c-.8-.2-1.6-.3-2.5-.3z"></path></svg> <!-- -->mark</code></a> recipe
with <code class="code_inline-code__YR06d">--view-id relations</code> to label the data exactly as it comes in.</p><p>You can also write a <a class="link_link__DWI2E" href="/docs/custom-recipes">custom recipe</a> with a custom stream
(a regular Python generator!) to plug in your model. If you can load and run
your model in Python, you can use it with Prodigy. See
<a class="link_link__DWI2E" href="/docs/dependencies-relations#custom-model">the section on custom models</a> for an example. If you want to use
active learning with a custom model, you can make your recipe return an <code class="code_inline-code__YR06d">update</code>
callback that’s called whenever a new batch of answers is sent back from the web
app. However, there are a few more considerations here, like how sensitive your
model is to small updates.</p></details>
<details class="boxes_accordion__ITHv7"><summary class="boxes_accordion-title__mDMNo"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 14 14" fill="currentColor" class="icon_root__gN1Pq boxes_accordion-icon__tAdkU" style="min-width:18px"><path d="M6 4h2v2H6V4Zm0 4h2v2H6V8ZM4 2h2v2H4V2Zm4 4h2v2H8V6Zm-4 4h2v2H4v-2Z"></path></svg> <!-- -->I want to annotate entities and relations between them.</summary><p>The <a class="" href="/docs/recipes#rel-manual"><code class="code_inline-code__YR06d link_content-link__oWAFe"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" class="icon_root__gN1Pq" style="min-width:14px"><path d="M21 5c-1.1-.3-2.3-.5-3.5-.5-2 0-4 .4-5.5 1.5-1.4-1.1-3.5-1.5-5.5-1.5S2.5 4.9 1 6v14.7c0 .2.3.4.5.4h.3C3 20.4 5 20 6.5 20c2 0 4 .4 5.5 1.5a12 12 0 015.5-1.5c1.6 0 3.4.3 4.8 1l.2.1c.3 0 .5-.3.5-.5V6c-.6-.5-1.3-.8-2-1zm0 13.5a11.6 11.6 0 00-9 1V8a11.6 11.6 0 019-1v11.5z"></path><path d="M17.5 10.5c.9 0 1.7 0 2.5.3V9.2a13.5 13.5 0 00-7 .6v1.7c1.1-.7 2.7-1 4.5-1zM13 12.5v1.7c1.1-.7 2.7-1 4.5-1 .9 0 1.7 0 2.5.2V12a13.5 13.5 0 00-7 .6zM17.5 14.3c-1.7 0-3.2.3-4.5.9v1.6c1.1-.6 2.7-1 4.5-1 .9 0 1.7.1 2.5.3v-1.5c-.8-.2-1.6-.3-2.5-.3z"></path></svg> <!-- -->rel.manual</code></a> recipe lets you switch between two annotation modes: one
for labeling/correcting entity spans, and one for defining relations between
these spans and/or other tokens. You can also load in data that has been
pre-annotated with entity spans in Prodigy’s format and annotate relations
between them, or use a pretrained model to suggest entities for you. For
details, see the section on <a class="link_link__DWI2E" href="/docs/dependencies-relations#ner">annotating named entity relations</a>.</p></details>
<details class="boxes_accordion__ITHv7"><summary class="boxes_accordion-title__mDMNo"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 14 14" fill="currentColor" class="icon_root__gN1Pq boxes_accordion-icon__tAdkU" style="min-width:18px"><path d="M6 4h2v2H6V4Zm0 4h2v2H6V8ZM4 2h2v2H4V2Zm4 4h2v2H8V6Zm-4 4h2v2H4v-2Z"></path></svg> <!-- -->I want to create training data for coreference resolution.</summary><p>The <a class="" href="/docs/recipes#coref-manual"><code class="code_inline-code__YR06d link_content-link__oWAFe"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" class="icon_root__gN1Pq" style="min-width:14px"><path d="M21 5c-1.1-.3-2.3-.5-3.5-.5-2 0-4 .4-5.5 1.5-1.4-1.1-3.5-1.5-5.5-1.5S2.5 4.9 1 6v14.7c0 .2.3.4.5.4h.3C3 20.4 5 20 6.5 20c2 0 4 .4 5.5 1.5a12 12 0 015.5-1.5c1.6 0 3.4.3 4.8 1l.2.1c.3 0 .5-.3.5-.5V6c-.6-.5-1.3-.8-2-1zm0 13.5a11.6 11.6 0 00-9 1V8a11.6 11.6 0 019-1v11.5z"></path><path d="M17.5 10.5c.9 0 1.7 0 2.5.3V9.2a13.5 13.5 0 00-7 .6v1.7c1.1-.7 2.7-1 4.5-1zM13 12.5v1.7c1.1-.7 2.7-1 4.5-1 .9 0 1.7 0 2.5.2V12a13.5 13.5 0 00-7 .6zM17.5 14.3c-1.7 0-3.2.3-4.5.9v1.6c1.1-.6 2.7-1 4.5-1 .9 0 1.7.1 2.5.3v-1.5c-.8-.2-1.6-.3-2.5-.3z"></path></svg> <!-- -->coref.manual</code></a> recipe incorporates default settings for coreference
annotation, such as using the relation label <code class="code_inline-code__YR06d">COREF</code> and disabling all tokens
that are not nouns, proper nouns or pronouns, and pre-highlighting named
entities. You can customize the labels it uses to match your language and model.
For details, see the section on <a class="link_link__DWI2E" href="/docs/dependencies-relations#coref">annotation coreference relations</a>.</p></details>
<details class="boxes_accordion__ITHv7"><summary class="boxes_accordion-title__mDMNo"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 14 14" fill="currentColor" class="icon_root__gN1Pq boxes_accordion-icon__tAdkU" style="min-width:18px"><path d="M6 4h2v2H6V4Zm0 4h2v2H6V8ZM4 2h2v2H4V2Zm4 4h2v2H8V6Zm-4 4h2v2H4v-2Z"></path></svg> <!-- -->I want to annotate other relations for a custom domain, e.g. biomedical text.</summary><p>Prodigy’s <a class="" href="/docs/recipes#rel-manual"><code class="code_inline-code__YR06d link_content-link__oWAFe"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" class="icon_root__gN1Pq" style="min-width:14px"><path d="M21 5c-1.1-.3-2.3-.5-3.5-.5-2 0-4 .4-5.5 1.5-1.4-1.1-3.5-1.5-5.5-1.5S2.5 4.9 1 6v14.7c0 .2.3.4.5.4h.3C3 20.4 5 20 6.5 20c2 0 4 .4 5.5 1.5a12 12 0 015.5-1.5c1.6 0 3.4.3 4.8 1l.2.1c.3 0 .5-.3.5-.5V6c-.6-.5-1.3-.8-2-1zm0 13.5a11.6 11.6 0 00-9 1V8a11.6 11.6 0 019-1v11.5z"></path><path d="M17.5 10.5c.9 0 1.7 0 2.5.3V9.2a13.5 13.5 0 00-7 .6v1.7c1.1-.7 2.7-1 4.5-1zM13 12.5v1.7c1.1-.7 2.7-1 4.5-1 .9 0 1.7 0 2.5.2V12a13.5 13.5 0 00-7 .6zM17.5 14.3c-1.7 0-3.2.3-4.5.9v1.6c1.1-.6 2.7-1 4.5-1 .9 0 1.7.1 2.5.3v-1.5c-.8-.2-1.6-.3-2.5-.3z"></path></svg> <!-- -->rel.manual</code></a> recipe allows building very powerful custom
workflows for semi-automated dependency and relation annotation, mixing manual
span labelling and dependency attachment. You can also provide match patterns to
pre-select and merge spans, or to disable tokens that you know are not going to
be part of a relation you’re looking for.</p><p>The <a class="link_link__DWI2E" href="/docs/dependencies-relations#example-bio">example in this usage guide</a> focuses on annotating biomedical
events from literature, a complex task with multiple annotation objectives using
the
<a target="_blank" class="link_link__DWI2E" href="http://2011.bionlp-st.org/home/genia-event-extraction-genia">BioNLP 2011 GENIA Shared Task</a>
annotation scheme. A similar strategy can be applied to a variety of custom
domain use cases.</p></details>
<details class="boxes_accordion__ITHv7"><summary class="boxes_accordion-title__mDMNo"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 14 14" fill="currentColor" class="icon_root__gN1Pq boxes_accordion-icon__tAdkU" style="min-width:18px"><path d="M6 4h2v2H6V4Zm0 4h2v2H6V8ZM4 2h2v2H4V2Zm4 4h2v2H8V6Zm-4 4h2v2H4v-2Z"></path></svg> <!-- -->I have relations annotations. I want to train a relations model.</summary><p>Unlike other text recipes, Prodigy’s <code class="code_inline-code__YR06d">prodigy train</code> and <code class="code_inline-code__YR06d">data-to-spacy</code> recipes
don’t support <code class="code_inline-code__YR06d">&quot;relations&quot;</code> annotations. Both recipes depend on spaCy, and spaCy
currently does not support relation extraction.</p><p>However, we’ve created a <a target="_blank" class="link_link__DWI2E" href="https://www.youtube.com/watch?v=8HL-Ap5_Axo">tutorial video</a>
and <a target="_blank" class="link_link__DWI2E" href="https://github.com/explosion/projects/tree/v3/tutorials/rel_component">project repository</a>
that shows how you can create a custom trainable component with <code class="code_inline-code__YR06d">spacy train</code>. To
adopt to your project, you’ll want to clone the repo, update your annotations, and
modify the <code class="code_inline-code__YR06d">parse_data.py</code> script to export your annotations to <code class="code_inline-code__YR06d">.spacy</code>. For more details,
there are several related <a target="_blank" class="link_link__DWI2E" href="https://support.prodi.gy/t/5852/4">posts</a>
on <a target="_blank" class="link_link__DWI2E" href="https://support.prodi.gy">Prodigy Support</a>. You may also find posts on
<a target="_blank" class="link_link__DWI2E" href="https://github.com/explosion/spaCy/discussions">spaCy’s GitHub discussions</a> if you
need help with <code class="code_inline-code__YR06d">spacy train</code>.</p></details>
<h2 id="workflow" class="typography_h__bPrgs typography_h2__ZLgRo"><a class="" href="/docs/dependencies-relations#workflow"> <!-- -->Choosing the right recipe and workflow <!-- --> </a></h2>
<p>So you have a problem that requires data annotated with relationships between
words and expressions and you want to get it done as efficiently as possible.
But how do you pick the right workflow for your use case?</p>
<ol class="typography_ol__DYgg_">
<li>
<p><strong>Fully manual:</strong> This is the classic approach. You’re shown all tokens in
the text and you annotate labelled relations between them by clicking on
them. The biggest challenge here is to prevent the process from getting too
messy and tedious (and as a result, slower and more error-prone). Unless your
goal is to create a new dependency treebank from scratch, you typically want
to use at least <em>some</em> automation to merge phrases, disable irrelevant tokens
or pre-label some of the data for you. In Prodigy, you can use the
<a class="" href="/docs/recipes#rel-manual"><code class="code_inline-code__YR06d link_content-link__oWAFe"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" class="icon_root__gN1Pq" style="min-width:14px"><path d="M21 5c-1.1-.3-2.3-.5-3.5-.5-2 0-4 .4-5.5 1.5-1.4-1.1-3.5-1.5-5.5-1.5S2.5 4.9 1 6v14.7c0 .2.3.4.5.4h.3C3 20.4 5 20 6.5 20c2 0 4 .4 5.5 1.5a12 12 0 015.5-1.5c1.6 0 3.4.3 4.8 1l.2.1c.3 0 .5-.3.5-.5V6c-.6-.5-1.3-.8-2-1zm0 13.5a11.6 11.6 0 00-9 1V8a11.6 11.6 0 019-1v11.5z"></path><path d="M17.5 10.5c.9 0 1.7 0 2.5.3V9.2a13.5 13.5 0 00-7 .6v1.7c1.1-.7 2.7-1 4.5-1zM13 12.5v1.7c1.1-.7 2.7-1 4.5-1 .9 0 1.7 0 2.5.2V12a13.5 13.5 0 00-7 .6zM17.5 14.3c-1.7 0-3.2.3-4.5.9v1.6c1.1-.6 2.7-1 4.5-1 .9 0 1.7.1 2.5.3v-1.5c-.8-.2-1.6-.3-2.5-.3z"></path></svg> <!-- -->rel.manual</code></a> recipe for manual relation annotation, or the more
task-specific <a class="" href="/docs/recipes#coref-manual"><code class="code_inline-code__YR06d link_content-link__oWAFe"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" class="icon_root__gN1Pq" style="min-width:14px"><path d="M21 5c-1.1-.3-2.3-.5-3.5-.5-2 0-4 .4-5.5 1.5-1.4-1.1-3.5-1.5-5.5-1.5S2.5 4.9 1 6v14.7c0 .2.3.4.5.4h.3C3 20.4 5 20 6.5 20c2 0 4 .4 5.5 1.5a12 12 0 015.5-1.5c1.6 0 3.4.3 4.8 1l.2.1c.3 0 .5-.3.5-.5V6c-.6-.5-1.3-.8-2-1zm0 13.5a11.6 11.6 0 00-9 1V8a11.6 11.6 0 019-1v11.5z"></path><path d="M17.5 10.5c.9 0 1.7 0 2.5.3V9.2a13.5 13.5 0 00-7 .6v1.7c1.1-.7 2.7-1 4.5-1zM13 12.5v1.7c1.1-.7 2.7-1 4.5-1 .9 0 1.7 0 2.5.2V12a13.5 13.5 0 00-7 .6zM17.5 14.3c-1.7 0-3.2.3-4.5.9v1.6c1.1-.6 2.7-1 4.5-1 .9 0 1.7.1 2.5.3v-1.5c-.8-.2-1.6-.3-2.5-.3z"></path></svg> <!-- -->coref.manual</code></a> with pre-defined configurations for
coreference annotation.</p>
</li>
<li>
<p><strong>Manual with suggestions from model:</strong> If you already have a model that
predicts <em>something</em>, you can use it to pre-label the data for you, and only
correct its mistakes. This is especially useful for dependency parsing, where
the data creation from scratch would otherwise be very tedious. Prodigy’s
<a class="" href="/docs/recipes#dep-correct"><code class="code_inline-code__YR06d link_content-link__oWAFe"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" class="icon_root__gN1Pq" style="min-width:14px"><path d="M21 5c-1.1-.3-2.3-.5-3.5-.5-2 0-4 .4-5.5 1.5-1.4-1.1-3.5-1.5-5.5-1.5S2.5 4.9 1 6v14.7c0 .2.3.4.5.4h.3C3 20.4 5 20 6.5 20c2 0 4 .4 5.5 1.5a12 12 0 015.5-1.5c1.6 0 3.4.3 4.8 1l.2.1c.3 0 .5-.3.5-.5V6c-.6-.5-1.3-.8-2-1zm0 13.5a11.6 11.6 0 00-9 1V8a11.6 11.6 0 019-1v11.5z"></path><path d="M17.5 10.5c.9 0 1.7 0 2.5.3V9.2a13.5 13.5 0 00-7 .6v1.7c1.1-.7 2.7-1 4.5-1zM13 12.5v1.7c1.1-.7 2.7-1 4.5-1 .9 0 1.7 0 2.5.2V12a13.5 13.5 0 00-7 .6zM17.5 14.3c-1.7 0-3.2.3-4.5.9v1.6c1.1-.6 2.7-1 4.5-1 .9 0 1.7.1 2.5.3v-1.5c-.8-.2-1.6-.3-2.5-.3z"></path></svg> <!-- -->dep.correct</code></a> workflow lets you stream in syntactic dependencies
predicted by the model and correct them manually to create gold-standard
data. You can also use a model with <a class="" href="/docs/recipes#rel-manual"><code class="code_inline-code__YR06d link_content-link__oWAFe"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" class="icon_root__gN1Pq" style="min-width:14px"><path d="M21 5c-1.1-.3-2.3-.5-3.5-.5-2 0-4 .4-5.5 1.5-1.4-1.1-3.5-1.5-5.5-1.5S2.5 4.9 1 6v14.7c0 .2.3.4.5.4h.3C3 20.4 5 20 6.5 20c2 0 4 .4 5.5 1.5a12 12 0 015.5-1.5c1.6 0 3.4.3 4.8 1l.2.1c.3 0 .5-.3.5-.5V6c-.6-.5-1.3-.8-2-1zm0 13.5a11.6 11.6 0 00-9 1V8a11.6 11.6 0 019-1v11.5z"></path><path d="M17.5 10.5c.9 0 1.7 0 2.5.3V9.2a13.5 13.5 0 00-7 .6v1.7c1.1-.7 2.7-1 4.5-1zM13 12.5v1.7c1.1-.7 2.7-1 4.5-1 .9 0 1.7 0 2.5.2V12a13.5 13.5 0 00-7 .6zM17.5 14.3c-1.7 0-3.2.3-4.5.9v1.6c1.1-.6 2.7-1 4.5-1 .9 0 1.7.1 2.5.3v-1.5c-.8-.2-1.6-.3-2.5-.3z"></path></svg> <!-- -->rel.manual</code></a> to add named entities
and noun phrases.</p>
</li>
</ol>
<h2 id="dependency-parsing" class="typography_h__bPrgs typography_h2__ZLgRo"><a class="" href="/docs/dependencies-relations#dependency-parsing"> <!-- -->Dependency Parsing <!-- --> </a></h2>
<p>If you already have a pretrained <a class="link_link__DWI2E" href="/docs/install#spacy-models">spaCy pipeline</a>
with a parser and you want to improve it on your own data, you can use the
built-in <a class="" href="/docs/recipes#dep-correct"><code class="code_inline-code__YR06d link_content-link__oWAFe"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" class="icon_root__gN1Pq" style="min-width:14px"><path d="M21 5c-1.1-.3-2.3-.5-3.5-.5-2 0-4 .4-5.5 1.5-1.4-1.1-3.5-1.5-5.5-1.5S2.5 4.9 1 6v14.7c0 .2.3.4.5.4h.3C3 20.4 5 20 6.5 20c2 0 4 .4 5.5 1.5a12 12 0 015.5-1.5c1.6 0 3.4.3 4.8 1l.2.1c.3 0 .5-.3.5-.5V6c-.6-.5-1.3-.8-2-1zm0 13.5a11.6 11.6 0 00-9 1V8a11.6 11.6 0 019-1v11.5z"></path><path d="M17.5 10.5c.9 0 1.7 0 2.5.3V9.2a13.5 13.5 0 00-7 .6v1.7c1.1-.7 2.7-1 4.5-1zM13 12.5v1.7c1.1-.7 2.7-1 4.5-1 .9 0 1.7 0 2.5.2V12a13.5 13.5 0 00-7 .6zM17.5 14.3c-1.7 0-3.2.3-4.5.9v1.6c1.1-.6 2.7-1 4.5-1 .9 0 1.7.1 2.5.3v-1.5c-.8-.2-1.6-.3-2.5-.3z"></path></svg> <!-- -->dep.correct</code></a> recipe. You don’t have to annotate all labels at the
same time – it can also be useful to focus on a smaller subset of labels that
are most relevant for your application. The following command will start the web
server, stream in headlines from <code class="code_inline-code__YR06d code_wrap___Qsb3">news_headlines.jsonl</code> and provide the label
options <code class="code_inline-code__YR06d">ROOT</code> (root of the sentence), <code class="code_inline-code__YR06d">csubj</code> (clausal subject), <code class="code_inline-code__YR06d">nsubj</code>
(nominal subject), <code class="code_inline-code__YR06d">dobj</code> (direct object) and <code class="code_inline-code__YR06d">pboj</code> (prepositional object).
Those labels will vary depending on the label scheme the model was trained with.</p>
<a target="_blank" class="link_link__DWI2E link_button__Hg510" href="https://raw.githubusercontent.com/explosion/prodigy-recipes/master/example-datasets/news_headlines.jsonl"><svg xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon_root__gN1Pq link_button-icon__uxNXW" style="min-width:17px"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" fill="none"></path><polyline points="7 10 12 15 17 10" fill="none"></polyline><line x1="12" y1="15" x2="12" y2="3" fill="none"></line></svg><span class="link_button-icon-text__A1ZKQ">Download news_headlines.jsonl</span></a>
<div class="code_pre__6p81S terminal_root__AhJiA terminal_buttons__u4zIH"><h4 class="terminal_title__xmNx9">Recipe command</h4><button aria-label="Copy to clipboard" class="link_copy__GU7HF terminal_copy__dp7Rk"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon_root__gN1Pq" style="min-width:18px"><rect x="9" y="9" width="13" height="13" rx="2" ry="2" fill="none"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" fill="none"></path></svg></button><code class="code_inline-code__YR06d terminal_code__PX4L_ terminal_prompt__CPK9e"><span class="terminal_command__pri5x terminal_command-plain__muahB">prodigy</span><abbr class="terminal_command__pri5x terminal_command-title__auhoI">dep.correct</abbr><abbr class="terminal_command__pri5x terminal_cyan__J9WF_ terminal_command-title__auhoI">deps_news</abbr><abbr class="terminal_command__pri5x terminal_orange__nysCx terminal_command-title__auhoI">en_core_web_sm</abbr><abbr class="terminal_command__pri5x terminal_yellow__LaeyU terminal_command-title__auhoI">./news_headlines.jsonl</abbr><abbr class="terminal_command__pri5x terminal_pink__eCeoL terminal_command-title__auhoI">--label ROOT,csubj,nsubj,dobj,pboj</abbr><abbr class="terminal_command__pri5x terminal_blue__gQiZb terminal_command-title__auhoI">--update</abbr></code></div>
<figure class="prodigy_placeholder-card__v2kPH">This live demo requires JavaScript to be enabled.</figure>
<p>In the annotation UI, you can now review the dependency parse and click on
incorrectly predicted arcs to remove them, or add new dependencies by selecting
the head token and then the child token to attach it to. The <code class="code_inline-code__YR06d">ROOT</code> label is the
only one that should be <strong>attached to itself</strong>. You can achieve this in the UI
by <strong>double-clicking</strong> or <strong>double-tapping</strong> the token.</p>
<p>When you’re done with annotating, you can use the <a class="" href="/docs/recipes#train"><code class="code_inline-code__YR06d link_content-link__oWAFe"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" class="icon_root__gN1Pq" style="min-width:14px"><path d="M21 5c-1.1-.3-2.3-.5-3.5-.5-2 0-4 .4-5.5 1.5-1.4-1.1-3.5-1.5-5.5-1.5S2.5 4.9 1 6v14.7c0 .2.3.4.5.4h.3C3 20.4 5 20 6.5 20c2 0 4 .4 5.5 1.5a12 12 0 015.5-1.5c1.6 0 3.4.3 4.8 1l.2.1c.3 0 .5-.3.5-.5V6c-.6-.5-1.3-.8-2-1zm0 13.5a11.6 11.6 0 00-9 1V8a11.6 11.6 0 019-1v11.5z"></path><path d="M17.5 10.5c.9 0 1.7 0 2.5.3V9.2a13.5 13.5 0 00-7 .6v1.7c1.1-.7 2.7-1 4.5-1zM13 12.5v1.7c1.1-.7 2.7-1 4.5-1 .9 0 1.7 0 2.5.2V12a13.5 13.5 0 00-7 .6zM17.5 14.3c-1.7 0-3.2.3-4.5.9v1.6c1.1-.6 2.7-1 4.5-1 .9 0 1.7.1 2.5.3v-1.5c-.8-.2-1.6-.3-2.5-.3z"></path></svg> <!-- -->train</code></a> recipe with the
component <code class="code_inline-code__YR06d">parser</code> to train a dependency parser, or use the <a class="" href="/docs/recipes#data-to-spacy"><code class="code_inline-code__YR06d link_content-link__oWAFe"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" class="icon_root__gN1Pq" style="min-width:14px"><path d="M21 5c-1.1-.3-2.3-.5-3.5-.5-2 0-4 .4-5.5 1.5-1.4-1.1-3.5-1.5-5.5-1.5S2.5 4.9 1 6v14.7c0 .2.3.4.5.4h.3C3 20.4 5 20 6.5 20c2 0 4 .4 5.5 1.5a12 12 0 015.5-1.5c1.6 0 3.4.3 4.8 1l.2.1c.3 0 .5-.3.5-.5V6c-.6-.5-1.3-.8-2-1zm0 13.5a11.6 11.6 0 00-9 1V8a11.6 11.6 0 019-1v11.5z"></path><path d="M17.5 10.5c.9 0 1.7 0 2.5.3V9.2a13.5 13.5 0 00-7 .6v1.7c1.1-.7 2.7-1 4.5-1zM13 12.5v1.7c1.1-.7 2.7-1 4.5-1 .9 0 1.7 0 2.5.2V12a13.5 13.5 0 00-7 .6zM17.5 14.3c-1.7 0-3.2.3-4.5.9v1.6c1.1-.6 2.7-1 4.5-1 .9 0 1.7.1 2.5.3v-1.5c-.8-.2-1.6-.3-2.5-.3z"></path></svg> <!-- -->data-to-spacy</code></a>
command to export JSON-formatted training data. You can also use <a class="" href="/docs/recipes#db-out"><code class="code_inline-code__YR06d link_content-link__oWAFe"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" class="icon_root__gN1Pq" style="min-width:14px"><path d="M21 5c-1.1-.3-2.3-.5-3.5-.5-2 0-4 .4-5.5 1.5-1.4-1.1-3.5-1.5-5.5-1.5S2.5 4.9 1 6v14.7c0 .2.3.4.5.4h.3C3 20.4 5 20 6.5 20c2 0 4 .4 5.5 1.5a12 12 0 015.5-1.5c1.6 0 3.4.3 4.8 1l.2.1c.3 0 .5-.3.5-.5V6c-.6-.5-1.3-.8-2-1zm0 13.5a11.6 11.6 0 00-9 1V8a11.6 11.6 0 019-1v11.5z"></path><path d="M17.5 10.5c.9 0 1.7 0 2.5.3V9.2a13.5 13.5 0 00-7 .6v1.7c1.1-.7 2.7-1 4.5-1zM13 12.5v1.7c1.1-.7 2.7-1 4.5-1 .9 0 1.7 0 2.5.2V12a13.5 13.5 0 00-7 .6zM17.5 14.3c-1.7 0-3.2.3-4.5.9v1.6c1.1-.6 2.7-1 4.5-1 .9 0 1.7.1 2.5.3v-1.5c-.8-.2-1.6-.3-2.5-.3z"></path></svg> <!-- -->db-out</code></a>
to export data in <a class="link_link__DWI2E" href="/docs/api-interfaces#relations">Prodigy’s JSON format</a> and
use it in a different process.</p>
<div class="code_pre__6p81S terminal_root__AhJiA terminal_buttons__u4zIH"><h4 class="terminal_title__xmNx9">Training command</h4><button aria-label="Copy to clipboard" class="link_copy__GU7HF terminal_copy__dp7Rk"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon_root__gN1Pq" style="min-width:18px"><rect x="9" y="9" width="13" height="13" rx="2" ry="2" fill="none"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" fill="none"></path></svg></button><code class="code_inline-code__YR06d terminal_code__PX4L_ terminal_prompt__CPK9e"><span class="terminal_command__pri5x terminal_command-plain__muahB">prodigy</span><abbr class="terminal_command__pri5x terminal_command-title__auhoI">train</abbr><abbr class="terminal_command__pri5x terminal_command-title__auhoI">./model</abbr><abbr class="terminal_command__pri5x terminal_yellow__LaeyU terminal_command-title__auhoI">--parser dep_news</abbr></code></div>
<h2 id="ner" class="typography_h__bPrgs typography_h2__ZLgRo"><a class="" href="/docs/dependencies-relations#ner"> <!-- -->Combining Named Entity Recognition with relation extraction <!-- --> </a></h2>
<aside class="boxes_infobox__Ek_wd boxes_warning__rHOtg"><p>Note that in order to train a model to predict relations between spans, you have
to bring <strong>your own model implementation</strong> and implement your own training.</p></aside>
<p>You might already know Prodigy’s features for annotating training data for
<a class="link_link__DWI2E" href="/docs/named-entity-recognition">named entity recognition</a>. Using a workflow
like <a class="" href="/docs/recipes#ner-manual"><code class="code_inline-code__YR06d link_content-link__oWAFe"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" class="icon_root__gN1Pq" style="min-width:14px"><path d="M21 5c-1.1-.3-2.3-.5-3.5-.5-2 0-4 .4-5.5 1.5-1.4-1.1-3.5-1.5-5.5-1.5S2.5 4.9 1 6v14.7c0 .2.3.4.5.4h.3C3 20.4 5 20 6.5 20c2 0 4 .4 5.5 1.5a12 12 0 015.5-1.5c1.6 0 3.4.3 4.8 1l.2.1c.3 0 .5-.3.5-.5V6c-.6-.5-1.3-.8-2-1zm0 13.5a11.6 11.6 0 00-9 1V8a11.6 11.6 0 019-1v11.5z"></path><path d="M17.5 10.5c.9 0 1.7 0 2.5.3V9.2a13.5 13.5 0 00-7 .6v1.7c1.1-.7 2.7-1 4.5-1zM13 12.5v1.7c1.1-.7 2.7-1 4.5-1 .9 0 1.7 0 2.5.2V12a13.5 13.5 0 00-7 .6zM17.5 14.3c-1.7 0-3.2.3-4.5.9v1.6c1.1-.6 2.7-1 4.5-1 .9 0 1.7.1 2.5.3v-1.5c-.8-.2-1.6-.3-2.5-.3z"></path></svg> <!-- -->ner.manual</code></a>, you can stream in your data and highlight entity spans
for a given set of labels. For example, here we’re labelling <code class="code_inline-code__YR06d">PERSON</code> and <code class="code_inline-code__YR06d">GPE</code>
(geopolitical entity):</p>
<div class="code_pre__6p81S terminal_root__AhJiA terminal_buttons__u4zIH"><h4 class="terminal_title__xmNx9">Recipe command</h4><button aria-label="Copy to clipboard" class="link_copy__GU7HF terminal_copy__dp7Rk"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon_root__gN1Pq" style="min-width:18px"><rect x="9" y="9" width="13" height="13" rx="2" ry="2" fill="none"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" fill="none"></path></svg></button><code class="code_inline-code__YR06d terminal_code__PX4L_ terminal_prompt__CPK9e"><span class="terminal_command__pri5x terminal_command-plain__muahB">prodigy</span><abbr class="terminal_command__pri5x terminal_command-title__auhoI">ner.manual</abbr><abbr class="terminal_command__pri5x terminal_cyan__J9WF_ terminal_command-title__auhoI">ner_rels_ent</abbr><abbr class="terminal_command__pri5x terminal_orange__nysCx terminal_command-title__auhoI">blank:en</abbr><abbr class="terminal_command__pri5x terminal_yellow__LaeyU terminal_command-title__auhoI">./data.jsonl</abbr><abbr class="terminal_command__pri5x terminal_pink__eCeoL terminal_command-title__auhoI">--label PERSON,GPE</abbr></code></div>
<figure class="prodigy_placeholder-card__v2kPH">This live demo requires JavaScript to be enabled.</figure>
<p>While spans can capture a lot of important information – like the concepts that
are mentioned in the text – they can’t always capture <strong>relationships between
them</strong>. This requires another layer of data that defines two words or phrases,
typically a “head” and a “child”, and a label specifying the type of
relationship. The <a class="" href="/docs/recipes#rel-manual"><code class="code_inline-code__YR06d link_content-link__oWAFe"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" class="icon_root__gN1Pq" style="min-width:14px"><path d="M21 5c-1.1-.3-2.3-.5-3.5-.5-2 0-4 .4-5.5 1.5-1.4-1.1-3.5-1.5-5.5-1.5S2.5 4.9 1 6v14.7c0 .2.3.4.5.4h.3C3 20.4 5 20 6.5 20c2 0 4 .4 5.5 1.5a12 12 0 015.5-1.5c1.6 0 3.4.3 4.8 1l.2.1c.3 0 .5-.3.5-.5V6c-.6-.5-1.3-.8-2-1zm0 13.5a11.6 11.6 0 00-9 1V8a11.6 11.6 0 019-1v11.5z"></path><path d="M17.5 10.5c.9 0 1.7 0 2.5.3V9.2a13.5 13.5 0 00-7 .6v1.7c1.1-.7 2.7-1 4.5-1zM13 12.5v1.7c1.1-.7 2.7-1 4.5-1 .9 0 1.7 0 2.5.2V12a13.5 13.5 0 00-7 .6zM17.5 14.3c-1.7 0-3.2.3-4.5.9v1.6c1.1-.6 2.7-1 4.5-1 .9 0 1.7.1 2.5.3v-1.5c-.8-.2-1.6-.3-2.5-.3z"></path></svg> <!-- -->rel.manual</code></a> recipe allows you to stream in data that’s
already pre-annotated with named entities. In this case, we’re setting
<code class="code_inline-code__YR06d code_wrap___Qsb3">dataset:ner_rels_ent</code>, which will load the previously annotated data from the
dataset <code class="code_inline-code__YR06d">ner_rels_ent</code>. Entities annotated in this dataset will be shown as a
merged unit, and we can assign relations between them and other tokens.</p>
<div class="code_pre__6p81S terminal_root__AhJiA terminal_buttons__u4zIH"><h4 class="terminal_title__xmNx9">Recipe command</h4><button aria-label="Copy to clipboard" class="link_copy__GU7HF terminal_copy__dp7Rk"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon_root__gN1Pq" style="min-width:18px"><rect x="9" y="9" width="13" height="13" rx="2" ry="2" fill="none"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" fill="none"></path></svg></button><code class="code_inline-code__YR06d terminal_code__PX4L_ terminal_prompt__CPK9e"><span class="terminal_command__pri5x terminal_command-plain__muahB">prodigy</span><abbr class="terminal_command__pri5x terminal_command-title__auhoI">rel.manual</abbr><abbr class="terminal_command__pri5x terminal_cyan__J9WF_ terminal_command-title__auhoI">ner_rels_dep</abbr><abbr class="terminal_command__pri5x terminal_orange__nysCx terminal_command-title__auhoI">blank:en</abbr><abbr class="terminal_command__pri5x terminal_yellow__LaeyU terminal_command-title__auhoI">dataset:ner_rels_ent</abbr><abbr class="terminal_command__pri5x terminal_pink__eCeoL terminal_command-title__auhoI">--label SUBJECT,LOCATION</abbr><abbr class="terminal_command__pri5x terminal_command-title__auhoI">--wrap</abbr></code></div>
<figure class="prodigy_placeholder-card__v2kPH">This live demo requires JavaScript to be enabled.</figure>
<p>Instead of loading in a pre-annotated dataset, you can also use an existing
pretrained model to add entities for you. Here we’re using the <code class="code_inline-code__YR06d">en_core_web_sm</code>
model and the original raw input data, and set the <code class="code_inline-code__YR06d">--add-ents</code> flag to include
entities found in the text. For more options and how to add custom
preprocessing, see the section on <a class="link_link__DWI2E" href="/docs/dependencies-relations#custom">custom relations</a>.</p>
<div class="code_pre__6p81S terminal_root__AhJiA terminal_buttons__u4zIH"><h4 class="terminal_title__xmNx9">Recipe command</h4><button aria-label="Copy to clipboard" class="link_copy__GU7HF terminal_copy__dp7Rk"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon_root__gN1Pq" style="min-width:18px"><rect x="9" y="9" width="13" height="13" rx="2" ry="2" fill="none"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" fill="none"></path></svg></button><code class="code_inline-code__YR06d terminal_code__PX4L_ terminal_prompt__CPK9e"><span class="terminal_command__pri5x terminal_command-plain__muahB">prodigy</span><abbr class="terminal_command__pri5x terminal_command-title__auhoI">rel.manual</abbr><abbr class="terminal_command__pri5x terminal_cyan__J9WF_ terminal_command-title__auhoI">ner_rels_dep</abbr><abbr class="terminal_command__pri5x terminal_orange__nysCx terminal_command-title__auhoI">en_core_web_sm</abbr><abbr class="terminal_command__pri5x terminal_yellow__LaeyU terminal_command-title__auhoI">./data.jsonl</abbr><abbr class="terminal_command__pri5x terminal_pink__eCeoL terminal_command-title__auhoI">--label SUBJECT,LOCATION</abbr><abbr class="terminal_command__pri5x terminal_command-title__auhoI">--add-ents</abbr><abbr class="terminal_command__pri5x terminal_command-title__auhoI">--wrap</abbr></code></div>
<h3 id="ner-joint" class="typography_h__bPrgs typography_h3__DDnbT"><a class="" href="/docs/dependencies-relations#ner-joint"> <!-- -->Joint entity and relation annotation <!-- --> </a></h3>
<p>For some use cases, it makes sense to do entity and relation annotation <strong>at the
same time</strong>. That’s especially true if the annotation decision for both spans
and relations requires the same thought process, or if it’s difficult to
separate both tasks. In that case, you can pass an additional <code class="code_inline-code__YR06d">--span-label</code>
argument to <a class="" href="/docs/recipes#rel-manual"><code class="code_inline-code__YR06d link_content-link__oWAFe"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" class="icon_root__gN1Pq" style="min-width:14px"><path d="M21 5c-1.1-.3-2.3-.5-3.5-.5-2 0-4 .4-5.5 1.5-1.4-1.1-3.5-1.5-5.5-1.5S2.5 4.9 1 6v14.7c0 .2.3.4.5.4h.3C3 20.4 5 20 6.5 20c2 0 4 .4 5.5 1.5a12 12 0 015.5-1.5c1.6 0 3.4.3 4.8 1l.2.1c.3 0 .5-.3.5-.5V6c-.6-.5-1.3-.8-2-1zm0 13.5a11.6 11.6 0 00-9 1V8a11.6 11.6 0 019-1v11.5z"></path><path d="M17.5 10.5c.9 0 1.7 0 2.5.3V9.2a13.5 13.5 0 00-7 .6v1.7c1.1-.7 2.7-1 4.5-1zM13 12.5v1.7c1.1-.7 2.7-1 4.5-1 .9 0 1.7 0 2.5.2V12a13.5 13.5 0 00-7 .6zM17.5 14.3c-1.7 0-3.2.3-4.5.9v1.6c1.1-.6 2.7-1 4.5-1 .9 0 1.7.1 2.5.3v-1.5c-.8-.2-1.6-.3-2.5-.3z"></path></svg> <!-- -->rel.manual</code></a> defining the entity labels to assign. The
interface now has two modes: the relation annotation mode
<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="icon_root__gN1Pq" style="min-width:18px"><path d="M19 9.9l-2.7-1.6a.5.5 0 01.5-.9L19 8.7l1.3-2.4a.5.5 0 01.9.5l-1.5 2.8c-.1.3-.5.4-.7.3z M3.2 9.4a.5.5 0 01-.3-.5A8.5 8.5 0 0115.3 3c2.3 1.2 3.9 3.4 4.4 6a.5.5 0 01-1.1.2A7.5 7.5 0 004 9.2a.5.5 0 01-.8.2z M14 12h8c.6 0 1 .5 1 1v2c0 .6-.4 1-1 1h-.4c-.9 0-2-2-3.1-2-2 0-1.1 2-1.5 2h-3a1 1 0 01-1-1v-2c0-.5.4-1 1-1z M14 11h8c.6 0 1 .4 1 1v4c0 .6-.4 1-1 1h-.4c-.9 0-2-2-3.1-2-2 0-1.1 2-1.5 2h-3a1 1 0 01-1-1v-4c0-.6.4-1 1-1z M18.3 22a.4.4 0 00.4-.1l1.6-1.9h2.3c.2 0 .3-.1.4-.3 0-.1 0-.3-.2-.4L18.7 16a.4.4 0 00-.5 0c-.1 0-.2.1-.2.3v5.2c0 .2.1.3.3.4z M2 11h8c.6 0 1 .4 1 1v4c0 .6-.4 1-1 1H2a1 1 0 01-1-1v-4c0-.6.4-1 1-1z"></path></svg> to connect tokens and spans, and the span
annotation mode <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="icon_root__gN1Pq" style="min-width:18px"><path d="M21.4 7.1h-2.6v3.6a1.8 1.8 0 010 2.7v3.7h2.6c.3 0 .6-.3.6-.6V7.7c0-.3-.3-.6-.6-.6zM13.3 13.4a1.8 1.8 0 010-2.7V7.1H2.6c-.3 0-.6.3-.6.6v8.8c0 .3.3.6.6.6h10.7v-3.7zM16.4 18.1v-5.4c.4 0 .7-.3.7-.6s-.3-.6-.6-.6V6.1l1-1.1c.3-.2.3-.6 0-.8a.6.6 0 00-.8 0l-.9.8-.8-.8a.6.6 0 00-.8 0c-.3.2-.3.6 0 .8l1 1v5.5c-.3 0-.6.3-.6.6s.3.6.6.6V18l-1 1.1c-.3.2-.3.6 0 .8.2.3.6.3.8 0l.8-.8.9.8c.2.3.6.3.8 0 .3-.2.3-.6 0-.8l-1-1z"></path></svg> to manually highlight and
edit spans. To add a span, click and drag across the tokens, or hold down
<kbd class="code_kbd____AuO">shift</kbd> and click on the start and end token.</p>
<div class="code_pre__6p81S terminal_root__AhJiA terminal_buttons__u4zIH"><h4 class="terminal_title__xmNx9">Recipe command</h4><button aria-label="Copy to clipboard" class="link_copy__GU7HF terminal_copy__dp7Rk"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon_root__gN1Pq" style="min-width:18px"><rect x="9" y="9" width="13" height="13" rx="2" ry="2" fill="none"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" fill="none"></path></svg></button><code class="code_inline-code__YR06d terminal_code__PX4L_ terminal_prompt__CPK9e"><span class="terminal_command__pri5x terminal_command-plain__muahB">prodigy</span><abbr class="terminal_command__pri5x terminal_command-title__auhoI">rel.manual</abbr><abbr class="terminal_command__pri5x terminal_cyan__J9WF_ terminal_command-title__auhoI">ner_rels</abbr><abbr class="terminal_command__pri5x terminal_orange__nysCx terminal_command-title__auhoI">blank:en</abbr><abbr class="terminal_command__pri5x terminal_yellow__LaeyU terminal_command-title__auhoI">./data.jsonl</abbr><abbr class="terminal_command__pri5x terminal_pink__eCeoL terminal_command-title__auhoI">--label SUBJECT,LOCATION</abbr><abbr class="terminal_command__pri5x terminal_pink__eCeoL terminal_command-title__auhoI">--span-label PERSON,GPE</abbr></code></div>
<figure class="prodigy_placeholder-card__v2kPH">This live demo requires JavaScript to be enabled.</figure>
<ol class="typography_ol__DYgg_">
<li>
<p>Choose the <strong>span highlighting mode</strong> by clicking the
<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="icon_root__gN1Pq" style="min-width:18px"><path d="M21.4 7.1h-2.6v3.6a1.8 1.8 0 010 2.7v3.7h2.6c.3 0 .6-.3.6-.6V7.7c0-.3-.3-.6-.6-.6zM13.3 13.4a1.8 1.8 0 010-2.7V7.1H2.6c-.3 0-.6.3-.6.6v8.8c0 .3.3.6.6.6h10.7v-3.7zM16.4 18.1v-5.4c.4 0 .7-.3.7-.6s-.3-.6-.6-.6V6.1l1-1.1c.3-.2.3-.6 0-.8a.6.6 0 00-.8 0l-.9.8-.8-.8a.6.6 0 00-.8 0c-.3.2-.3.6 0 .8l1 1v5.5c-.3 0-.6.3-.6.6s.3.6.6.6V18l-1 1.1c-.3.2-.3.6 0 .8.2.3.6.3.8 0l.8-.8.9.8c.2.3.6.3.8 0 .3-.2.3-.6 0-.8l-1-1z"></path></svg> button. This will let you manually
highlight spans or remove existing spans.</p>
</li>
<li>
<p>Drag across the token “Obama” or click on it to <strong>assign it the label</strong>
<code class="code_inline-code__YR06d">PERSON</code>. Then select the label <code class="code_inline-code__YR06d">GPE</code> (geopolitical entity) at the top and do
the same for “Hawaii” and “New York”. To select multiple tokens, drag across
them and they will turn green, indicating the selection is valid. If you make
a mistake, click on the span and then on the
<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="icon_root__gN1Pq" style="min-width:18px"><path d="M15.516 3.984h3.469v2.016h-13.969v-2.016h3.469l1.031-0.984h4.969zM8.438 11.859l2.156 2.156-2.109 2.109 1.406 1.406 2.109-2.109 2.109 2.109 1.406-1.406-2.109-2.109 2.109-2.156-1.406-1.406-2.109 2.156-2.109-2.156zM6 18.984v-12h12v12c0 1.078-0.938 2.016-2.016 2.016h-7.969c-1.078 0-2.016-0.938-2.016-2.016z"></path></svg> button to remove it.</p>
</li>
<li>
<p>Choose the <strong>relations mode</strong> by clicking the
<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="icon_root__gN1Pq" style="min-width:18px"><path d="M19 9.9l-2.7-1.6a.5.5 0 01.5-.9L19 8.7l1.3-2.4a.5.5 0 01.9.5l-1.5 2.8c-.1.3-.5.4-.7.3z M3.2 9.4a.5.5 0 01-.3-.5A8.5 8.5 0 0115.3 3c2.3 1.2 3.9 3.4 4.4 6a.5.5 0 01-1.1.2A7.5 7.5 0 004 9.2a.5.5 0 01-.8.2z M14 12h8c.6 0 1 .5 1 1v2c0 .6-.4 1-1 1h-.4c-.9 0-2-2-3.1-2-2 0-1.1 2-1.5 2h-3a1 1 0 01-1-1v-2c0-.5.4-1 1-1z M14 11h8c.6 0 1 .4 1 1v4c0 .6-.4 1-1 1h-.4c-.9 0-2-2-3.1-2-2 0-1.1 2-1.5 2h-3a1 1 0 01-1-1v-4c0-.6.4-1 1-1z M18.3 22a.4.4 0 00.4-.1l1.6-1.9h2.3c.2 0 .3-.1.4-.3 0-.1 0-.3-.2-.4L18.7 16a.4.4 0 00-.5 0c-.1 0-.2.1-.2.3v5.2c0 .2.1.3.3.4z M2 11h8c.6 0 1 .4 1 1v4c0 .6-.4 1-1 1H2a1 1 0 01-1-1v-4c0-.6.4-1 1-1z"></path></svg> button. This will let you select tokens
or spans and assign relations to them.</p>
</li>
<li>
<p>Click “Obama” and then “born” to <strong>assign it the relation</strong> <code class="code_inline-code__YR06d">SUBJECT</code> and do
the same for “Obama” and “studied”. Then select the label <code class="code_inline-code__YR06d">LOCATION</code> at the
top and connect “born” and “Hawaii” and then “studied” and “New York”.</p>
</li>
</ol>
<figure><div class="embeds_responsive__ucK3q" style="padding-bottom:42.5%"><video autoplay="" loop="" muted="" playsinline="" width="800" height="340"><source src="/docs/annotation_relations.mp4" type="video/mp4"/></video></div></figure>
<p>If you have a pretrained model that already predicts <em>something</em>, you can also
set the <code class="code_inline-code__YR06d">--add-ents</code> flag to pre-highlight entities suggested by the model for
you. You can then delete incorrect spans or change their label and add missing
spans if needed.</p>
<div class="code_pre__6p81S terminal_root__AhJiA terminal_buttons__u4zIH"><h4 class="terminal_title__xmNx9">Recipe command</h4><button aria-label="Copy to clipboard" class="link_copy__GU7HF terminal_copy__dp7Rk"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon_root__gN1Pq" style="min-width:18px"><rect x="9" y="9" width="13" height="13" rx="2" ry="2" fill="none"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" fill="none"></path></svg></button><code class="code_inline-code__YR06d terminal_code__PX4L_ terminal_prompt__CPK9e"><span class="terminal_command__pri5x terminal_command-plain__muahB">prodigy</span><abbr class="terminal_command__pri5x terminal_command-title__auhoI">rel.manual</abbr><abbr class="terminal_command__pri5x terminal_cyan__J9WF_ terminal_command-title__auhoI">ner_rels</abbr><abbr class="terminal_command__pri5x terminal_orange__nysCx terminal_command-title__auhoI">blank:en</abbr><abbr class="terminal_command__pri5x terminal_yellow__LaeyU terminal_command-title__auhoI">./data.jsonl</abbr><abbr class="terminal_command__pri5x terminal_pink__eCeoL terminal_command-title__auhoI">--label SUBJECT,LOCATION</abbr><abbr class="terminal_command__pri5x terminal_pink__eCeoL terminal_command-title__auhoI">--span-label PERSON,GPE</abbr><abbr class="terminal_command__pri5x terminal_command-title__auhoI">--wrap</abbr><abbr class="terminal_command__pri5x terminal_command-title__auhoI">--add-ents</abbr></code></div>
<aside class="boxes_infobox__Ek_wd boxes_warning__rHOtg"><h4 class="boxes_title__fW1dv"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="icon_root__gN1Pq" style="min-width:18px"><path d="M21.171 15.398l-5.912-9.854c-0.776-1.293-1.963-2.033-3.259-2.033s-2.483 0.74-3.259 2.031l-5.912 9.856c-0.786 1.309-0.872 2.705-0.235 3.83 0.636 1.126 1.878 1.772 3.406 1.772h12c1.528 0 2.77-0.646 3.406-1.771 0.637-1.125 0.551-2.521-0.235-3.831zM12 17.549c-0.854 0-1.55-0.695-1.55-1.549s0.695-1.551 1.55-1.551 1.55 0.696 1.55 1.551c0 0.854-0.696 1.549-1.55 1.549zM13.633 10.125c-0.011 0.031-1.401 3.468-1.401 3.468-0.038 0.094-0.13 0.156-0.231 0.156s-0.193-0.062-0.231-0.156l-1.391-3.438c-0.090-0.233-0.129-0.443-0.129-0.655 0-0.965 0.785-1.75 1.75-1.75s1.75 0.785 1.75 1.75c0 0.212-0.039 0.422-0.117 0.625z"></path></svg> <!-- -->When to annotate jointly vs. separately</h4><p>While it’s tempting to have everything annotated in one step, it can make the
data collection process more consistent to split the annotation for different
aspects into their own separate steps. If you’re annotating relations between
spans, the span boundaries can matter <em>a lot</em> and inconsistencies can lead to
lower data quality for <em>both</em> tasks. It can therefore help to <strong>annotate and
review entities first</strong> and only add relations once you know that the data is
correct and consistent.</p><p>If spans and relations don’t <em>have to</em> be annotated at the same time, it can
also make it easier for the annotators to <strong>focus on one objective at a time</strong>.
This reduces the steps per completed annotation and the cognitive load, which
can also help prevent careless mistakes.</p></aside>
<h2 id="coref" class="typography_h__bPrgs typography_h2__ZLgRo"><a class="" href="/docs/dependencies-relations#coref"> <!-- -->Coreference Resolution <!-- --> </a></h2>
<aside class="boxes_infobox__Ek_wd boxes_warning__rHOtg"><p>Note that a coreference model is not yet a part of spaCy core. While you can
create coref annotations using Prodigy by itself, to export them with the
<code class="code_inline-code__YR06d">data-to-spacy</code> command you’ll need to install
<a target="_blank" class="link_link__DWI2E" href="https://github.com/explosion/spacy-experimental/">spacy-experimental</a> version
0.6.1 or higher.</p></aside>
<p>Coreference resolution is the challenge of linking ambiguous mentions such as
“her” or “that woman” back to an antecedent providing more context about the
entity in question. You can use the built-in <a class="" href="/docs/recipes#coref-manual"><code class="code_inline-code__YR06d link_content-link__oWAFe"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" class="icon_root__gN1Pq" style="min-width:14px"><path d="M21 5c-1.1-.3-2.3-.5-3.5-.5-2 0-4 .4-5.5 1.5-1.4-1.1-3.5-1.5-5.5-1.5S2.5 4.9 1 6v14.7c0 .2.3.4.5.4h.3C3 20.4 5 20 6.5 20c2 0 4 .4 5.5 1.5a12 12 0 015.5-1.5c1.6 0 3.4.3 4.8 1l.2.1c.3 0 .5-.3.5-.5V6c-.6-.5-1.3-.8-2-1zm0 13.5a11.6 11.6 0 00-9 1V8a11.6 11.6 0 019-1v11.5z"></path><path d="M17.5 10.5c.9 0 1.7 0 2.5.3V9.2a13.5 13.5 0 00-7 .6v1.7c1.1-.7 2.7-1 4.5-1zM13 12.5v1.7c1.1-.7 2.7-1 4.5-1 .9 0 1.7 0 2.5.2V12a13.5 13.5 0 00-7 .6zM17.5 14.3c-1.7 0-3.2.3-4.5.9v1.6c1.1-.6 2.7-1 4.5-1 .9 0 1.7.1 2.5.3v-1.5c-.8-.2-1.6-.3-2.5-.3z"></path></svg> <!-- -->coref.manual</code></a> recipe to
manually create such links. This recipe allows you to <strong>focus on nouns, proper
nouns and pronouns specifically</strong>, by disabling all other tokens. The following
command will start the web server, stream in movie summaries from
<code class="code_inline-code__YR06d code_wrap___Qsb3">plot_summaries.jsonl</code> and provide the label <code class="code_inline-code__YR06d">COREF</code> to annotate coreference
relations.</p>
<a target="_blank" class="link_link__DWI2E link_button__Hg510" href="https://raw.githubusercontent.com/explosion/prodigy-recipes/master/example-datasets/plot_summaries.jsonl"><svg xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon_root__gN1Pq link_button-icon__uxNXW" style="min-width:17px"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" fill="none"></path><polyline points="7 10 12 15 17 10" fill="none"></polyline><line x1="12" y1="15" x2="12" y2="3" fill="none"></line></svg><span class="link_button-icon-text__A1ZKQ">Download plot_summaries.jsonl</span></a>
<div class="code_pre__6p81S terminal_root__AhJiA terminal_buttons__u4zIH"><h4 class="terminal_title__xmNx9">Recipe command</h4><button aria-label="Copy to clipboard" class="link_copy__GU7HF terminal_copy__dp7Rk"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon_root__gN1Pq" style="min-width:18px"><rect x="9" y="9" width="13" height="13" rx="2" ry="2" fill="none"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" fill="none"></path></svg></button><code class="code_inline-code__YR06d terminal_code__PX4L_ terminal_prompt__CPK9e"><span class="terminal_command__pri5x terminal_command-plain__muahB">prodigy</span><abbr class="terminal_command__pri5x terminal_command-title__auhoI">coref.manual</abbr><abbr class="terminal_command__pri5x terminal_cyan__J9WF_ terminal_command-title__auhoI">coref_movies</abbr><abbr class="terminal_command__pri5x terminal_orange__nysCx terminal_command-title__auhoI">en_core_web_sm</abbr><abbr class="terminal_command__pri5x terminal_yellow__LaeyU terminal_command-title__auhoI">./plot_summaries.jsonl</abbr><abbr class="terminal_command__pri5x terminal_pink__eCeoL terminal_command-title__auhoI">--label COREF</abbr></code></div>
<figure class="prodigy_placeholder-card__v2kPH">This live demo requires JavaScript to be enabled.</figure>
<p>The recipe will use the model to automatically detect potential candidates for a
coreference relationship. You can customize the labels used for the extraction
via the <a class="link_link__DWI2E" href="/docs/recipes#coref-manual">recipe arguments</a> to match the model you’re
using. You can also set up your very own custom relation annotation workflow by
defining <a class="link_link__DWI2E" href="/docs/dependencies-relations#custom">custom rules</a> for spans and disabled tokens.</p>
<p>To annotate, click a word or phrase and next the word or phrase you want to
connect it to. To remove an existing relationship, you can click its label. In
the above example, two coreference relationships are already annotated: “her”
→ “Lindy” and “she” → “Lindy”. Other mentions of “she” and “her” in
the sentence should be carefully annotated as either referring back to “Lindy”
or “Azaria”. Each relation you annotate will be saved as an entry under the key
<code class="code_inline-code__YR06d">&quot;relations&quot;</code>.</p>
<pre class="code_pre__6p81S prism-code language-json code_has-title__mPEZM"><header class="code_header__qA8Vq"><h3 class="code_title__FYds0">Single relation (example)</h3></header><code class="code_inline-code__YR06d"><div class="code_line__spK2p"><span class="token punctuation">{</span><span class="token plain"></span></div><div class="code_line__spK2p"><span class="token plain">   </span><span class="token property">&quot;head&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">8</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="code_line__spK2p"><span class="token plain">   </span><span class="token property">&quot;head_span&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token property">&quot;start&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">38</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token property">&quot;end&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">41</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token property">&quot;token_start&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">8</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token property">&quot;token_end&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">8</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token property">&quot;label&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token null keyword">null</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="code_line__spK2p"><span class="token plain">   </span><span class="token property">&quot;child&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="code_line__spK2p"><span class="token plain">   </span><span class="token property">&quot;child_span&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token property">&quot;start&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token property">&quot;end&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">5</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token property">&quot;token_start&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token property">&quot;token_end&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token property">&quot;label&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&quot;PERSON&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="code_line__spK2p"><span class="token plain">   </span><span class="token property">&quot;label&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&quot;COREF&quot;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="code_line__spK2p"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div></code></pre>
<details class="boxes_accordion__ITHv7"><summary class="boxes_accordion-title__mDMNo"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 14 14" fill="currentColor" class="icon_root__gN1Pq boxes_accordion-icon__tAdkU" style="min-width:18px"><path d="M6 4h2v2H6V4Zm0 4h2v2H6V8ZM4 2h2v2H4V2Zm4 4h2v2H8V6Zm-4 4h2v2H4v-2Z"></path></svg> <!-- -->What&#x27;s the difference between head and child?</summary><p>Prodigy will record the direction of the relationship, from the “head” to the
“child”. This is relevant for many tasks like syntactic dependency annotation,
but less relevant for tasks like coreference resolution, where you mostly care
about pairs of coreference relations. For this use case, you can just treat the
<code class="code_inline-code__YR06d">&quot;head&quot;</code> and <code class="code_inline-code__YR06d">&quot;child&quot;</code> values of the relation as interchangable and just
consider them as one coreference pair.</p></details>
<h2 id="custom" class="typography_h__bPrgs typography_h2__ZLgRo"><a class="" href="/docs/dependencies-relations#custom"> <!-- -->Custom dependencies and relations <!-- --> </a></h2>
<p>Prodigy’s <a class="" href="/docs/recipes#rel-manual"><code class="code_inline-code__YR06d link_content-link__oWAFe"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" class="icon_root__gN1Pq" style="min-width:14px"><path d="M21 5c-1.1-.3-2.3-.5-3.5-.5-2 0-4 .4-5.5 1.5-1.4-1.1-3.5-1.5-5.5-1.5S2.5 4.9 1 6v14.7c0 .2.3.4.5.4h.3C3 20.4 5 20 6.5 20c2 0 4 .4 5.5 1.5a12 12 0 015.5-1.5c1.6 0 3.4.3 4.8 1l.2.1c.3 0 .5-.3.5-.5V6c-.6-.5-1.3-.8-2-1zm0 13.5a11.6 11.6 0 00-9 1V8a11.6 11.6 0 019-1v11.5z"></path><path d="M17.5 10.5c.9 0 1.7 0 2.5.3V9.2a13.5 13.5 0 00-7 .6v1.7c1.1-.7 2.7-1 4.5-1zM13 12.5v1.7c1.1-.7 2.7-1 4.5-1 .9 0 1.7 0 2.5.2V12a13.5 13.5 0 00-7 .6zM17.5 14.3c-1.7 0-3.2.3-4.5.9v1.6c1.1-.6 2.7-1 4.5-1 .9 0 1.7.1 2.5.3v-1.5c-.8-.2-1.6-.3-2.5-.3z"></path></svg> <!-- -->rel.manual</code></a> recipe allows building very powerful custom
workflows for semi-automated dependency and relation annotation. It’s based on
the following philosophy:</p>
<ol class="typography_ol__DYgg_">
<li>
<p><strong>Dependencies should refer to consistent units.</strong> For example, relations
might refer to named entities predicted by a named entity recognizer, or noun
phrases extracted using part-of-speech tags and syntactic dependency labels.
You shouldn’t have to ask your annotator to label all of this from scratch,
if you can automate it – instead, they should only have to correct mistakes.
Using a pretrained model and rules to <strong>pre-highlight spans to annotate</strong> can
make data creation faster and more consistent.</p>
</li>
<li>
<p><strong>Not all tokens are relevant.</strong> For instance, for many tasks, punctuation
(outside of entities) is never going to be part of a relation you’re
annotating. If you’re annotating nominal coreference, you only need to focus
on nouns, proper nouns and pronouns. Or maybe you only want to annotate
relations between entity spans and ignore all other tokens. <strong>Disabling
irrelevant tokens</strong> automatically lets you and your annotators focus on what
matters, speeds up the process and prevents mistakes.</p>
</li>
</ol>
<p>You can customize your workflow using the following
<a class="link_link__DWI2E" href="/docs/recipes#rel-manual">recipe settings</a>:</p>
<figure class="typography_table__mwdFk"><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><code class="code_inline-code__YR06d">--label</code></td><td>Relation label(s) to annotate manually in relation annotation mode <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="icon_root__gN1Pq" style="min-width:18px"><path d="M19 9.9l-2.7-1.6a.5.5 0 01.5-.9L19 8.7l1.3-2.4a.5.5 0 01.9.5l-1.5 2.8c-.1.3-.5.4-.7.3z M3.2 9.4a.5.5 0 01-.3-.5A8.5 8.5 0 0115.3 3c2.3 1.2 3.9 3.4 4.4 6a.5.5 0 01-1.1.2A7.5 7.5 0 004 9.2a.5.5 0 01-.8.2z M14 12h8c.6 0 1 .5 1 1v2c0 .6-.4 1-1 1h-.4c-.9 0-2-2-3.1-2-2 0-1.1 2-1.5 2h-3a1 1 0 01-1-1v-2c0-.5.4-1 1-1z M14 11h8c.6 0 1 .4 1 1v4c0 .6-.4 1-1 1h-.4c-.9 0-2-2-3.1-2-2 0-1.1 2-1.5 2h-3a1 1 0 01-1-1v-4c0-.6.4-1 1-1z M18.3 22a.4.4 0 00.4-.1l1.6-1.9h2.3c.2 0 .3-.1.4-.3 0-.1 0-.3-.2-.4L18.7 16a.4.4 0 00-.5 0c-.1 0-.2.1-.2.3v5.2c0 .2.1.3.3.4z M2 11h8c.6 0 1 .4 1 1v4c0 .6-.4 1-1 1H2a1 1 0 01-1-1v-4c0-.6.4-1 1-1z"></path></svg>.</td></tr><tr><td><code class="code_inline-code__YR06d">--span-label</code></td><td>Span label(s) to annotate manually in span annotation mode <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="icon_root__gN1Pq" style="min-width:18px"><path d="M21.4 7.1h-2.6v3.6a1.8 1.8 0 010 2.7v3.7h2.6c.3 0 .6-.3.6-.6V7.7c0-.3-.3-.6-.6-.6zM13.3 13.4a1.8 1.8 0 010-2.7V7.1H2.6c-.3 0-.6.3-.6.6v8.8c0 .3.3.6.6.6h10.7v-3.7zM16.4 18.1v-5.4c.4 0 .7-.3.7-.6s-.3-.6-.6-.6V6.1l1-1.1c.3-.2.3-.6 0-.8a.6.6 0 00-.8 0l-.9.8-.8-.8a.6.6 0 00-.8 0c-.3.2-.3.6 0 .8l1 1v5.5c-.3 0-.6.3-.6.6s.3.6.6.6V18l-1 1.1c-.3.2-.3.6 0 .8.2.3.6.3.8 0l.8-.8.9.8c.2.3.6.3.8 0 .3-.2.3-.6 0-.8l-1-1z"></path></svg>.</td></tr><tr><td><code class="code_inline-code__YR06d">--patterns</code></td><td><a class="link_link__DWI2E" href="/docs/api-loaders#input-patterns">Match patterns</a> defining spans to be added.</td></tr><tr><td><code class="code_inline-code__YR06d">--disable-patterns</code></td><td><a class="link_link__DWI2E" href="/docs/api-loaders#input-patterns">Match patterns</a> defining tokens to disable.</td></tr><tr><td><code class="code_inline-code__YR06d">--add-ents</code></td><td>Add entities predicted by the model as spans.</td></tr><tr><td><code class="code_inline-code__YR06d">--add-nps</code></td><td>Add noun phrases based on tagger and parser, if rules are available.</td></tr></tbody></table></figure>
<h3 id="example-bio" class="typography_h__bPrgs typography_h3__DDnbT"><a class="" href="/docs/dependencies-relations#example-bio"> <!-- -->Example: Custom biomedical relation annotation <!-- --> </a></h3>
<p>Annotating biomedical events from literature is a complex task, and serves as a
good example for the relation annotation functionality. Here, we follow the
annotation scheme from the
<a target="_blank" class="link_link__DWI2E" href="http://2011.bionlp-st.org/home/genia-event-extraction-genia">BioNLP 2011 GENIA Shared Task</a>,
which has been the foundation of many bio-event extraction algorithms in the
last decade and has become a <em>de facto</em> standard. The annotation process
involves the following:</p>
<ul class="typography_ul__0W6AC">
<li>Annotate spans of one or more tokens describing <strong>genes and gene products</strong>
(“GGPs”). In the original Shared Task, these were provided as gold
annotations.</li>
<li>Identify <strong>trigger words or spans</strong> like “stabilizes” referring to a positive
regulation. There are 9 different relation/event types: gene expression,
transcription, protein catabolism, phosphorylation, localization, binding,
regulation, positive regulation and negative regulation.</li>
<li>Connect trigger words to at least the <strong>object of the event</strong>, also called
“theme”, which is usually a GGP. Binding events can have multiple theme
annotations.</li>
<li>Connect regulation events to the <strong>subject of the event</strong>, also called
“cause”, if available. For the regulation events, both the “theme” and “cause”
arguments can be GGPs or other events, thus allowing a <strong>nested structure</strong> of
events.</li>
</ul>
<p>For this example, we have prepared a sample of 200 sentences in
<code class="code_inline-code__YR06d">bio_events.jsonl</code>, taken from the Shared Task. As the Shared Task came with
gold-standard annotations of genes and proteins, we have already added those
<code class="code_inline-code__YR06d">GGP</code> spans to the input text. We also know that we’re only interested in
<strong>nouns, proper nouns, verbs and adjectives</strong> or other spans that have been
pre-tagged as <code class="code_inline-code__YR06d">GGP</code>. So we can write a disable pattern that disables all tokens
that do not have those part-of-speech tags and are also not part of the
pre-labelled <code class="code_inline-code__YR06d">GGP</code> spans.</p>
<pre class="code_pre__6p81S prism-code language-json code_has-title__mPEZM"><header class="code_header__qA8Vq"><h3 class="code_title__FYds0">patterns_disable_bio_rel.jsonl</h3></header><code class="code_inline-code__YR06d"><div class="code_line__spK2p"><span class="token punctuation">{</span><span class="token property">&quot;pattern&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token property">&quot;POS&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token property">&quot;NOT_IN&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token string">&quot;NOUN&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;PROPN&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;VERB&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;ADJ&quot;</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token property">&quot;_&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token property">&quot;label&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token property">&quot;NOT_IN&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token string">&quot;GGP&quot;</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token plain"></span></div></code></pre>
<aside class="boxes_infobox__Ek_wd"><p>Spans that are already present in the data or set by the recipe via <code class="code_inline-code__YR06d">--add-ents</code>
or <code class="code_inline-code__YR06d">--add-nps</code> will receive a custom
<a target="_blank" class="link_link__DWI2E" href="https://spacy.io/usage/processing-pipelines#custom-components-attributes">extension attribute</a>
<code class="code_inline-code__YR06d">label</code>. You can then address them in your disable patterns via the <code class="code_inline-code__YR06d">&quot;_&quot;</code>
property, as shown in the example above – e.g., to disable all tokens that are
<em>not</em> part of a certain entity.</p></aside>
<p>The following command will start the web server, stream in the biomedical
sentences from <code class="code_inline-code__YR06d">bio_events.jsonl</code>, apply the disable rules, and provide a list
of relevant span labels as well as the standard relations <code class="code_inline-code__YR06d">Cause</code> (the subject
of an event) and <code class="code_inline-code__YR06d">Theme</code> (the object of an event).</p>
<a target="_blank" class="link_link__DWI2E link_button__Hg510" href="https://raw.githubusercontent.com/explosion/prodigy-recipes/master/example-datasets/bio_events.jsonl"><svg xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon_root__gN1Pq link_button-icon__uxNXW" style="min-width:17px"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" fill="none"></path><polyline points="7 10 12 15 17 10" fill="none"></polyline><line x1="12" y1="15" x2="12" y2="3" fill="none"></line></svg><span class="link_button-icon-text__A1ZKQ">Download bio_events.jsonl</span></a>
<a target="_blank" class="link_link__DWI2E link_button__Hg510" href="https://raw.githubusercontent.com/explosion/prodigy-recipes/master/example-patterns/patterns_disable_bio_rel.jsonl"><svg xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon_root__gN1Pq link_button-icon__uxNXW" style="min-width:17px"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" fill="none"></path><polyline points="7 10 12 15 17 10" fill="none"></polyline><line x1="12" y1="15" x2="12" y2="3" fill="none"></line></svg><span class="link_button-icon-text__A1ZKQ">Download patterns_disable_bio_rel.jsonl</span></a>
<div class="code_pre__6p81S terminal_root__AhJiA terminal_buttons__u4zIH"><h4 class="terminal_title__xmNx9">Recipe command</h4><button aria-label="Copy to clipboard" class="link_copy__GU7HF terminal_copy__dp7Rk"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon_root__gN1Pq" style="min-width:18px"><rect x="9" y="9" width="13" height="13" rx="2" ry="2" fill="none"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" fill="none"></path></svg></button><code class="code_inline-code__YR06d terminal_code__PX4L_ terminal_prompt__CPK9e"><span class="terminal_command__pri5x terminal_command-plain__muahB">prodigy</span><abbr class="terminal_command__pri5x terminal_command-title__auhoI">rel.manual</abbr><abbr class="terminal_command__pri5x terminal_cyan__J9WF_ terminal_command-title__auhoI">rel_bio</abbr><abbr class="terminal_command__pri5x terminal_orange__nysCx terminal_command-title__auhoI">en_core_web_sm</abbr><abbr class="terminal_command__pri5x terminal_yellow__LaeyU terminal_command-title__auhoI">./bio_events.jsonl</abbr><abbr class="terminal_command__pri5x terminal_pink__eCeoL terminal_command-title__auhoI">--label Theme,Cause</abbr><abbr class="terminal_command__pri5x terminal_pink__eCeoL terminal_command-title__auhoI">--span-label GGP,Gene_Expr,Transcr,Prot_Cat,Phosph,Loc,Bind,Reg,Reg+,Reg-</abbr><abbr class="terminal_command__pri5x terminal_purple__UsE_t terminal_command-title__auhoI">--disable-patterns patterns_disable_bio_rel.jsonl</abbr><abbr class="terminal_command__pri5x terminal_command-title__auhoI">--wrap</abbr></code></div>
<figure class="prodigy_placeholder-card__v2kPH">This live demo requires JavaScript to be enabled.</figure>
<ol class="typography_ol__DYgg_">
<li>
<p>The BioNLP ST’11 annotation scheme has “trigger words” that refer to the span
of tokens that expresses a relation. For instance, “stabilizes” refers to a
positive regulation. You can annotate it as such by going to the <strong>span
annotation mode</strong> <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="icon_root__gN1Pq" style="min-width:18px"><path d="M21.4 7.1h-2.6v3.6a1.8 1.8 0 010 2.7v3.7h2.6c.3 0 .6-.3.6-.6V7.7c0-.3-.3-.6-.6-.6zM13.3 13.4a1.8 1.8 0 010-2.7V7.1H2.6c-.3 0-.6.3-.6.6v8.8c0 .3.3.6.6.6h10.7v-3.7zM16.4 18.1v-5.4c.4 0 .7-.3.7-.6s-.3-.6-.6-.6V6.1l1-1.1c.3-.2.3-.6 0-.8a.6.6 0 00-.8 0l-.9.8-.8-.8a.6.6 0 00-.8 0c-.3.2-.3.6 0 .8l1 1v5.5c-.3 0-.6.3-.6.6s.3.6.6.6V18l-1 1.1c-.3.2-.3.6 0 .8.2.3.6.3.8 0l.8-.8.9.8c.2.3.6.3.8 0 .3-.2.3-.6 0-.8l-1-1z"></path></svg>, selecting the label
<code class="code_inline-code__YR06d">Reg+</code> and clicking on the token “stabilizes”. Similarly, annotate “enabling”
as <code class="code_inline-code__YR06d">Reg+</code> and “activities” as <code class="code_inline-code__YR06d">Reg</code>.</p>
</li>
<li>
<p>Now select the <strong>relations mode</strong> by clicking the
<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="icon_root__gN1Pq" style="min-width:18px"><path d="M19 9.9l-2.7-1.6a.5.5 0 01.5-.9L19 8.7l1.3-2.4a.5.5 0 01.9.5l-1.5 2.8c-.1.3-.5.4-.7.3z M3.2 9.4a.5.5 0 01-.3-.5A8.5 8.5 0 0115.3 3c2.3 1.2 3.9 3.4 4.4 6a.5.5 0 01-1.1.2A7.5 7.5 0 004 9.2a.5.5 0 01-.8.2z M14 12h8c.6 0 1 .5 1 1v2c0 .6-.4 1-1 1h-.4c-.9 0-2-2-3.1-2-2 0-1.1 2-1.5 2h-3a1 1 0 01-1-1v-2c0-.5.4-1 1-1z M14 11h8c.6 0 1 .4 1 1v4c0 .6-.4 1-1 1h-.4c-.9 0-2-2-3.1-2-2 0-1.1 2-1.5 2h-3a1 1 0 01-1-1v-4c0-.6.4-1 1-1z M18.3 22a.4.4 0 00.4-.1l1.6-1.9h2.3c.2 0 .3-.1.4-.3 0-.1 0-.3-.2-.4L18.7 16a.4.4 0 00-.5 0c-.1 0-.2.1-.2.3v5.2c0 .2.1.3.3.4z M2 11h8c.6 0 1 .4 1 1v4c0 .6-.4 1-1 1H2a1 1 0 01-1-1v-4c0-.6.4-1 1-1z"></path></svg> button. To annotate the first relation,
select the relation type “Cause”, click on the trigger “stabilizes” to select
it, then on the <code class="code_inline-code__YR06d">GGP</code> “Mdmx” to define it as the subject (cause) of this
event. Similarly, you can annotate “Mdm2” as being the object of this same
event by also connecting it to the “stabilizes” trigger with the <code class="code_inline-code__YR06d">Theme</code>
relation type. This relation annotation style allows you to create <strong>nested
events</strong>, as one event “e.g. activities of p53” could be the <code class="code_inline-code__YR06d">Theme</code> of
another event (“Mdm2 enabling it”).</p>
</li>
</ol>
<p>The final annotated task should look like this:</p>
<figure class="prodigy_placeholder-card__v2kPH">This live demo requires JavaScript to be enabled.</figure>
<p>In an end-to-end setting, you could predict the gene/protein mentions with an
NER model trained for this challenge specifically, like for instance the models
trained on scientific documents from the
<a target="_blank" class="link_link__DWI2E" href="https://github.com/allenai/scispacy#available-models">scispaCy</a> project.</p>
<h2 id="custom-model" class="typography_h__bPrgs typography_h2__ZLgRo"><a class="" href="/docs/dependencies-relations#custom-model"> <!-- -->Using a custom model <!-- --> </a></h2>
<p>You don’t need to use spaCy to let a model highlight suggestions for you. Under
the hood, the concept is pretty straightforward: if you stream in examples with
pre-defined <code class="code_inline-code__YR06d">&quot;tokens&quot;</code>, <code class="code_inline-code__YR06d">&quot;relations&quot;</code> and optional <code class="code_inline-code__YR06d">&quot;spans&quot;</code>, Prodigy will
accept and pre-highlight them. This means you can either stream in pre-labelled
data, or write a custom recipe that uses your model to add tokens and relations
to your data.</p>
<pre class="code_pre__6p81S prism-code language-json code_has-title__mPEZM"><header class="code_header__qA8Vq"><h3 class="code_title__FYds0">Expected format</h3></header><code class="code_inline-code__YR06d"><div class="code_line__spK2p"><span class="token punctuation">{</span><span class="token plain"></span></div><div class="code_line__spK2p"><span class="token plain">  </span><span class="token property">&quot;text&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&quot;I like cute cats&quot;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="code_line__spK2p"><span class="token plain">  </span><span class="token property">&quot;tokens&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="code_line__spK2p"><span class="token plain">    </span><span class="token punctuation">{</span><span class="token property">&quot;text&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&quot;I&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token property">&quot;start&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token property">&quot;end&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="code_line__spK2p"><span class="token plain">    </span><span class="token punctuation">{</span><span class="token property">&quot;text&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&quot;like&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token property">&quot;start&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">2</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token property">&quot;end&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">6</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="code_line__spK2p"><span class="token plain">    </span><span class="token punctuation">{</span><span class="token property">&quot;text&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&quot;cute&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token property">&quot;start&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">7</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token property">&quot;end&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">11</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="code_line__spK2p"><span class="token plain">    </span><span class="token punctuation">{</span><span class="token property">&quot;text&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&quot;cats&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token property">&quot;start&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">12</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token property">&quot;end&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">16</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">3</span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="code_line__spK2p"><span class="token plain">  </span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="code_line__spK2p"><span class="token plain">  </span><span class="token property">&quot;relations&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="code_line__spK2p"><span class="token plain">    </span><span class="token punctuation">{</span><span class="token property">&quot;child&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token property">&quot;head&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token property">&quot;label&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&quot;nsubj&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="code_line__spK2p"><span class="token plain">    </span><span class="token punctuation">{</span><span class="token property">&quot;child&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token property">&quot;head&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token property">&quot;label&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&quot;ROOT&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="code_line__spK2p"><span class="token plain">    </span><span class="token punctuation">{</span><span class="token property">&quot;child&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">2</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token property">&quot;head&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">3</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token property">&quot;label&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&quot;amod&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="code_line__spK2p"><span class="token plain">    </span><span class="token punctuation">{</span><span class="token property">&quot;child&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">3</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token property">&quot;head&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token property">&quot;label&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&quot;dobj&quot;</span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="code_line__spK2p"><span class="token plain">  </span><span class="token punctuation">]</span><span class="token plain"></span></div><div class="code_line__spK2p"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div></code></pre>
<figure class="prodigy_placeholder-card__v2kPH">This live demo requires JavaScript to be enabled.</figure>
<p>For example, let’s say your model returns the syntactic dependencies as a list
of token-based tags like <code class="code_inline-code__YR06d code_wrap___Qsb3">[&quot;nsubj&quot;, &quot;ROOT&quot;, &quot;amod&quot;, &quot;dobj&quot;]</code> and head indices
like <code class="code_inline-code__YR06d">[1, 1, 3, 1]</code>. You could then generate your data like this and add a
<code class="code_inline-code__YR06d">&quot;head&quot;</code>, <code class="code_inline-code__YR06d">&quot;child&quot;</code> and <code class="code_inline-code__YR06d">&quot;label&quot;</code> value for each relation:</p>
<pre class="code_pre__6p81S prism-code language-python code_has-title__mPEZM"><header class="code_header__qA8Vq"><h3 class="code_title__FYds0">Step 1: Write the stream generator</h3></header><code class="code_inline-code__YR06d"><div class="code_line__spK2p"><span class="token keyword code_prefix___bN8x">def</span><span class="token plain"> </span><span class="token function">add_relations_to_stream</span><span class="token punctuation">(</span><span class="token plain">stream</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token plain"></span></div><div class="code_line__spK2p"><span class="token plain">   custom_model </span><span class="token operator code_prefix___bN8x">=</span><span class="token plain"> load_your_custom_model</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="code_line__spK2p"><span class="token plain">   </span><span class="token keyword code_prefix___bN8x">for</span><span class="token plain"> eg </span><span class="token keyword">in</span><span class="token plain"> stream</span><span class="token punctuation">:</span><span class="token plain"></span></div><div class="code_line__spK2p"><span class="token plain">      deps</span><span class="token punctuation code_prefix___bN8x">,</span><span class="token plain"> heads </span><span class="token operator">=</span><span class="token plain"> custom_model</span><span class="token punctuation">(</span><span class="token plain">eg</span><span class="token punctuation">[</span><span class="token string">&quot;text&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="code_line__spK2p"><span class="token plain">      eg</span><span class="token punctuation code_prefix___bN8x">[</span><span class="token string">&quot;relations&quot;</span><span class="token punctuation">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token plain"></span></div><div class="code_line__spK2p"><span class="token plain">      </span><span class="token keyword code_prefix___bN8x">for</span><span class="token plain"> i</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain">label</span><span class="token punctuation">,</span><span class="token plain"> head</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token keyword">in</span><span class="token plain"> </span><span class="token builtin">enumerate</span><span class="token punctuation">(</span><span class="token builtin">zip</span><span class="token punctuation">(</span><span class="token plain">deps</span><span class="token punctuation">,</span><span class="token plain"> heads</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token plain"></span></div><div class="code_line__spK2p"><span class="token plain">         eg</span><span class="token punctuation code_prefix___bN8x">[</span><span class="token string">&quot;relations&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token plain">append</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;child&quot;</span><span class="token punctuation">:</span><span class="token plain"> i</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;head&quot;</span><span class="token punctuation">:</span><span class="token plain"> head</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;label&quot;</span><span class="token punctuation">:</span><span class="token plain"> label</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="code_line__spK2p"><span class="token plain">      </span><span class="token keyword code_prefix___bN8x">yield</span><span class="token plain"> eg</span></div></code></pre>
<p>If you want to extract and add the dependencies at runtime, you can write a
<a class="link_link__DWI2E" href="/docs/custom-recipes">custom recipe</a> that loads the raw data, uses your custom
model to add <code class="code_inline-code__YR06d">&quot;relations&quot;</code> to the stream, pre-tokenizes the text and then
renders it all using the <a class="" href="/docs/api-interfaces#relations"><code class="code_inline-code__YR06d link_content-link__oWAFe"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon_root__gN1Pq" style="min-width:14px"><rect x="3" y="3" width="18" height="18" rx="2" ry="2" fill="none"></rect><circle cx="8.5" cy="8.5" r="1.5" fill="none"></circle><polyline points="21 15 16 10 5 21" fill="none"></polyline></svg> <!-- -->relations</code></a> interface.</p>
<pre class="code_pre__6p81S prism-code language-python code_has-title__mPEZM"><header class="code_header__qA8Vq"><h3 class="code_title__FYds0">Step 2: Putting it all together in a recipe</h3></header><code class="code_inline-code__YR06d"><div class="code_line__spK2p"><span class="token keyword code_prefix___bN8x">import</span><span class="token plain"> prodigy</span></div><div class="code_line__spK2p"><span class="token plain"></span><span class="token keyword code_prefix___bN8x">from</span><span class="token plain"> prodigy</span><span class="token punctuation">.</span><span class="token plain">components</span><span class="token punctuation">.</span><span class="token plain">stream </span><span class="token keyword">import</span><span class="token plain"> get_stream</span></div><div class="code_line__spK2p"><span class="token plain"></span><span class="token keyword code_prefix___bN8x">from</span><span class="token plain"> prodigy</span><span class="token punctuation">.</span><span class="token plain">components</span><span class="token punctuation">.</span><span class="token plain">preprocess </span><span class="token keyword">import</span><span class="token plain"> add_tokens</span></div><div class="code_line__spK2p"><span class="token plain"></span><span class="token keyword code_prefix___bN8x">import</span><span class="token plain"> spacy</span></div><div class="code_line__spK2p"><span class="token plain">
</span></div><div class="code_line__spK2p"><span class="token plain"></span><span class="token decorator annotation punctuation code_prefix___bN8x">@prodigy</span><span class="token decorator annotation punctuation">.</span><span class="token decorator annotation punctuation">recipe</span><span class="token punctuation">(</span><span class="token string">&quot;custom-dep&quot;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="code_line__spK2p"><span class="token plain"></span><span class="token keyword code_prefix___bN8x">def</span><span class="token plain"> </span><span class="token function">custom_dep_recipe</span><span class="token punctuation">(</span><span class="token plain">dataset</span><span class="token punctuation">,</span><span class="token plain"> source</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token plain"></span></div><div class="code_line__spK2p"><span class="token plain">    stream </span><span class="token operator code_prefix___bN8x">=</span><span class="token plain"> get_stream</span><span class="token punctuation">(</span><span class="token plain">source</span><span class="token punctuation">)</span><span class="token plain">                     </span><span class="token comment"># load the data</span><span class="token plain"></span></div><div class="code_line__spK2p"><span class="token plain">    stream </span><span class="token operator code_prefix___bN8x">=</span><span class="token plain"> add_relations_to_stream</span><span class="token punctuation">(</span><span class="token plain">stream</span><span class="token punctuation">)</span><span class="token plain">        </span><span class="token comment"># add custom relations</span><span class="token plain"></span></div><div class="code_line__spK2p"><span class="token plain">    stream </span><span class="token operator code_prefix___bN8x">=</span><span class="token plain"> add_tokens</span><span class="token punctuation">(</span><span class="token plain">spacy</span><span class="token punctuation">.</span><span class="token plain">blank</span><span class="token punctuation">(</span><span class="token string">&quot;en&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"> stream</span><span class="token punctuation">)</span><span class="token plain">  </span><span class="token comment"># add &quot;tokens&quot; to stream</span><span class="token plain"></span></div><div class="code_line__spK2p"><span class="token plain">
</span></div><div class="code_line__spK2p"><span class="token plain">    </span><span class="token keyword code_prefix___bN8x">return</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="code_line__spK2p"><span class="token plain">        </span><span class="token string code_prefix___bN8x">&quot;dataset&quot;</span><span class="token punctuation">:</span><span class="token plain"> dataset</span><span class="token punctuation">,</span><span class="token plain">      </span><span class="token comment"># dataset to save annotations to</span><span class="token plain"></span></div><div class="code_line__spK2p"><span class="token plain">        </span><span class="token string code_prefix___bN8x">&quot;stream&quot;</span><span class="token punctuation">:</span><span class="token plain"> stream</span><span class="token punctuation">,</span><span class="token plain">        </span><span class="token comment"># the incoming stream of examples</span><span class="token plain"></span></div><div class="code_line__spK2p"><span class="token plain">        </span><span class="token string code_prefix___bN8x">&quot;view_id&quot;</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&quot;relations&quot;</span><span class="token punctuation">,</span><span class="token plain">  </span><span class="token comment"># annotation interface to use</span><span class="token plain"></span></div><div class="code_line__spK2p"><span class="token plain">        </span><span class="token string code_prefix___bN8x">&quot;labels&quot;</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token string">&quot;ROOT&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;nsubj&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;amod&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;dobj&quot;</span><span class="token punctuation">]</span><span class="token plain">  </span><span class="token comment"># labels to annotate</span><span class="token plain"></span></div><div class="code_line__spK2p"><span class="token plain">    </span><span class="token punctuation code_prefix___bN8x">}</span><span class="token plain"></span></div></code></pre><footer class="docs_next__HFi07"><span class="docs_next-text__vYh4C"><strong><a class="" href="/docs/computer-vision">Read next</a></strong><a class="link_link__DWI2E" href="/docs/computer-vision">Computer Vision</a></span><a class="" href="/docs/computer-vision"><svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 14 14" fill="currentColor" class="icon_root__gN1Pq" style="min-width:26px"><path d="M6 4h2v2H6V4Zm0 4h2v2H6V8ZM4 2h2v2H4V2Zm4 4h2v2H8V6Zm-4 4h2v2H4v-2Z"></path></svg></a></footer></article><footer class="layout_footer__hJz0b docs_footer__h_XJf layout_footer-narrow__E_Ott"><ul><li class="layout_footer-title__FnZcI">Navigation</li><li class="layout_footer-item__591pN"><a class="" href="/docs">Documentation</a></li><li class="layout_footer-item__591pN"><a class="" href="/buy">Get Prodigy</a></li><li class="layout_footer-item__591pN"><a target="_blank" class="" href="https://demo.prodi.gy">Live Demo</a></li><li class="layout_footer-item__591pN"><a target="_blank" class="" href="https://support.prodi.gy">Support Forum</a></li><li class="layout_footer-item__591pN"><a target="_blank" class="" href="https://explosion.ai/tailored-solutions">Custom Solutions</a></li><li class="layout_footer-item__591pN"><a target="_blank" class="" href="https://explosion.ai/_/project/prodigy">Blog</a></li></ul><ul><li class="layout_footer-title__FnZcI">Features</li><li class="layout_footer-item__591pN"><a class="" href="/features/information-extraction">Information Extraction</a></li><li class="layout_footer-item__591pN"><a class="" href="/features/language-model-training">Language Model Training</a></li><li class="layout_footer-item__591pN"><a class="" href="/features/computer-vision">Computer Vision</a></li><li class="layout_footer-item__591pN"><a class="" href="/features/audio-video">Audio &amp; Video</a></li><li class="layout_footer-item__591pN"><a class="" href="/features/prompt-engineering">Prompt Engineering</a></li><li class="layout_footer-item__591pN"><a class="" href="/features/custom-workflows">Custom Workflows</a></li></ul><ul><li class="layout_footer-title__FnZcI">Industries</li><li class="layout_footer-item__591pN"><a class="" href="/industries/banking-finance">Banking &amp; Finance</a></li><li class="layout_footer-item__591pN"><a class="" href="/industries/healthcare-biomedical">Healthcare &amp; Biomedical</a></li><li class="layout_footer-item__591pN"><a class="" href="/industries/media-content-creation">Media &amp; Content Creation</a></li><li class="layout_footer-item__591pN"><a class="" href="/industries/legal-insurance">Legal &amp; Insurance</a></li><li class="layout_footer-item__591pN"><a class="" href="/industries/conversation-insights">Conversation &amp; Insights</a></li><li class="layout_footer-item__591pN"><a class="" href="/industries/research-education">Research &amp; Education</a></li></ul><div class="layout_footer-bottom__C9x5B"><ul class="layout_footer-meta__2SgeV"><li><a target="_blank" class="" rel="me" title="Email" href="mailto:contact@explosion.ai"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="icon_root__gN1Pq" style="min-width:16px"><path d="M8.237 1.56a.5.5 0 0 0-.474 0L1.789 4.777a1.499 1.499 0 0 0-.57.54L8 8.933l6.78-3.616a1.498 1.498 0 0 0-.569-.54L8.237 1.56z"></path><path d="M15 6.333L8.235 9.941a.5.5 0 0 1-.47 0L1 6.333V12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V6.333z"></path></svg></a></li><li><a target="_blank" class="" rel="me" title="GitHub" href="https://github.com/explosion"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 28" fill="currentColor" class="icon_root__gN1Pq" style="min-width:16px"><path d="M12 2q3.266 0 6.023 1.609t4.367 4.367 1.609 6.023q0 3.922-2.289 7.055t-5.914 4.336q-0.422 0.078-0.625-0.109t-0.203-0.469q0-0.047 0.008-1.195t0.008-2.102q0-1.516-0.812-2.219 0.891-0.094 1.602-0.281t1.469-0.609 1.266-1.039 0.828-1.641 0.32-2.352q0-1.859-1.234-3.219 0.578-1.422-0.125-3.187-0.438-0.141-1.266 0.172t-1.437 0.688l-0.594 0.375q-1.453-0.406-3-0.406t-3 0.406q-0.25-0.172-0.664-0.422t-1.305-0.602-1.328-0.211q-0.703 1.766-0.125 3.187-1.234 1.359-1.234 3.219 0 1.328 0.32 2.344t0.82 1.641 1.258 1.047 1.469 0.609 1.602 0.281q-0.609 0.562-0.766 1.609-0.328 0.156-0.703 0.234t-0.891 0.078-1.023-0.336-0.867-0.977q-0.297-0.5-0.758-0.812t-0.773-0.375l-0.313-0.047q-0.328 0-0.453 0.070t-0.078 0.18 0.141 0.219 0.203 0.187l0.109 0.078q0.344 0.156 0.68 0.594t0.492 0.797l0.156 0.359q0.203 0.594 0.688 0.961t1.047 0.469 1.086 0.109 0.867-0.055l0.359-0.063q0 0.594 0.008 1.383t0.008 0.852q0 0.281-0.203 0.469t-0.625 0.109q-3.625-1.203-5.914-4.336t-2.289-7.055q0-3.266 1.609-6.023t4.367-4.367 6.023-1.609zM4.547 19.234q0.047-0.109-0.109-0.187-0.156-0.047-0.203 0.031-0.047 0.109 0.109 0.187 0.141 0.094 0.203-0.031zM5.031 19.766q0.109-0.078-0.031-0.25-0.156-0.141-0.25-0.047-0.109 0.078 0.031 0.25 0.156 0.156 0.25 0.047zM5.5 20.469q0.141-0.109 0-0.297-0.125-0.203-0.266-0.094-0.141 0.078 0 0.281t0.266 0.109zM6.156 21.125q0.125-0.125-0.063-0.297-0.187-0.187-0.313-0.047-0.141 0.125 0.063 0.297 0.187 0.187 0.313 0.047zM7.047 21.516q0.047-0.172-0.203-0.25-0.234-0.063-0.297 0.109t0.203 0.234q0.234 0.094 0.297-0.094zM8.031 21.594q0-0.203-0.266-0.172-0.25 0-0.25 0.172 0 0.203 0.266 0.172 0.25 0 0.25-0.172zM8.937 21.438q-0.031-0.172-0.281-0.141-0.25 0.047-0.219 0.234t0.281 0.125 0.219-0.219z"></path></svg></a></li><li><a target="_blank" class="" rel="me" title="LinkedIn" href="https://linkedin.com/company/explosion-ai/"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 28" fill="currentColor" class="icon_root__gN1Pq" style="min-width:16px"><path d="M5.453 9.766v15.484h-5.156v-15.484h5.156zM5.781 4.984q0.016 1.141-0.789 1.906t-2.117 0.766h-0.031q-1.281 0-2.063-0.766t-0.781-1.906q0-1.156 0.805-1.914t2.102-0.758 2.078 0.758 0.797 1.914zM24 16.375v8.875h-5.141v-8.281q0-1.641-0.633-2.57t-1.977-0.93q-0.984 0-1.648 0.539t-0.992 1.336q-0.172 0.469-0.172 1.266v8.641h-5.141q0.031-6.234 0.031-10.109t-0.016-4.625l-0.016-0.75h5.141v2.25h-0.031q0.313-0.5 0.641-0.875t0.883-0.812 1.359-0.68 1.789-0.242q2.672 0 4.297 1.773t1.625 5.195z"></path></svg></a></li><li><a target="_blank" class="" rel="me" title="Twitter" href="https://twitter.com/explosion_ai"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 26 28" fill="currentColor" class="icon_root__gN1Pq" style="min-width:16px"><path d="M25.312 6.375q-1.047 1.531-2.531 2.609 0.016 0.219 0.016 0.656 0 2.031-0.594 4.055t-1.805 3.883-2.883 3.289-4.031 2.281-5.047 0.852q-4.234 0-7.75-2.266 0.547 0.063 1.219 0.063 3.516 0 6.266-2.156-1.641-0.031-2.938-1.008t-1.781-2.492q0.516 0.078 0.953 0.078 0.672 0 1.328-0.172-1.75-0.359-2.898-1.742t-1.148-3.211v-0.063q1.062 0.594 2.281 0.641-1.031-0.688-1.641-1.797t-0.609-2.406q0-1.375 0.688-2.547 1.891 2.328 4.602 3.727t5.805 1.555q-0.125-0.594-0.125-1.156 0-2.094 1.477-3.57t3.57-1.477q2.188 0 3.687 1.594 1.703-0.328 3.203-1.219-0.578 1.797-2.219 2.781 1.453-0.156 2.906-0.781z"></path></svg></a></li><li><a target="_blank" class="" rel="me" title="Mastodon" href="https://sigmoid.social/@explosion"><svg fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="16" height="16" class="icon_root__gN1Pq" style="min-width:16px"><path d="M 15.9375 4.03125 C 12.917 4.0435 9.9179219 4.4269844 8.3574219 5.1464844 C 8.3574219 5.1464844 5 6.6748594 5 11.880859 C 5 18.077859 4.9955 25.860234 10.5625 27.365234 C 12.6945 27.938234 14.527953 28.061562 16.001953 27.976562 C 18.676953 27.825562 20 27.005859 20 27.005859 L 19.910156 25.029297 C 19.910156 25.029297 18.176297 25.640313 16.029297 25.570312 C 13.902297 25.495313 11.6615 25.335688 11.3125 22.679688 C 11.2805 22.432688 11.264625 22.182594 11.265625 21.933594 C 15.772625 23.052594 19.615828 22.420969 20.673828 22.292969 C 23.627828 21.933969 26.199344 20.081672 26.527344 18.388672 C 27.041344 15.720672 26.998047 11.880859 26.998047 11.880859 C 26.998047 6.6748594 23.646484 5.1464844 23.646484 5.1464844 C 22.000984 4.3779844 18.958 4.019 15.9375 4.03125 z M 12.705078 8.0019531 C 13.739953 8.0297031 14.762578 8.4927031 15.392578 9.4707031 L 16.001953 10.505859 L 16.609375 9.4707031 C 17.874375 7.5037031 20.709594 7.6264375 22.058594 9.1484375 C 23.302594 10.596438 23.025391 11.531 23.025391 18 L 23.025391 18.001953 L 20.578125 18.001953 L 20.578125 12.373047 C 20.578125 9.7380469 17.21875 9.6362812 17.21875 12.738281 L 17.21875 16 L 14.787109 16 L 14.787109 12.738281 C 14.787109 9.6362812 11.429688 9.7360938 11.429688 12.371094 L 11.429688 18 L 8.9765625 18 C 8.9765625 11.526 8.7043594 10.585438 9.9433594 9.1484375 C 10.622859 8.3824375 11.670203 7.9742031 12.705078 8.0019531 z"></path></svg></a></li><li><a target="_blank" class="" rel="me" title="Bluesky" href="https://bsky.app/profile/explosion-ai.bsky.social"><svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" width="16" height="16" viewBox="0 0 39 39" class="icon_root__gN1Pq" style="min-width:16px"><path d="M19.5 17.73c-1.6-3.1-5.94-8.89-9.98-11.74-3.87-2.73-5.35-2.26-6.31-1.82-1.12.51-1.32 2.23-1.32 3.24 0 1.01.55 8.3.92 9.51 1.2 4.02 5.45 5.38 9.37 4.94.2-.03.4-.06.61-.08-.2.03-.41.06-.61.08-5.74.85-10.85 2.94-4.15 10.39 7.36 7.62 10.09-1.63 11.49-6.33 1.4 4.69 3.01 13.61 11.35 6.33 6.27-6.33 1.72-9.54-4.02-10.39-.2-.02-.41-.05-.61-.08.21.03.41.05.61.08 3.92.44 8.18-.92 9.37-4.94.36-1.22.92-8.5.92-9.51 0-1.01-.2-2.73-1.32-3.24-.97-.44-2.44-.91-6.31 1.82-4.07 2.86-8.41 8.64-10.01 11.74Z"></path></svg></a></li><li><a target="_blank" class="" rel="me" title="Threads" href="https://www.threads.net/@explosion.ai"><svg width="16" height="16" viewBox="0 0 192 192" xmlns="http://www.w3.org/2000/svg" class="icon_root__gN1Pq" style="min-width:16px"><path d="M141.537 88.9883C140.71 88.5919 139.87 88.2104 139.019 87.8451C137.537 60.5382 122.616 44.905 97.5619 44.745C97.4484 44.7443 97.3355 44.7443 97.222 44.7443C82.2364 44.7443 69.7731 51.1409 62.102 62.7807L75.881 72.2328C81.6116 63.5383 90.6052 61.6848 97.2286 61.6848C97.3051 61.6848 97.3819 61.6848 97.4576 61.6855C105.707 61.7381 111.932 64.1366 115.961 68.814C118.893 72.2193 120.854 76.925 121.825 82.8638C114.511 81.6207 106.601 81.2385 98.145 81.7233C74.3247 83.0954 59.0111 96.9879 60.0396 116.292C60.5615 126.084 65.4397 134.508 73.775 140.011C80.8224 144.663 89.899 146.938 99.3323 146.423C111.79 145.74 121.563 140.987 128.381 132.296C133.559 125.696 136.834 117.143 138.28 106.366C144.217 109.949 148.617 114.664 151.047 120.332C155.179 129.967 155.42 145.8 142.501 158.708C131.182 170.016 117.576 174.908 97.0135 175.059C74.2042 174.89 56.9538 167.575 45.7381 153.317C35.2355 139.966 29.8077 120.682 29.6052 96C29.8077 71.3178 35.2355 52.0336 45.7381 38.6827C56.9538 24.4249 74.2039 17.11 97.0132 16.9405C119.988 17.1113 137.539 24.4614 149.184 38.788C154.894 45.8136 159.199 54.6488 162.037 64.9503L178.184 60.6422C174.744 47.9622 169.331 37.0357 161.965 27.974C147.036 9.60668 125.202 0.195148 97.0695 0H96.9569C68.8816 0.19447 47.2921 9.6418 32.7883 28.0793C19.8819 44.4864 13.2244 67.3157 13.0007 95.9325L13 96L13.0007 96.0675C13.2244 124.684 19.8819 147.514 32.7883 163.921C47.2921 182.358 68.8816 191.806 96.9569 192H97.0695C122.03 191.827 139.624 185.292 154.118 170.811C173.081 151.866 172.51 128.119 166.26 113.541C161.776 103.087 153.227 94.5962 141.537 88.9883ZM98.4405 129.507C88.0005 130.095 77.1544 125.409 76.6196 115.372C76.2232 107.93 81.9158 99.626 99.0812 98.6368C101.047 98.5234 102.976 98.468 104.871 98.468C111.106 98.468 116.939 99.0737 122.242 100.233C120.264 124.935 108.662 128.946 98.4405 129.507Z"></path></svg></a></li><li><a target="_blank" class="" rel="me" title="YouTube" href="https://youtube.com/c/ExplosionAI"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 20 20" fill="currentColor" class="icon_root__gN1Pq" style="min-width:16px"><path d="M10 2.3c-9.828 0-10 0.874-10 7.7s0.172 7.7 10 7.7 10-0.874 10-7.7-0.172-7.7-10-7.7zM13.205 10.334l-4.49 2.096c-0.393 0.182-0.715-0.022-0.715-0.456v-3.948c0-0.433 0.322-0.638 0.715-0.456l4.49 2.096c0.393 0.184 0.393 0.484 0 0.668z"></path></svg></a></li></ul><ul class="layout_footer-meta__2SgeV"><li><a target="_blank" class="" href="https://status.explosion.ai">Status</a></li><li><a class="" href="/terms">Terms &amp; Conditions</a></li><li><a target="_blank" class="" href="https://explosion.ai/legal">Legal &amp; Imprint</a></li><li><span style="font-family:sans-serif">©</span> 2017-<!-- -->2024<!-- --> <a target="_blank" class="" href="https://explosion.ai">Explosion</a></li></ul></div></footer></div></div></main></div><script id="__NEXT_DATA__" type="application/json" crossorigin="">{"props":{"pageProps":{"data":{"id":"dependencies-relations","content":"\nThe \u003cUI\u003erelations\u003c/UI\u003e interface can be used for a wide range of classic natural\nlanguage processing tasks, such as syntactic and semantic dependency parsing,\ncoreference resolution, or discourse analysis. Relations can be directed or\nundirected, labelled or unlabelled, and anchored either by single words or\nphrases. Phrases can be recognised either as a preprocess, or jointly during the\nrelations annotation.\n\n## Quickstart {id=\"quickstart\"}\n\n\u003cAccordion title=\"I want to improve an existing spaCy dependency parsing model.\"\u003e\n\nThe \u003cR\u003edep.correct\u003c/R\u003e recipe lets you stream in the model's predictions and\ncorrect them if needed. You can either annotate all available dependency labels,\nor focus on a subset of them that you care most about for your specific\napplication. spaCy can be updated with complete parses, as well as incomplete\nannotations.\n\nOnce you've create a dataset, you can use the \u003cR\u003etrain\u003c/R\u003e recipe to update the\nexisting model with the annotations. You can also use the \u003cR\u003edata-to-spacy\u003c/R\u003e\ncommand to convert your annotations to JSON-formatted training data to use with\n`spacy train`.\n\n\u003c/Accordion\u003e\n\n\u003cAccordion title=\"I want to plug in and correct a non-spaCy dependency parser.\"\u003e\n\nProdigy represents dependency annotations in a\n[simple JSON format](/docs/api-interfaces#relations) with a `\"text\"`, a\n`\"relations\"` property describing the head and child indices and label of each\ndependency relation, and a list of `\"tokens\"`. So you could extract the\nsuggestions from your model in this format, and then use the \u003cR\u003emark\u003c/R\u003e recipe\nwith `--view-id relations` to label the data exactly as it comes in.\n\nYou can also write a [custom recipe](/docs/custom-recipes) with a custom stream\n(a regular Python generator!) to plug in your model. If you can load and run\nyour model in Python, you can use it with Prodigy. See\n[the section on custom models](#custom-model) for an example. If you want to use\nactive learning with a custom model, you can make your recipe return an `update`\ncallback that's called whenever a new batch of answers is sent back from the web\napp. However, there are a few more considerations here, like how sensitive your\nmodel is to small updates.\n\n\u003c/Accordion\u003e\n\n\u003cAccordion title=\"I want to annotate entities and relations between them.\"\u003e\n\nThe \u003cR\u003erel.manual\u003c/R\u003e recipe lets you switch between two annotation modes: one\nfor labeling/correcting entity spans, and one for defining relations between\nthese spans and/or other tokens. You can also load in data that has been\npre-annotated with entity spans in Prodigy's format and annotate relations\nbetween them, or use a pretrained model to suggest entities for you. For\ndetails, see the section on [annotating named entity relations](#ner).\n\n\u003c/Accordion\u003e\n\n\u003cAccordion title=\"I want to create training data for coreference resolution.\"\u003e\n\nThe \u003cR\u003ecoref.manual\u003c/R\u003e recipe incorporates default settings for coreference\nannotation, such as using the relation label `COREF` and disabling all tokens\nthat are not nouns, proper nouns or pronouns, and pre-highlighting named\nentities. You can customize the labels it uses to match your language and model.\nFor details, see the section on [annotation coreference relations](#coref).\n\n\u003c/Accordion\u003e\n\n\u003cAccordion title=\"I want to annotate other relations for a custom domain, e.g. biomedical text.\"\u003e\n\nProdigy's \u003cR\u003erel.manual\u003c/R\u003e recipe allows building very powerful custom\nworkflows for semi-automated dependency and relation annotation, mixing manual\nspan labelling and dependency attachment. You can also provide match patterns to\npre-select and merge spans, or to disable tokens that you know are not going to\nbe part of a relation you're looking for.\n\nThe [example in this usage guide](#example-bio) focuses on annotating biomedical\nevents from literature, a complex task with multiple annotation objectives using\nthe\n[BioNLP 2011 GENIA Shared Task](http://2011.bionlp-st.org/home/genia-event-extraction-genia)\nannotation scheme. A similar strategy can be applied to a variety of custom\ndomain use cases.\n\n\u003c/Accordion\u003e\n\n\u003cAccordion title=\"I have relations annotations. I want to train a relations model.\"\u003e\n\nUnlike other text recipes, Prodigy's `prodigy train` and `data-to-spacy` recipes\ndon't support `\"relations\"` annotations. Both recipes depend on spaCy, and spaCy\ncurrently does not support relation extraction.\n\nHowever, we've created a [tutorial video](https://www.youtube.com/watch?v=8HL-Ap5_Axo)\nand [project repository](https://github.com/explosion/projects/tree/v3/tutorials/rel_component)\nthat shows how you can create a custom trainable component with `spacy train`. To\nadopt to your project, you'll want to clone the repo, update your annotations, and\nmodify the `parse_data.py` script to export your annotations to `.spacy`. For more details,\nthere are several related [posts]([[SUPPORT_URL]]/t/5852/4)\non [Prodigy Support]([[SUPPORT_URL]]). You may also find posts on\n[spaCy's GitHub discussions](https://github.com/explosion/spaCy/discussions) if you\nneed help with `spacy train`.\n\n\u003c/Accordion\u003e\n\n## Choosing the right recipe and workflow {id=\"workflow\"}\n\nSo you have a problem that requires data annotated with relationships between\nwords and expressions and you want to get it done as efficiently as possible.\nBut how do you pick the right workflow for your use case?\n\n1. **Fully manual:** This is the classic approach. You're shown all tokens in\n   the text and you annotate labelled relations between them by clicking on\n   them. The biggest challenge here is to prevent the process from getting too\n   messy and tedious (and as a result, slower and more error-prone). Unless your\n   goal is to create a new dependency treebank from scratch, you typically want\n   to use at least _some_ automation to merge phrases, disable irrelevant tokens\n   or pre-label some of the data for you. In Prodigy, you can use the\n   \u003cR\u003erel.manual\u003c/R\u003e recipe for manual relation annotation, or the more\n   task-specific \u003cR\u003ecoref.manual\u003c/R\u003e with pre-defined configurations for\n   coreference annotation.\n\n2. **Manual with suggestions from model:** If you already have a model that\n   predicts _something_, you can use it to pre-label the data for you, and only\n   correct its mistakes. This is especially useful for dependency parsing, where\n   the data creation from scratch would otherwise be very tedious. Prodigy's\n   \u003cR\u003edep.correct\u003c/R\u003e workflow lets you stream in syntactic dependencies\n   predicted by the model and correct them manually to create gold-standard\n   data. You can also use a model with \u003cR\u003erel.manual\u003c/R\u003e to add named entities\n   and noun phrases.\n\n## Dependency Parsing {id=\"dependency-parsing\"}\n\nIf you already have a pretrained [spaCy pipeline](/docs/install#spacy-models)\nwith a parser and you want to improve it on your own data, you can use the\nbuilt-in \u003cR\u003edep.correct\u003c/R\u003e recipe. You don't have to annotate all labels at the\nsame time – it can also be useful to focus on a smaller subset of labels that\nare most relevant for your application. The following command will start the web\nserver, stream in headlines from `news_headlines.jsonl` and provide the label\noptions `ROOT` (root of the sentence), `csubj` (clausal subject), `nsubj`\n(nominal subject), `dobj` (direct object) and `pboj` (prepositional object).\nThose labels will vary depending on the label scheme the model was trained with.\n\n\u003cButton icon=\"download\" href=\"https://raw.githubusercontent.com/explosion/prodigy-recipes/master/example-datasets/news_headlines.jsonl\"\u003eDownload news_headlines.jsonl\u003c/Button\u003e\n\n\u003cTerminal title=\"Recipe command\" copy\u003e\n\u003cC\u003eprodigy\u003c/C\u003e\n\u003cC name=\"recipe\"\u003edep.correct\u003c/C\u003e\n\u003cC name=\"dataset\"\u003edeps_news\u003c/C\u003e\n\u003cC name=\"spacy_model\"\u003een_core_web_sm\u003c/C\u003e\n\u003cC name=\"source\"\u003e./news_headlines.jsonl\u003c/C\u003e\n\u003cC name=\"label\"\u003e--label ROOT,csubj,nsubj,dobj,pboj\u003c/C\u003e\n\u003cC name=\"update\"\u003e--update\u003c/C\u003e\n\u003c/Terminal\u003e\n\n\u003cProdigyCard view=\"relations\" content={{text:'Apple Commits $2.5 Billion to Ease California Housing Crunch',meta:{source:'The New York Times'},tokens:[{text:'Apple',start:0,end:5,id:0,ws:true},{text:'Commits',start:6,end:13,id:1,ws:true},{text:'$',start:14,end:15,id:2,ws:false},{text:'2.5',start:15,end:18,id:3,ws:true},{text:'Billion',start:19,end:26,id:4,ws:true},{text:'to',start:27,end:29,id:5,ws:true},{text:'Ease',start:30,end:34,id:6,ws:true},{text:'California',start:35,end:45,id:7,ws:true},{text:'Housing',start:46,end:53,id:8,ws:true},{text:'Crunch',start:54,end:60,id:9,ws:false} ],relations:[{child:0,head:1,label:'nsubj'},{child:1,head:1,label:'ROOT'},{child:4,head:1,label:'dobj'},{child:9,head:6,label:'dobj'} ]}} config={{labels: ['ROOT','csubj','nsubj','dobj','pboj']}} /\u003e\n\nIn the annotation UI, you can now review the dependency parse and click on\nincorrectly predicted arcs to remove them, or add new dependencies by selecting\nthe head token and then the child token to attach it to. The `ROOT` label is the\nonly one that should be **attached to itself**. You can achieve this in the UI\nby **double-clicking** or **double-tapping** the token.\n\nWhen you're done with annotating, you can use the \u003cR\u003etrain\u003c/R\u003e recipe with the\ncomponent `parser` to train a dependency parser, or use the \u003cR\u003edata-to-spacy\u003c/R\u003e\ncommand to export JSON-formatted training data. You can also use \u003cR\u003edb-out\u003c/R\u003e\nto export data in [Prodigy's JSON format](/docs/api-interfaces#relations) and\nuse it in a different process.\n\n\u003cTerminal title=\"Training command\" copy\u003e\n\u003cC\u003eprodigy\u003c/C\u003e\n\u003cC name=\"recipe\"\u003etrain\u003c/C\u003e\n\u003cC name=\"output_dir\"\u003e./model\u003c/C\u003e\n\u003cC name=\"parser\"\u003e--parser dep_news\u003c/C\u003e\n\u003c/Terminal\u003e\n\n## Combining Named Entity Recognition with relation extraction {id=\"ner\"}\n\n\u003cInfobox variant=\"warning\"\u003e\n\nNote that in order to train a model to predict relations between spans, you have\nto bring **your own model implementation** and implement your own training.\n\n\u003c/Infobox\u003e\n\nYou might already know Prodigy's features for annotating training data for\n[named entity recognition](/docs/named-entity-recognition). Using a workflow\nlike \u003cR\u003ener.manual\u003c/R\u003e, you can stream in your data and highlight entity spans\nfor a given set of labels. For example, here we're labelling `PERSON` and `GPE`\n(geopolitical entity):\n\n\u003cTerminal title=\"Recipe command\" copy\u003e\n\u003cC\u003eprodigy\u003c/C\u003e\n\u003cC name=\"recipe\"\u003ener.manual\u003c/C\u003e\n\u003cC name=\"dataset\"\u003ener_rels_ent\u003c/C\u003e\n\u003cC name=\"spacy_model\"\u003eblank:en\u003c/C\u003e\n\u003cC name=\"source\"\u003e./data.jsonl\u003c/C\u003e\n\u003cC name=\"label\"\u003e--label PERSON,GPE\u003c/C\u003e\n\u003c/Terminal\u003e\n\n\u003cProdigyCard view=\"ner_manual\" content={{text:'Obama was born in Hawaii and studied in New York','tokens':[{text:'Obama',start:0,end:5,id:0,ws:true},{text:'was',start:6,end:9,id:1,ws:true},{text:'born',start:10,end:14,id:2,ws:true},{text:'in',start:15,end:17,id:3,ws:true},{text:'Hawaii',start:18,end:24,id:4,ws:true},{text:'and',start:25,end:28,id:5,ws:true},{text:'studied',start:29,end:36,id:6,ws:true},{text:'in',start:37,end:39,id:7,ws:true},{text:'New',start:40,end:43,id:8,ws:true},{text:'York',start:44,end:48,id:9,ws:false}],spans:[{start:0,end:5,token_start:0,token_end:0,label:'PERSON'},{start:18,end:24,token_start:4,token_end:4,label:'GPE'},{start:40,end:48,token_start:8,token_end:9,label:'GPE'}]}} config={{labels:['PERSON','GPE']}} /\u003e\n\nWhile spans can capture a lot of important information – like the concepts that\nare mentioned in the text – they can't always capture **relationships between\nthem**. This requires another layer of data that defines two words or phrases,\ntypically a \"head\" and a \"child\", and a label specifying the type of\nrelationship. The \u003cR\u003erel.manual\u003c/R\u003e recipe allows you to stream in data that's\nalready pre-annotated with named entities. In this case, we're setting\n`dataset:ner_rels_ent`, which will load the previously annotated data from the\ndataset `ner_rels_ent`. Entities annotated in this dataset will be shown as a\nmerged unit, and we can assign relations between them and other tokens.\n\n\u003cTerminal title=\"Recipe command\" copy\u003e\n\u003cC\u003eprodigy\u003c/C\u003e\n\u003cC name=\"recipe\"\u003erel.manual\u003c/C\u003e\n\u003cC name=\"dataset\"\u003ener_rels_dep\u003c/C\u003e\n\u003cC name=\"spacy_model\"\u003eblank:en\u003c/C\u003e\n\u003cC name=\"source\"\u003edataset:ner_rels_ent\u003c/C\u003e\n\u003cC name=\"label\"\u003e--label SUBJECT,LOCATION\u003c/C\u003e\n\u003cC name=\"wrap\"\u003e--wrap\u003c/C\u003e\n\u003c/Terminal\u003e\n\n\u003cProdigyCard view=\"relations\" content={{text:'Obama was born in Hawaii and studied in New York','tokens':[{text:'Obama',start:0,end:5,id:0,ws:true},{text:'was',start:6,end:9,id:1,ws:true},{text:'born',start:10,end:14,id:2,ws:true},{text:'in',start:15,end:17,id:3,ws:true},{text:'Hawaii',start:18,end:24,id:4,ws:true},{text:'and',start:25,end:28,id:5,ws:true},{text:'studied',start:29,end:36,id:6,ws:true},{text:'in',start:37,end:39,id:7,ws:true},{text:'New',start:40,end:43,id:8,ws:true},{text:'York',start:44,end:48,id:9,ws:false}],spans:[{start:0,end:5,token_start:0,token_end:0,label:'PERSON'},{start:18,end:24,token_start:4,token_end:4,label:'GPE'},{start:40,end:48,token_start:8,token_end:9,label:'GPE'}],relations:[{head:0,child:2,head_span:{start:0,end:5,token_start:0,token_end:0,label:'ORG'},child_span:{start:10,end:14,token_start:2,token_end:2,label:null},label:'SUBJECT'},{head:0,child:6,head_span:{start:0,end:5,token_start:0,token_end:0,label:'ORG'},child_span:{start:29,end:36,token_start:6,token_end:6,label:null},label:'SUBJECT'},{head:2,child:4,head_span:{start:10,end:14,token_start:2,token_end:2,label:null},child_span:{start:18,end:24,token_start:4,token_end:4,label:'GPE'},label:'LOCATION'},{head:6,child:9,head_span:{start:29,end:36,token_start:6,token_end:6,label:null},child_span:{start:40,end:48,token_start:8,token_end:9,label:'GPE'},label:'LOCATION'}]}} config={{labels:['SUBJECT','LOCATION'],wrap_relations: true}} /\u003e\n\nInstead of loading in a pre-annotated dataset, you can also use an existing\npretrained model to add entities for you. Here we're using the `en_core_web_sm`\nmodel and the original raw input data, and set the `--add-ents` flag to include\nentities found in the text. For more options and how to add custom\npreprocessing, see the section on [custom relations](#custom).\n\n\u003cTerminal title=\"Recipe command\" copy\u003e\n\u003cC\u003eprodigy\u003c/C\u003e\n\u003cC name=\"recipe\"\u003erel.manual\u003c/C\u003e\n\u003cC name=\"dataset\"\u003ener_rels_dep\u003c/C\u003e\n\u003cC name=\"spacy_model\"\u003een_core_web_sm\u003c/C\u003e\n\u003cC name=\"source\"\u003e./data.jsonl\u003c/C\u003e\n\u003cC name=\"label\"\u003e--label SUBJECT,LOCATION\u003c/C\u003e\n\u003cC name=\"add_ents\"\u003e--add-ents\u003c/C\u003e\n\u003cC name=\"wrap\"\u003e--wrap\u003c/C\u003e\n\u003c/Terminal\u003e\n\n### Joint entity and relation annotation {id=\"ner-joint\"}\n\nFor some use cases, it makes sense to do entity and relation annotation **at the\nsame time**. That's especially true if the annotation decision for both spans\nand relations requires the same thought process, or if it's difficult to\nseparate both tasks. In that case, you can pass an additional `--span-label`\nargument to \u003cR\u003erel.manual\u003c/R\u003e defining the entity labels to assign. The\ninterface now has two modes: the relation annotation mode\n\u003cIcon name=\"prodigy-rels\" /\u003e to connect tokens and spans, and the span\nannotation mode \u003cIcon name=\"prodigy-spans\" /\u003e to manually highlight and\nedit spans. To add a span, click and drag across the tokens, or hold down\n\u003cKbd\u003eshift\u003c/Kbd\u003e and click on the start and end token.\n\n\u003cTerminal title=\"Recipe command\" copy\u003e\n\u003cC\u003eprodigy\u003c/C\u003e\n\u003cC name=\"recipe\"\u003erel.manual\u003c/C\u003e\n\u003cC name=\"dataset\"\u003ener_rels\u003c/C\u003e\n\u003cC name=\"spacy_model\"\u003eblank:en\u003c/C\u003e\n\u003cC name=\"source\"\u003e./data.jsonl\u003c/C\u003e\n\u003cC name=\"label\"\u003e--label SUBJECT,LOCATION\u003c/C\u003e\n\u003cC name=\"span_label\"\u003e--span-label PERSON,GPE\u003c/C\u003e\n\u003c/Terminal\u003e\n\n\u003cProdigyCard view=\"relations\" content={{text:'Obama was born in Hawaii and studied in New York','tokens':[{text:'Obama',start:0,end:5,id:0,ws:true},{text:'was',start:6,end:9,id:1,ws:true},{text:'born',start:10,end:14,id:2,ws:true},{text:'in',start:15,end:17,id:3,ws:true},{text:'Hawaii',start:18,end:24,id:4,ws:true},{text:'and',start:25,end:28,id:5,ws:true},{text:'studied',start:29,end:36,id:6,ws:true},{text:'in',start:37,end:39,id:7,ws:true},{text:'New',start:40,end:43,id:8,ws:true},{text:'York',start:44,end:48,id:9,ws:false}]}} config={{labels:['SUBJECT','LOCATION'],relations_span_labels:['PERSON','GPE'],wrap_relations: false}} /\u003e\n\n1. Choose the **span highlighting mode** by clicking the\n   \u003cIcon name=\"prodigy-spans\" /\u003e button. This will let you manually\n   highlight spans or remove existing spans.\n\n2. Drag across the token \"Obama\" or click on it to **assign it the label**\n   `PERSON`. Then select the label `GPE` (geopolitical entity) at the top and do\n   the same for \"Hawaii\" and \"New York\". To select multiple tokens, drag across\n   them and they will turn green, indicating the selection is valid. If you make\n   a mistake, click on the span and then on the\n   \u003cIcon name=\"prodigy-delete\" /\u003e button to remove it.\n\n3. Choose the **relations mode** by clicking the\n   \u003cIcon name=\"prodigy-rels\" /\u003e button. This will let you select tokens\n   or spans and assign relations to them.\n\n4. Click \"Obama\" and then \"born\" to **assign it the relation** `SUBJECT` and do\n   the same for \"Obama\" and \"studied\". Then select the label `LOCATION` at the\n   top and connect \"born\" and \"Hawaii\" and then \"studied\" and \"New York\".\n\n\u003cVideo src=\"/docs/annotation_relations.mp4\" width={800} height={340} /\u003e\n\nIf you have a pretrained model that already predicts _something_, you can also\nset the `--add-ents` flag to pre-highlight entities suggested by the model for\nyou. You can then delete incorrect spans or change their label and add missing\nspans if needed.\n\n\u003cTerminal title=\"Recipe command\" copy\u003e\n\u003cC\u003eprodigy\u003c/C\u003e\n\u003cC name=\"recipe\"\u003erel.manual\u003c/C\u003e\n\u003cC name=\"dataset\"\u003ener_rels\u003c/C\u003e\n\u003cC name=\"spacy_model\"\u003eblank:en\u003c/C\u003e\n\u003cC name=\"source\"\u003e./data.jsonl\u003c/C\u003e\n\u003cC name=\"label\"\u003e--label SUBJECT,LOCATION\u003c/C\u003e\n\u003cC name=\"span_label\"\u003e--span-label PERSON,GPE\u003c/C\u003e\n\u003cC name=\"wrap\"\u003e--wrap\u003c/C\u003e\n\u003cC name=\"add_ents\"\u003e--add-ents\u003c/C\u003e\n\u003c/Terminal\u003e\n\n\u003cInfobox title=\"When to annotate jointly vs. separately\" variant=\"warning\"\u003e\n\nWhile it's tempting to have everything annotated in one step, it can make the\ndata collection process more consistent to split the annotation for different\naspects into their own separate steps. If you're annotating relations between\nspans, the span boundaries can matter _a lot_ and inconsistencies can lead to\nlower data quality for _both_ tasks. It can therefore help to **annotate and\nreview entities first** and only add relations once you know that the data is\ncorrect and consistent.\n\nIf spans and relations don't _have to_ be annotated at the same time, it can\nalso make it easier for the annotators to **focus on one objective at a time**.\nThis reduces the steps per completed annotation and the cognitive load, which\ncan also help prevent careless mistakes.\n\n\u003c/Infobox\u003e\n\n## Coreference Resolution {id=\"coref\"}\n\n\u003cInfobox variant=\"warning\"\u003e\n\nNote that a coreference model is not yet a part of spaCy core. While you can\ncreate coref annotations using Prodigy by itself, to export them with the\n`data-to-spacy` command you'll need to install\n[spacy-experimental](https://github.com/explosion/spacy-experimental/) version\n0.6.1 or higher.\n\n\u003c/Infobox\u003e\n\nCoreference resolution is the challenge of linking ambiguous mentions such as\n\"her\" or \"that woman\" back to an antecedent providing more context about the\nentity in question. You can use the built-in \u003cR\u003ecoref.manual\u003c/R\u003e recipe to\nmanually create such links. This recipe allows you to **focus on nouns, proper\nnouns and pronouns specifically**, by disabling all other tokens. The following\ncommand will start the web server, stream in movie summaries from\n`plot_summaries.jsonl` and provide the label `COREF` to annotate coreference\nrelations.\n\n\u003cButton icon=\"download\" href=\"https://raw.githubusercontent.com/explosion/prodigy-recipes/master/example-datasets/plot_summaries.jsonl\"\u003eDownload plot_summaries.jsonl\u003c/Button\u003e\n\n\u003cTerminal title=\"Recipe command\" copy\u003e\n\u003cC\u003eprodigy\u003c/C\u003e\n\u003cC name=\"recipe\"\u003ecoref.manual\u003c/C\u003e\n\u003cC name=\"dataset\"\u003ecoref_movies\u003c/C\u003e\n\u003cC name=\"spacy_model\"\u003een_core_web_sm\u003c/C\u003e\n\u003cC name=\"source\"\u003e./plot_summaries.jsonl\u003c/C\u003e\n\u003cC name=\"label\"\u003e--label COREF\u003c/C\u003e\n\u003c/Terminal\u003e\n\n\u003cProdigyCard view=\"relations\" content={{text:'Lindy returns to the tent to check on her daughter Azaria and is certain she sees a dingo with something in its mouth running off as she approaches. When she discovers the infant is missing, everyone joins forces to search for her, without success.','tokens':[{text:'Lindy',start:0,end:5,id:0},{text:'returns',start:6,end:13,id:1,disabled:true},{text:'to',start:14,end:16,id:2,disabled:true},{text:'the',start:17,end:20,id:3},{text:'tent',start:21,end:25,id:4},{text:'to',start:26,end:28,id:5,disabled:true},{text:'check',start:29,end:34,id:6,disabled:true},{text:'on',start:35,end:37,id:7,disabled:true},{text:'her',start:38,end:41,id:8},{text:'daughter',start:42,end:50,id:9},{text:'Azaria',start:51,end:57,id:10},{text:'and',start:58,end:61,id:11,disabled:true},{text:'is',start:62,end:64,id:12,disabled:true},{text:'certain',start:65,end:72,id:13,disabled:true},{text:'she',start:73,end:76,id:14},{text:'sees',start:77,end:81,id:15,disabled:true},{text:'a',start:82,end:83,id:16},{text:'dingo',start:84,end:89,id:17},{text:'with',start:90,end:94,id:18,disabled:true},{text:'something',start:95,end:104,id:19},{text:'in',start:105,end:107,id:20,disabled:true},{text:'its',start:108,end:111,id:21},{text:'mouth',start:112,end:117,id:22},{text:'running',start:118,end:125,id:23,disabled:true},{text:'off',start:126,end:129,id:24,disabled:true},{text:'as',start:130,end:132,id:25,disabled:true},{text:'she',start:133,end:136,id:26},{text:'approaches',start:137,end:147,id:27,ws:false,disabled:true},{text:'.',start:147,end:148,id:28,disabled:true},{text:'When',start:149,end:153,id:29,disabled:true},{text:'she',start:154,end:157,id:30},{text:'discovers',start:158,end:167,id:31,disabled:true},{text:'the',start:168,end:171,id:32},{text:'infant',start:172,end:178,id:33},{text:'is',start:179,end:181,id:34,disabled:true},{text:'missing',start:182,end:189,id:35,ws:false,disabled:true},{text:',',start:189,end:190,id:36,disabled:true},{text:'everyone',start:191,end:199,id:37},{text:'joins',start:200,end:205,id:38,disabled:true},{text:'forces',start:206,end:212,id:39},{text:'to',start:213,end:215,id:40,disabled:true},{text:'search',start:216,end:222,id:41,disabled:true},{text:'for',start:223,end:226,id:42,disabled:true},{text:'her',start:227,end:230,id:43,ws:false},{text:',',start:230,end:231,id:44,disabled:true},{text:'without',start:232,end:239,id:45,disabled:true},{text:'success',start:240,end:247,id:46,ws:false},{text:'.',start:247,end:248,id:47,ws:false,disabled:true}],spans:[{text:'Lindy',start:0,token_start:0,token_end:0,end:5,type:'ent',label:'PERSON'},{text:'the tent',start:17,token_start:3,token_end:4,end:25,type:'pattern',label:'NP'},{text:'daughter',start:42,token_start:9,token_end:9,end:50,type:'pattern',label:'NP'},{text:'Azaria',start:51,token_start:10,token_end:10,end:57,type:'ent',label:'PERSON'},{text:'a dingo',start:82,token_start:16,token_end:17,end:89,type:'pattern',label:'NP'},{text:'mouth',start:112,token_start:22,token_end:22,end:117,type:'pattern',label:'NP'},{text:'the infant',start:168,token_start:32,token_end:33,end:178,type:'pattern',label:'NP'},{text:'forces',start:206,token_start:39,token_end:39,end:212,type:'pattern',label:'NP'},{text:'success',start:240,token_start:46,token_end:46,end:247,type:'pattern',label:'NP'}],relations:[{head:8,child:0,label:'COREF'},{head:14,child:0,label:'COREF'}]}} config={{labels: ['COREF'],wrap_relations:true,hide_relations_arrow:true}} /\u003e\n\nThe recipe will use the model to automatically detect potential candidates for a\ncoreference relationship. You can customize the labels used for the extraction\nvia the [recipe arguments](/docs/recipes#coref-manual) to match the model you're\nusing. You can also set up your very own custom relation annotation workflow by\ndefining [custom rules](#custom) for spans and disabled tokens.\n\nTo annotate, click a word or phrase and next the word or phrase you want to\nconnect it to. To remove an existing relationship, you can click its label. In\nthe above example, two coreference relationships are already annotated: \"her\"\n\u0026rarr; \"Lindy\" and \"she\" \u0026rarr; \"Lindy\". Other mentions of \"she\" and \"her\" in\nthe sentence should be carefully annotated as either referring back to \"Lindy\"\nor \"Azaria\". Each relation you annotate will be saved as an entry under the key\n`\"relations\"`.\n\n```json\n### Single relation (example)\n{\n   \"head\": 8,\n   \"head_span\": {\"start\": 38, \"end\": 41, \"token_start\": 8, \"token_end\": 8, \"label\": null},\n   \"child\": 0,\n   \"child_span\": {\"start\": 0, \"end\": 5, \"token_start\": 0, \"token_end\": 0, \"label\": \"PERSON\"},\n   \"label\": \"COREF\",\n}\n```\n\n\u003cAccordion title=\"What's the difference between head and child?\"\u003e\n\nProdigy will record the direction of the relationship, from the \"head\" to the\n\"child\". This is relevant for many tasks like syntactic dependency annotation,\nbut less relevant for tasks like coreference resolution, where you mostly care\nabout pairs of coreference relations. For this use case, you can just treat the\n`\"head\"` and `\"child\"` values of the relation as interchangable and just\nconsider them as one coreference pair.\n\n\u003c/Accordion\u003e\n\n## Custom dependencies and relations {id=\"custom\"}\n\nProdigy's \u003cR\u003erel.manual\u003c/R\u003e recipe allows building very powerful custom\nworkflows for semi-automated dependency and relation annotation. It's based on\nthe following philosophy:\n\n1. **Dependencies should refer to consistent units.** For example, relations\n   might refer to named entities predicted by a named entity recognizer, or noun\n   phrases extracted using part-of-speech tags and syntactic dependency labels.\n   You shouldn't have to ask your annotator to label all of this from scratch,\n   if you can automate it – instead, they should only have to correct mistakes.\n   Using a pretrained model and rules to **pre-highlight spans to annotate** can\n   make data creation faster and more consistent.\n\n2. **Not all tokens are relevant.** For instance, for many tasks, punctuation\n   (outside of entities) is never going to be part of a relation you're\n   annotating. If you're annotating nominal coreference, you only need to focus\n   on nouns, proper nouns and pronouns. Or maybe you only want to annotate\n   relations between entity spans and ignore all other tokens. **Disabling\n   irrelevant tokens** automatically lets you and your annotators focus on what\n   matters, speeds up the process and prevents mistakes.\n\nYou can customize your workflow using the following\n[recipe settings](/docs/recipes#rel-manual):\n\n|                      |                                                                                                           |\n| -------------------- | --------------------------------------------------------------------------------------------------------- |\n| `--label`            | Relation label(s) to annotate manually in relation annotation mode \u003cIcon name=\"prodigy-rels\" /\u003e. |\n| `--span-label`       | Span label(s) to annotate manually in span annotation mode \u003cIcon name=\"prodigy-spans\" /\u003e.        |\n| `--patterns`         | [Match patterns](/docs/api-loaders#input-patterns) defining spans to be added.                            |\n| `--disable-patterns` | [Match patterns](/docs/api-loaders#input-patterns) defining tokens to disable.                            |\n| `--add-ents`         | Add entities predicted by the model as spans.                                                             |\n| `--add-nps`          | Add noun phrases based on tagger and parser, if rules are available.                                      |\n\n### Example: Custom biomedical relation annotation {id=\"example-bio\"}\n\nAnnotating biomedical events from literature is a complex task, and serves as a\ngood example for the relation annotation functionality. Here, we follow the\nannotation scheme from the\n[BioNLP 2011 GENIA Shared Task](http://2011.bionlp-st.org/home/genia-event-extraction-genia),\nwhich has been the foundation of many bio-event extraction algorithms in the\nlast decade and has become a _de facto_ standard. The annotation process\ninvolves the following:\n\n- Annotate spans of one or more tokens describing **genes and gene products**\n  (\"GGPs\"). In the original Shared Task, these were provided as gold\n  annotations.\n- Identify **trigger words or spans** like \"stabilizes\" referring to a positive\n  regulation. There are 9 different relation/event types: gene expression,\n  transcription, protein catabolism, phosphorylation, localization, binding,\n  regulation, positive regulation and negative regulation.\n- Connect trigger words to at least the **object of the event**, also called\n  \"theme\", which is usually a GGP. Binding events can have multiple theme\n  annotations.\n- Connect regulation events to the **subject of the event**, also called\n  \"cause\", if available. For the regulation events, both the \"theme\" and \"cause\"\n  arguments can be GGPs or other events, thus allowing a **nested structure** of\n  events.\n\nFor this example, we have prepared a sample of 200 sentences in\n`bio_events.jsonl`, taken from the Shared Task. As the Shared Task came with\ngold-standard annotations of genes and proteins, we have already added those\n`GGP` spans to the input text. We also know that we're only interested in\n**nouns, proper nouns, verbs and adjectives** or other spans that have been\npre-tagged as `GGP`. So we can write a disable pattern that disables all tokens\nthat do not have those part-of-speech tags and are also not part of the\npre-labelled `GGP` spans.\n\n```json\n### patterns_disable_bio_rel.jsonl\n{\"pattern\": [{\"POS\": {\"NOT_IN\": [\"NOUN\", \"PROPN\", \"VERB\", \"ADJ\"]}, \"_\": {\"label\": {\"NOT_IN\": [\"GGP\"]}}}]}\n```\n\n\u003cInfobox\u003e\n\nSpans that are already present in the data or set by the recipe via `--add-ents`\nor `--add-nps` will receive a custom\n[extension attribute](https://spacy.io/usage/processing-pipelines#custom-components-attributes)\n`label`. You can then address them in your disable patterns via the `\"_\"`\nproperty, as shown in the example above – e.g., to disable all tokens that are\n_not_ part of a certain entity.\n\n\u003c/Infobox\u003e\n\nThe following command will start the web server, stream in the biomedical\nsentences from `bio_events.jsonl`, apply the disable rules, and provide a list\nof relevant span labels as well as the standard relations `Cause` (the subject\nof an event) and `Theme` (the object of an event).\n\n\u003cButton icon=\"download\" href=\"https://raw.githubusercontent.com/explosion/prodigy-recipes/master/example-datasets/bio_events.jsonl\"\u003eDownload bio_events.jsonl\u003c/Button\u003e\n\u003cButton icon=\"download\" href=\"https://raw.githubusercontent.com/explosion/prodigy-recipes/master/example-patterns/patterns_disable_bio_rel.jsonl\"\u003eDownload patterns_disable_bio_rel.jsonl\u003c/Button\u003e\n\n\u003cTerminal title=\"Recipe command\" copy\u003e\n\u003cC\u003eprodigy\u003c/C\u003e\n\u003cC name=\"recipe\"\u003erel.manual\u003c/C\u003e\n\u003cC name=\"dataset\"\u003erel_bio\u003c/C\u003e\n\u003cC name=\"spacy_model\"\u003een_core_web_sm\u003c/C\u003e\n\u003cC name=\"source\"\u003e./bio_events.jsonl\u003c/C\u003e\n\u003cC name=\"label\"\u003e--label Theme,Cause\u003c/C\u003e\n\u003cC name=\"span_label\"\u003e--span-label GGP,Gene_Expr,Transcr,Prot_Cat,Phosph,Loc,Bind,Reg,Reg+,Reg-\u003c/C\u003e\n\u003cC name=\"disable_patterns\"\u003e--disable-patterns patterns_disable_bio_rel.jsonl\u003c/C\u003e\n\u003cC name=\"wrap\"\u003e--wrap\u003c/C\u003e\n\u003c/Terminal\u003e\n\n\u003cProdigyCard view=\"relations\" content={{text:'MdmX stabilizes Mdm2, enabling its activities towards p53.','tokens':[{text:'MdmX',start:0,end:4,id:0},{text:'stabilizes',start:5,end:15,id:1},{text:'Mdm2',start:16,end:20,id:2,ws:false},{text:',',start:20,end:21,id:3,disabled:true},{text:'enabling',start:22,end:30,id:4},{text:'its',start:31,end:34,id:5,disabled:true},{text:'activities',start:35,end:45,id:6},{text:'towards',start:46,end:53,id:7,disabled:true},{text:'p53',start:54,end:57,id:8,ws:false},{text:'.',start:57,end:58,id:9,ws:false,disabled:true}],spans:[{text:'MdmX',start:0,token_start:0,token_end:0,end:4,type:'span',label:'GGP'},{text:'Mdm2',start:16,token_start:2,token_end:2,end:20,type:'span',label:'GGP'},{text:'p53',start:54,token_start:8,token_end:8,end:57,type:'span',label:'GGP'}]}} config={{labels:['Theme','Cause'],relations_span_labels:['GGP','Gene_Expr','Transcr','Prot_Cat','Phosph','Loc','Bind','Reg','Reg+','Reg-'],wrap_relations:true}} /\u003e\n\n1. The BioNLP ST'11 annotation scheme has \"trigger words\" that refer to the span\n   of tokens that expresses a relation. For instance, \"stabilizes\" refers to a\n   positive regulation. You can annotate it as such by going to the **span\n   annotation mode** \u003cIcon name=\"prodigy-spans\" /\u003e, selecting the label\n   `Reg+` and clicking on the token \"stabilizes\". Similarly, annotate \"enabling\"\n   as `Reg+` and \"activities\" as `Reg`.\n\n2. Now select the **relations mode** by clicking the\n   \u003cIcon name=\"prodigy-rels\" /\u003e button. To annotate the first relation,\n   select the relation type \"Cause\", click on the trigger \"stabilizes\" to select\n   it, then on the `GGP` \"Mdmx\" to define it as the subject (cause) of this\n   event. Similarly, you can annotate \"Mdm2\" as being the object of this same\n   event by also connecting it to the \"stabilizes\" trigger with the `Theme`\n   relation type. This relation annotation style allows you to create **nested\n   events**, as one event \"e.g. activities of p53\" could be the `Theme` of\n   another event (\"Mdm2 enabling it\").\n\nThe final annotated task should look like this:\n\n\u003cProdigyCard view=\"relations\" content={{text:'MdmX stabilizes Mdm2, enabling its activities towards p53.','tokens':[{text:'MdmX',start:0,end:4,id:0},{text:'stabilizes',start:5,end:15,id:1},{text:'Mdm2',start:16,end:20,id:2,ws:false},{text:',',start:20,end:21,id:3,disabled:true},{text:'enabling',start:22,end:30,id:4},{text:'its',start:31,end:34,id:5,disabled:true},{text:'activities',start:35,end:45,id:6},{text:'towards',start:46,end:53,id:7,disabled:true},{text:'p53',start:54,end:57,id:8,ws:false},{text:'.',start:57,end:58,id:9,ws:false,disabled:true}],spans:[{text:'MdmX',start:0,token_start:0,token_end:0,end:4,type:'span',label:'GGP'},{text:'stabilizes',start:5,end:15,token_start:1,token_end:1,type:'span',label:'Reg+'},{text:'Mdm2',start:16,token_start:2,token_end:2,end:20,type:'span',label:'GGP'},{text:'enabling',start:22,end:30,token_start:4,token_end:4,type:'span',label:'Reg+'},{text:'activities',start:35,end:45,token_start:6,token_end:6,type:'span',label:'Reg'},{text:'p53',start:54,token_start:8,token_end:8,end:57,type:'span',label:'GGP'}],relations:[{head:1,child:0,head_span:{start:5,end:15,token_start:1,token_end:1,label:'Reg+'},child_span:{start:0,end:4,token_start:0,token_end:0,label:'GGP'},label:'Cause'},{head:1,child:2,head_span:{start:5,end:15,token_start:1,token_end:1,label:'Reg+'},child_span:{start:16,end:20,token_start:2,token_end:2,label:'GGP'},label:'Theme'},{head:4,child:1,head_span:{start:22,end:30,token_start:4,token_end:4,label:'Reg'},child_span:{start:5,end:15,token_start:1,token_end:1,label:'Reg+'},label:'Cause'},{head:4,child:6,head_span:{start:22,end:30,token_start:4,token_end:4,label:'Reg'},child_span:{start:35,end:45,token_start:6,token_end:6,label:'Reg'},label:'Theme'},{head:6,child:2,head_span:{start:35,end:45,token_start:6,token_end:6,label:'Reg'},child_span:{start:16,end:20,token_start:2,token_end:2,label:'GGP'},label:'Cause'},{head:6,child:8,head_span:{start:35,end:45,token_start:6,token_end:6,label:'Reg'},child_span:{start:54,end:57,token_start:8,token_end:8,label:'GGP'},label:'Theme'}]}} config={{labels:['Theme','Cause'],relations_span_labels:['GGP','Gene_Expr','Transcr','Prot_Cat','Phosph','Loc','Bind','Reg','Reg+','Reg-'],wrap_relations:true}} /\u003e\n\nIn an end-to-end setting, you could predict the gene/protein mentions with an\nNER model trained for this challenge specifically, like for instance the models\ntrained on scientific documents from the\n[scispaCy](https://github.com/allenai/scispacy#available-models) project.\n\n## Using a custom model {id=\"custom-model\"}\n\nYou don't need to use spaCy to let a model highlight suggestions for you. Under\nthe hood, the concept is pretty straightforward: if you stream in examples with\npre-defined `\"tokens\"`, `\"relations\"` and optional `\"spans\"`, Prodigy will\naccept and pre-highlight them. This means you can either stream in pre-labelled\ndata, or write a custom recipe that uses your model to add tokens and relations\nto your data.\n\n```json\n### Expected format\n{\n  \"text\": \"I like cute cats\",\n  \"tokens\": [\n    {\"text\": \"I\", \"start\": 0, \"end\": 1, \"id\": 0},\n    {\"text\": \"like\", \"start\": 2, \"end\": 6, \"id\": 1},\n    {\"text\": \"cute\", \"start\": 7, \"end\": 11, \"id\": 2},\n    {\"text\": \"cats\", \"start\": 12, \"end\": 16, \"id\": 3}\n  ],\n  \"relations\": [\n    {\"child\": 0, \"head\": 1, \"label\": \"nsubj\"},\n    {\"child\": 1, \"head\": 1, \"label\": \"ROOT\"},\n    {\"child\": 2, \"head\": 3, \"label\": \"amod\"},\n    {\"child\": 3, \"head\": 1, \"label\": \"dobj\"}\n  ]\n}\n```\n\n\u003cProdigyCard view=\"relations\" content={{text:'I like cute cats','tokens':[{text:'I',start:0,end:1,id:0,ws:true},{text:'like',start:2,end:6,id:1,ws:true},{text:'cute',start:7,end:11,id:2,ws:true},{text:'cats',start:12,end:16,id:3,ws:false}],relations:[{child:0,head:1,label:'nsubj'},{child:1,head:1,label:'ROOT'},{child:2,head:3,label:'amod'},{child:3,head:1,label:'dobj'}]}} config={{labels: ['ROOT','nsubj','amod','dobj'],wrap_relations:true}} /\u003e\n\nFor example, let's say your model returns the syntactic dependencies as a list\nof token-based tags like `[\"nsubj\", \"ROOT\", \"amod\", \"dobj\"]` and head indices\nlike `[1, 1, 3, 1]`. You could then generate your data like this and add a\n`\"head\"`, `\"child\"` and `\"label\"` value for each relation:\n\n```python\n### Step 1: Write the stream generator {pseudo=\"true\"}\ndef add_relations_to_stream(stream):\n   custom_model = load_your_custom_model()\n   for eg in stream:\n      deps, heads = custom_model(eg[\"text\"])\n      eg[\"relations\"] = []\n      for i, (label, head) in enumerate(zip(deps, heads)):\n         eg[\"relations\"].append({\"child\": i, \"head\": head, \"label\": label})\n      yield eg\n```\n\nIf you want to extract and add the dependencies at runtime, you can write a\n[custom recipe](/docs/custom-recipes) that loads the raw data, uses your custom\nmodel to add `\"relations\"` to the stream, pre-tokenizes the text and then\nrenders it all using the \u003cUI\u003erelations\u003c/UI\u003e interface.\n\n```python\n### Step 2: Putting it all together in a recipe {pseudo=\"true\"}\nimport prodigy\nfrom prodigy.components.stream import get_stream\nfrom prodigy.components.preprocess import add_tokens\nimport spacy\n\n@prodigy.recipe(\"custom-dep\")\ndef custom_dep_recipe(dataset, source):\n    stream = get_stream(source)                     # load the data\n    stream = add_relations_to_stream(stream)        # add custom relations\n    stream = add_tokens(spacy.blank(\"en\"), stream)  # add \"tokens\" to stream\n\n    return {\n        \"dataset\": dataset,      # dataset to save annotations to\n        \"stream\": stream,        # the incoming stream of examples\n        \"view_id\": \"relations\",  # annotation interface to use\n        \"labels\": [\"ROOT\", \"nsubj\", \"amod\", \"dobj\"]  # labels to annotate\n    }\n```\n","title":"Dependencies and Relations","newIn":"1.10","next":{"title":"Computer Vision","url":"/docs/computer-vision"},"image":"local_relations.jpg"},"mdxSource":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    p: \"p\",\n    h2: \"h2\",\n    code: \"code\",\n    a: \"a\",\n    ol: \"ol\",\n    li: \"li\",\n    strong: \"strong\",\n    em: \"em\",\n    h3: \"h3\",\n    pre: \"pre\",\n    table: \"table\",\n    thead: \"thead\",\n    tr: \"tr\",\n    th: \"th\",\n    tbody: \"tbody\",\n    td: \"td\",\n    ul: \"ul\"\n  }, _provideComponents(), props.components), {UI, Accordion, R, Button, Terminal, C, ProdigyCard, Infobox, Icon, Kbd, Video} = _components;\n  if (!Accordion) _missingMdxReference(\"Accordion\", true);\n  if (!Button) _missingMdxReference(\"Button\", true);\n  if (!C) _missingMdxReference(\"C\", true);\n  if (!Icon) _missingMdxReference(\"Icon\", true);\n  if (!Infobox) _missingMdxReference(\"Infobox\", true);\n  if (!Kbd) _missingMdxReference(\"Kbd\", true);\n  if (!ProdigyCard) _missingMdxReference(\"ProdigyCard\", true);\n  if (!R) _missingMdxReference(\"R\", true);\n  if (!Terminal) _missingMdxReference(\"Terminal\", true);\n  if (!UI) _missingMdxReference(\"UI\", true);\n  if (!Video) _missingMdxReference(\"Video\", true);\n  return _jsxs(_Fragment, {\n    children: [_jsxs(_components.p, {\n      children: [\"The \", _jsx(UI, {\n        children: \"relations\"\n      }), \" interface can be used for a wide range of classic natural\\nlanguage processing tasks, such as syntactic and semantic dependency parsing,\\ncoreference resolution, or discourse analysis. Relations can be directed or\\nundirected, labelled or unlabelled, and anchored either by single words or\\nphrases. Phrases can be recognised either as a preprocess, or jointly during the\\nrelations annotation.\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      id: \"quickstart\",\n      children: \"Quickstart \"\n    }), \"\\n\", _jsxs(Accordion, {\n      title: \"I want to improve an existing spaCy dependency parsing model.\",\n      children: [_jsxs(_components.p, {\n        children: [\"The \", _jsx(R, {\n          children: \"dep.correct\"\n        }), \" recipe lets you stream in the model’s predictions and\\ncorrect them if needed. You can either annotate all available dependency labels,\\nor focus on a subset of them that you care most about for your specific\\napplication. spaCy can be updated with complete parses, as well as incomplete\\nannotations.\"]\n      }), _jsxs(_components.p, {\n        children: [\"Once you’ve create a dataset, you can use the \", _jsx(R, {\n          children: \"train\"\n        }), \" recipe to update the\\nexisting model with the annotations. You can also use the \", _jsx(R, {\n          children: \"data-to-spacy\"\n        }), \"\\ncommand to convert your annotations to JSON-formatted training data to use with\\n\", _jsx(_components.code, {\n          children: \"spacy train\"\n        }), \".\"]\n      })]\n    }), \"\\n\", _jsxs(Accordion, {\n      title: \"I want to plug in and correct a non-spaCy dependency parser.\",\n      children: [_jsxs(_components.p, {\n        children: [\"Prodigy represents dependency annotations in a\\n\", _jsx(_components.a, {\n          href: \"/docs/api-interfaces#relations\",\n          children: \"simple JSON format\"\n        }), \" with a \", _jsx(_components.code, {\n          children: \"\\\"text\\\"\"\n        }), \", a\\n\", _jsx(_components.code, {\n          children: \"\\\"relations\\\"\"\n        }), \" property describing the head and child indices and label of each\\ndependency relation, and a list of \", _jsx(_components.code, {\n          children: \"\\\"tokens\\\"\"\n        }), \". So you could extract the\\nsuggestions from your model in this format, and then use the \", _jsx(R, {\n          children: \"mark\"\n        }), \" recipe\\nwith \", _jsx(_components.code, {\n          children: \"--view-id relations\"\n        }), \" to label the data exactly as it comes in.\"]\n      }), _jsxs(_components.p, {\n        children: [\"You can also write a \", _jsx(_components.a, {\n          href: \"/docs/custom-recipes\",\n          children: \"custom recipe\"\n        }), \" with a custom stream\\n(a regular Python generator!) to plug in your model. If you can load and run\\nyour model in Python, you can use it with Prodigy. See\\n\", _jsx(_components.a, {\n          href: \"#custom-model\",\n          children: \"the section on custom models\"\n        }), \" for an example. If you want to use\\nactive learning with a custom model, you can make your recipe return an \", _jsx(_components.code, {\n          children: \"update\"\n        }), \"\\ncallback that’s called whenever a new batch of answers is sent back from the web\\napp. However, there are a few more considerations here, like how sensitive your\\nmodel is to small updates.\"]\n      })]\n    }), \"\\n\", _jsx(Accordion, {\n      title: \"I want to annotate entities and relations between them.\",\n      children: _jsxs(_components.p, {\n        children: [\"The \", _jsx(R, {\n          children: \"rel.manual\"\n        }), \" recipe lets you switch between two annotation modes: one\\nfor labeling/correcting entity spans, and one for defining relations between\\nthese spans and/or other tokens. You can also load in data that has been\\npre-annotated with entity spans in Prodigy’s format and annotate relations\\nbetween them, or use a pretrained model to suggest entities for you. For\\ndetails, see the section on \", _jsx(_components.a, {\n          href: \"#ner\",\n          children: \"annotating named entity relations\"\n        }), \".\"]\n      })\n    }), \"\\n\", _jsx(Accordion, {\n      title: \"I want to create training data for coreference resolution.\",\n      children: _jsxs(_components.p, {\n        children: [\"The \", _jsx(R, {\n          children: \"coref.manual\"\n        }), \" recipe incorporates default settings for coreference\\nannotation, such as using the relation label \", _jsx(_components.code, {\n          children: \"COREF\"\n        }), \" and disabling all tokens\\nthat are not nouns, proper nouns or pronouns, and pre-highlighting named\\nentities. You can customize the labels it uses to match your language and model.\\nFor details, see the section on \", _jsx(_components.a, {\n          href: \"#coref\",\n          children: \"annotation coreference relations\"\n        }), \".\"]\n      })\n    }), \"\\n\", _jsxs(Accordion, {\n      title: \"I want to annotate other relations for a custom domain, e.g. biomedical text.\",\n      children: [_jsxs(_components.p, {\n        children: [\"Prodigy’s \", _jsx(R, {\n          children: \"rel.manual\"\n        }), \" recipe allows building very powerful custom\\nworkflows for semi-automated dependency and relation annotation, mixing manual\\nspan labelling and dependency attachment. You can also provide match patterns to\\npre-select and merge spans, or to disable tokens that you know are not going to\\nbe part of a relation you’re looking for.\"]\n      }), _jsxs(_components.p, {\n        children: [\"The \", _jsx(_components.a, {\n          href: \"#example-bio\",\n          children: \"example in this usage guide\"\n        }), \" focuses on annotating biomedical\\nevents from literature, a complex task with multiple annotation objectives using\\nthe\\n\", _jsx(_components.a, {\n          href: \"http://2011.bionlp-st.org/home/genia-event-extraction-genia\",\n          children: \"BioNLP 2011 GENIA Shared Task\"\n        }), \"\\nannotation scheme. A similar strategy can be applied to a variety of custom\\ndomain use cases.\"]\n      })]\n    }), \"\\n\", _jsxs(Accordion, {\n      title: \"I have relations annotations. I want to train a relations model.\",\n      children: [_jsxs(_components.p, {\n        children: [\"Unlike other text recipes, Prodigy’s \", _jsx(_components.code, {\n          children: \"prodigy train\"\n        }), \" and \", _jsx(_components.code, {\n          children: \"data-to-spacy\"\n        }), \" recipes\\ndon’t support \", _jsx(_components.code, {\n          children: \"\\\"relations\\\"\"\n        }), \" annotations. Both recipes depend on spaCy, and spaCy\\ncurrently does not support relation extraction.\"]\n      }), _jsxs(_components.p, {\n        children: [\"However, we’ve created a \", _jsx(_components.a, {\n          href: \"https://www.youtube.com/watch?v=8HL-Ap5_Axo\",\n          children: \"tutorial video\"\n        }), \"\\nand \", _jsx(_components.a, {\n          href: \"https://github.com/explosion/projects/tree/v3/tutorials/rel_component\",\n          children: \"project repository\"\n        }), \"\\nthat shows how you can create a custom trainable component with \", _jsx(_components.code, {\n          children: \"spacy train\"\n        }), \". To\\nadopt to your project, you’ll want to clone the repo, update your annotations, and\\nmodify the \", _jsx(_components.code, {\n          children: \"parse_data.py\"\n        }), \" script to export your annotations to \", _jsx(_components.code, {\n          children: \".spacy\"\n        }), \". For more details,\\nthere are several related \", _jsx(_components.a, {\n          href: \"https://support.prodi.gy/t/5852/4\",\n          children: \"posts\"\n        }), \"\\non \", _jsx(_components.a, {\n          href: \"https://support.prodi.gy\",\n          children: \"Prodigy Support\"\n        }), \". You may also find posts on\\n\", _jsx(_components.a, {\n          href: \"https://github.com/explosion/spaCy/discussions\",\n          children: \"spaCy’s GitHub discussions\"\n        }), \" if you\\nneed help with \", _jsx(_components.code, {\n          children: \"spacy train\"\n        }), \".\"]\n      })]\n    }), \"\\n\", _jsx(_components.h2, {\n      id: \"workflow\",\n      children: \"Choosing the right recipe and workflow \"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"So you have a problem that requires data annotated with relationships between\\nwords and expressions and you want to get it done as efficiently as possible.\\nBut how do you pick the right workflow for your use case?\"\n    }), \"\\n\", _jsxs(_components.ol, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [\"\\n\", _jsxs(_components.p, {\n          children: [_jsx(_components.strong, {\n            children: \"Fully manual:\"\n          }), \" This is the classic approach. You’re shown all tokens in\\nthe text and you annotate labelled relations between them by clicking on\\nthem. The biggest challenge here is to prevent the process from getting too\\nmessy and tedious (and as a result, slower and more error-prone). Unless your\\ngoal is to create a new dependency treebank from scratch, you typically want\\nto use at least \", _jsx(_components.em, {\n            children: \"some\"\n          }), \" automation to merge phrases, disable irrelevant tokens\\nor pre-label some of the data for you. In Prodigy, you can use the\\n\", _jsx(R, {\n            children: \"rel.manual\"\n          }), \" recipe for manual relation annotation, or the more\\ntask-specific \", _jsx(R, {\n            children: \"coref.manual\"\n          }), \" with pre-defined configurations for\\ncoreference annotation.\"]\n        }), \"\\n\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"\\n\", _jsxs(_components.p, {\n          children: [_jsx(_components.strong, {\n            children: \"Manual with suggestions from model:\"\n          }), \" If you already have a model that\\npredicts \", _jsx(_components.em, {\n            children: \"something\"\n          }), \", you can use it to pre-label the data for you, and only\\ncorrect its mistakes. This is especially useful for dependency parsing, where\\nthe data creation from scratch would otherwise be very tedious. Prodigy’s\\n\", _jsx(R, {\n            children: \"dep.correct\"\n          }), \" workflow lets you stream in syntactic dependencies\\npredicted by the model and correct them manually to create gold-standard\\ndata. You can also use a model with \", _jsx(R, {\n            children: \"rel.manual\"\n          }), \" to add named entities\\nand noun phrases.\"]\n        }), \"\\n\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      id: \"dependency-parsing\",\n      children: \"Dependency Parsing \"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"If you already have a pretrained \", _jsx(_components.a, {\n        href: \"/docs/install#spacy-models\",\n        children: \"spaCy pipeline\"\n      }), \"\\nwith a parser and you want to improve it on your own data, you can use the\\nbuilt-in \", _jsx(R, {\n        children: \"dep.correct\"\n      }), \" recipe. You don’t have to annotate all labels at the\\nsame time – it can also be useful to focus on a smaller subset of labels that\\nare most relevant for your application. The following command will start the web\\nserver, stream in headlines from \", _jsx(_components.code, {\n        children: \"news_headlines.jsonl\"\n      }), \" and provide the label\\noptions \", _jsx(_components.code, {\n        children: \"ROOT\"\n      }), \" (root of the sentence), \", _jsx(_components.code, {\n        children: \"csubj\"\n      }), \" (clausal subject), \", _jsx(_components.code, {\n        children: \"nsubj\"\n      }), \"\\n(nominal subject), \", _jsx(_components.code, {\n        children: \"dobj\"\n      }), \" (direct object) and \", _jsx(_components.code, {\n        children: \"pboj\"\n      }), \" (prepositional object).\\nThose labels will vary depending on the label scheme the model was trained with.\"]\n    }), \"\\n\", _jsx(Button, {\n      icon: \"download\",\n      href: \"https://raw.githubusercontent.com/explosion/prodigy-recipes/master/example-datasets/news_headlines.jsonl\",\n      children: \"Download news_headlines.jsonl\"\n    }), \"\\n\", _jsxs(Terminal, {\n      title: \"Recipe command\",\n      copy: true,\n      children: [_jsx(C, {\n        children: \"prodigy\"\n      }), _jsx(C, {\n        name: \"recipe\",\n        children: \"dep.correct\"\n      }), _jsx(C, {\n        name: \"dataset\",\n        children: \"deps_news\"\n      }), _jsx(C, {\n        name: \"spacy_model\",\n        children: \"en_core_web_sm\"\n      }), _jsx(C, {\n        name: \"source\",\n        children: \"./news_headlines.jsonl\"\n      }), _jsx(C, {\n        name: \"label\",\n        children: \"--label ROOT,csubj,nsubj,dobj,pboj\"\n      }), _jsx(C, {\n        name: \"update\",\n        children: \"--update\"\n      })]\n    }), \"\\n\", _jsx(ProdigyCard, {\n      view: \"relations\",\n      content: {\n        text: 'Apple Commits $2.5 Billion to Ease California Housing Crunch',\n        meta: {\n          source: 'The New York Times'\n        },\n        tokens: [{\n          text: 'Apple',\n          start: 0,\n          end: 5,\n          id: 0,\n          ws: true\n        }, {\n          text: 'Commits',\n          start: 6,\n          end: 13,\n          id: 1,\n          ws: true\n        }, {\n          text: '$',\n          start: 14,\n          end: 15,\n          id: 2,\n          ws: false\n        }, {\n          text: '2.5',\n          start: 15,\n          end: 18,\n          id: 3,\n          ws: true\n        }, {\n          text: 'Billion',\n          start: 19,\n          end: 26,\n          id: 4,\n          ws: true\n        }, {\n          text: 'to',\n          start: 27,\n          end: 29,\n          id: 5,\n          ws: true\n        }, {\n          text: 'Ease',\n          start: 30,\n          end: 34,\n          id: 6,\n          ws: true\n        }, {\n          text: 'California',\n          start: 35,\n          end: 45,\n          id: 7,\n          ws: true\n        }, {\n          text: 'Housing',\n          start: 46,\n          end: 53,\n          id: 8,\n          ws: true\n        }, {\n          text: 'Crunch',\n          start: 54,\n          end: 60,\n          id: 9,\n          ws: false\n        }],\n        relations: [{\n          child: 0,\n          head: 1,\n          label: 'nsubj'\n        }, {\n          child: 1,\n          head: 1,\n          label: 'ROOT'\n        }, {\n          child: 4,\n          head: 1,\n          label: 'dobj'\n        }, {\n          child: 9,\n          head: 6,\n          label: 'dobj'\n        }]\n      },\n      config: {\n        labels: ['ROOT', 'csubj', 'nsubj', 'dobj', 'pboj']\n      }\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"In the annotation UI, you can now review the dependency parse and click on\\nincorrectly predicted arcs to remove them, or add new dependencies by selecting\\nthe head token and then the child token to attach it to. The \", _jsx(_components.code, {\n        children: \"ROOT\"\n      }), \" label is the\\nonly one that should be \", _jsx(_components.strong, {\n        children: \"attached to itself\"\n      }), \". You can achieve this in the UI\\nby \", _jsx(_components.strong, {\n        children: \"double-clicking\"\n      }), \" or \", _jsx(_components.strong, {\n        children: \"double-tapping\"\n      }), \" the token.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"When you’re done with annotating, you can use the \", _jsx(R, {\n        children: \"train\"\n      }), \" recipe with the\\ncomponent \", _jsx(_components.code, {\n        children: \"parser\"\n      }), \" to train a dependency parser, or use the \", _jsx(R, {\n        children: \"data-to-spacy\"\n      }), \"\\ncommand to export JSON-formatted training data. You can also use \", _jsx(R, {\n        children: \"db-out\"\n      }), \"\\nto export data in \", _jsx(_components.a, {\n        href: \"/docs/api-interfaces#relations\",\n        children: \"Prodigy’s JSON format\"\n      }), \" and\\nuse it in a different process.\"]\n    }), \"\\n\", _jsxs(Terminal, {\n      title: \"Training command\",\n      copy: true,\n      children: [_jsx(C, {\n        children: \"prodigy\"\n      }), _jsx(C, {\n        name: \"recipe\",\n        children: \"train\"\n      }), _jsx(C, {\n        name: \"output_dir\",\n        children: \"./model\"\n      }), _jsx(C, {\n        name: \"parser\",\n        children: \"--parser dep_news\"\n      })]\n    }), \"\\n\", _jsx(_components.h2, {\n      id: \"ner\",\n      children: \"Combining Named Entity Recognition with relation extraction \"\n    }), \"\\n\", _jsx(Infobox, {\n      variant: \"warning\",\n      children: _jsxs(_components.p, {\n        children: [\"Note that in order to train a model to predict relations between spans, you have\\nto bring \", _jsx(_components.strong, {\n          children: \"your own model implementation\"\n        }), \" and implement your own training.\"]\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"You might already know Prodigy’s features for annotating training data for\\n\", _jsx(_components.a, {\n        href: \"/docs/named-entity-recognition\",\n        children: \"named entity recognition\"\n      }), \". Using a workflow\\nlike \", _jsx(R, {\n        children: \"ner.manual\"\n      }), \", you can stream in your data and highlight entity spans\\nfor a given set of labels. For example, here we’re labelling \", _jsx(_components.code, {\n        children: \"PERSON\"\n      }), \" and \", _jsx(_components.code, {\n        children: \"GPE\"\n      }), \"\\n(geopolitical entity):\"]\n    }), \"\\n\", _jsxs(Terminal, {\n      title: \"Recipe command\",\n      copy: true,\n      children: [_jsx(C, {\n        children: \"prodigy\"\n      }), _jsx(C, {\n        name: \"recipe\",\n        children: \"ner.manual\"\n      }), _jsx(C, {\n        name: \"dataset\",\n        children: \"ner_rels_ent\"\n      }), _jsx(C, {\n        name: \"spacy_model\",\n        children: \"blank:en\"\n      }), _jsx(C, {\n        name: \"source\",\n        children: \"./data.jsonl\"\n      }), _jsx(C, {\n        name: \"label\",\n        children: \"--label PERSON,GPE\"\n      })]\n    }), \"\\n\", _jsx(ProdigyCard, {\n      view: \"ner_manual\",\n      content: {\n        text: 'Obama was born in Hawaii and studied in New York',\n        'tokens': [{\n          text: 'Obama',\n          start: 0,\n          end: 5,\n          id: 0,\n          ws: true\n        }, {\n          text: 'was',\n          start: 6,\n          end: 9,\n          id: 1,\n          ws: true\n        }, {\n          text: 'born',\n          start: 10,\n          end: 14,\n          id: 2,\n          ws: true\n        }, {\n          text: 'in',\n          start: 15,\n          end: 17,\n          id: 3,\n          ws: true\n        }, {\n          text: 'Hawaii',\n          start: 18,\n          end: 24,\n          id: 4,\n          ws: true\n        }, {\n          text: 'and',\n          start: 25,\n          end: 28,\n          id: 5,\n          ws: true\n        }, {\n          text: 'studied',\n          start: 29,\n          end: 36,\n          id: 6,\n          ws: true\n        }, {\n          text: 'in',\n          start: 37,\n          end: 39,\n          id: 7,\n          ws: true\n        }, {\n          text: 'New',\n          start: 40,\n          end: 43,\n          id: 8,\n          ws: true\n        }, {\n          text: 'York',\n          start: 44,\n          end: 48,\n          id: 9,\n          ws: false\n        }],\n        spans: [{\n          start: 0,\n          end: 5,\n          token_start: 0,\n          token_end: 0,\n          label: 'PERSON'\n        }, {\n          start: 18,\n          end: 24,\n          token_start: 4,\n          token_end: 4,\n          label: 'GPE'\n        }, {\n          start: 40,\n          end: 48,\n          token_start: 8,\n          token_end: 9,\n          label: 'GPE'\n        }]\n      },\n      config: {\n        labels: ['PERSON', 'GPE']\n      }\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"While spans can capture a lot of important information – like the concepts that\\nare mentioned in the text – they can’t always capture \", _jsx(_components.strong, {\n        children: \"relationships between\\nthem\"\n      }), \". This requires another layer of data that defines two words or phrases,\\ntypically a “head” and a “child”, and a label specifying the type of\\nrelationship. The \", _jsx(R, {\n        children: \"rel.manual\"\n      }), \" recipe allows you to stream in data that’s\\nalready pre-annotated with named entities. In this case, we’re setting\\n\", _jsx(_components.code, {\n        children: \"dataset:ner_rels_ent\"\n      }), \", which will load the previously annotated data from the\\ndataset \", _jsx(_components.code, {\n        children: \"ner_rels_ent\"\n      }), \". Entities annotated in this dataset will be shown as a\\nmerged unit, and we can assign relations between them and other tokens.\"]\n    }), \"\\n\", _jsxs(Terminal, {\n      title: \"Recipe command\",\n      copy: true,\n      children: [_jsx(C, {\n        children: \"prodigy\"\n      }), _jsx(C, {\n        name: \"recipe\",\n        children: \"rel.manual\"\n      }), _jsx(C, {\n        name: \"dataset\",\n        children: \"ner_rels_dep\"\n      }), _jsx(C, {\n        name: \"spacy_model\",\n        children: \"blank:en\"\n      }), _jsx(C, {\n        name: \"source\",\n        children: \"dataset:ner_rels_ent\"\n      }), _jsx(C, {\n        name: \"label\",\n        children: \"--label SUBJECT,LOCATION\"\n      }), _jsx(C, {\n        name: \"wrap\",\n        children: \"--wrap\"\n      })]\n    }), \"\\n\", _jsx(ProdigyCard, {\n      view: \"relations\",\n      content: {\n        text: 'Obama was born in Hawaii and studied in New York',\n        'tokens': [{\n          text: 'Obama',\n          start: 0,\n          end: 5,\n          id: 0,\n          ws: true\n        }, {\n          text: 'was',\n          start: 6,\n          end: 9,\n          id: 1,\n          ws: true\n        }, {\n          text: 'born',\n          start: 10,\n          end: 14,\n          id: 2,\n          ws: true\n        }, {\n          text: 'in',\n          start: 15,\n          end: 17,\n          id: 3,\n          ws: true\n        }, {\n          text: 'Hawaii',\n          start: 18,\n          end: 24,\n          id: 4,\n          ws: true\n        }, {\n          text: 'and',\n          start: 25,\n          end: 28,\n          id: 5,\n          ws: true\n        }, {\n          text: 'studied',\n          start: 29,\n          end: 36,\n          id: 6,\n          ws: true\n        }, {\n          text: 'in',\n          start: 37,\n          end: 39,\n          id: 7,\n          ws: true\n        }, {\n          text: 'New',\n          start: 40,\n          end: 43,\n          id: 8,\n          ws: true\n        }, {\n          text: 'York',\n          start: 44,\n          end: 48,\n          id: 9,\n          ws: false\n        }],\n        spans: [{\n          start: 0,\n          end: 5,\n          token_start: 0,\n          token_end: 0,\n          label: 'PERSON'\n        }, {\n          start: 18,\n          end: 24,\n          token_start: 4,\n          token_end: 4,\n          label: 'GPE'\n        }, {\n          start: 40,\n          end: 48,\n          token_start: 8,\n          token_end: 9,\n          label: 'GPE'\n        }],\n        relations: [{\n          head: 0,\n          child: 2,\n          head_span: {\n            start: 0,\n            end: 5,\n            token_start: 0,\n            token_end: 0,\n            label: 'ORG'\n          },\n          child_span: {\n            start: 10,\n            end: 14,\n            token_start: 2,\n            token_end: 2,\n            label: null\n          },\n          label: 'SUBJECT'\n        }, {\n          head: 0,\n          child: 6,\n          head_span: {\n            start: 0,\n            end: 5,\n            token_start: 0,\n            token_end: 0,\n            label: 'ORG'\n          },\n          child_span: {\n            start: 29,\n            end: 36,\n            token_start: 6,\n            token_end: 6,\n            label: null\n          },\n          label: 'SUBJECT'\n        }, {\n          head: 2,\n          child: 4,\n          head_span: {\n            start: 10,\n            end: 14,\n            token_start: 2,\n            token_end: 2,\n            label: null\n          },\n          child_span: {\n            start: 18,\n            end: 24,\n            token_start: 4,\n            token_end: 4,\n            label: 'GPE'\n          },\n          label: 'LOCATION'\n        }, {\n          head: 6,\n          child: 9,\n          head_span: {\n            start: 29,\n            end: 36,\n            token_start: 6,\n            token_end: 6,\n            label: null\n          },\n          child_span: {\n            start: 40,\n            end: 48,\n            token_start: 8,\n            token_end: 9,\n            label: 'GPE'\n          },\n          label: 'LOCATION'\n        }]\n      },\n      config: {\n        labels: ['SUBJECT', 'LOCATION'],\n        wrap_relations: true\n      }\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Instead of loading in a pre-annotated dataset, you can also use an existing\\npretrained model to add entities for you. Here we’re using the \", _jsx(_components.code, {\n        children: \"en_core_web_sm\"\n      }), \"\\nmodel and the original raw input data, and set the \", _jsx(_components.code, {\n        children: \"--add-ents\"\n      }), \" flag to include\\nentities found in the text. For more options and how to add custom\\npreprocessing, see the section on \", _jsx(_components.a, {\n        href: \"#custom\",\n        children: \"custom relations\"\n      }), \".\"]\n    }), \"\\n\", _jsxs(Terminal, {\n      title: \"Recipe command\",\n      copy: true,\n      children: [_jsx(C, {\n        children: \"prodigy\"\n      }), _jsx(C, {\n        name: \"recipe\",\n        children: \"rel.manual\"\n      }), _jsx(C, {\n        name: \"dataset\",\n        children: \"ner_rels_dep\"\n      }), _jsx(C, {\n        name: \"spacy_model\",\n        children: \"en_core_web_sm\"\n      }), _jsx(C, {\n        name: \"source\",\n        children: \"./data.jsonl\"\n      }), _jsx(C, {\n        name: \"label\",\n        children: \"--label SUBJECT,LOCATION\"\n      }), _jsx(C, {\n        name: \"add_ents\",\n        children: \"--add-ents\"\n      }), _jsx(C, {\n        name: \"wrap\",\n        children: \"--wrap\"\n      })]\n    }), \"\\n\", _jsx(_components.h3, {\n      id: \"ner-joint\",\n      children: \"Joint entity and relation annotation \"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"For some use cases, it makes sense to do entity and relation annotation \", _jsx(_components.strong, {\n        children: \"at the\\nsame time\"\n      }), \". That’s especially true if the annotation decision for both spans\\nand relations requires the same thought process, or if it’s difficult to\\nseparate both tasks. In that case, you can pass an additional \", _jsx(_components.code, {\n        children: \"--span-label\"\n      }), \"\\nargument to \", _jsx(R, {\n        children: \"rel.manual\"\n      }), \" defining the entity labels to assign. The\\ninterface now has two modes: the relation annotation mode\\n\", _jsx(Icon, {\n        name: \"prodigy-rels\"\n      }), \" to connect tokens and spans, and the span\\nannotation mode \", _jsx(Icon, {\n        name: \"prodigy-spans\"\n      }), \" to manually highlight and\\nedit spans. To add a span, click and drag across the tokens, or hold down\\n\", _jsx(Kbd, {\n        children: \"shift\"\n      }), \" and click on the start and end token.\"]\n    }), \"\\n\", _jsxs(Terminal, {\n      title: \"Recipe command\",\n      copy: true,\n      children: [_jsx(C, {\n        children: \"prodigy\"\n      }), _jsx(C, {\n        name: \"recipe\",\n        children: \"rel.manual\"\n      }), _jsx(C, {\n        name: \"dataset\",\n        children: \"ner_rels\"\n      }), _jsx(C, {\n        name: \"spacy_model\",\n        children: \"blank:en\"\n      }), _jsx(C, {\n        name: \"source\",\n        children: \"./data.jsonl\"\n      }), _jsx(C, {\n        name: \"label\",\n        children: \"--label SUBJECT,LOCATION\"\n      }), _jsx(C, {\n        name: \"span_label\",\n        children: \"--span-label PERSON,GPE\"\n      })]\n    }), \"\\n\", _jsx(ProdigyCard, {\n      view: \"relations\",\n      content: {\n        text: 'Obama was born in Hawaii and studied in New York',\n        'tokens': [{\n          text: 'Obama',\n          start: 0,\n          end: 5,\n          id: 0,\n          ws: true\n        }, {\n          text: 'was',\n          start: 6,\n          end: 9,\n          id: 1,\n          ws: true\n        }, {\n          text: 'born',\n          start: 10,\n          end: 14,\n          id: 2,\n          ws: true\n        }, {\n          text: 'in',\n          start: 15,\n          end: 17,\n          id: 3,\n          ws: true\n        }, {\n          text: 'Hawaii',\n          start: 18,\n          end: 24,\n          id: 4,\n          ws: true\n        }, {\n          text: 'and',\n          start: 25,\n          end: 28,\n          id: 5,\n          ws: true\n        }, {\n          text: 'studied',\n          start: 29,\n          end: 36,\n          id: 6,\n          ws: true\n        }, {\n          text: 'in',\n          start: 37,\n          end: 39,\n          id: 7,\n          ws: true\n        }, {\n          text: 'New',\n          start: 40,\n          end: 43,\n          id: 8,\n          ws: true\n        }, {\n          text: 'York',\n          start: 44,\n          end: 48,\n          id: 9,\n          ws: false\n        }]\n      },\n      config: {\n        labels: ['SUBJECT', 'LOCATION'],\n        relations_span_labels: ['PERSON', 'GPE'],\n        wrap_relations: false\n      }\n    }), \"\\n\", _jsxs(_components.ol, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [\"\\n\", _jsxs(_components.p, {\n          children: [\"Choose the \", _jsx(_components.strong, {\n            children: \"span highlighting mode\"\n          }), \" by clicking the\\n\", _jsx(Icon, {\n            name: \"prodigy-spans\"\n          }), \" button. This will let you manually\\nhighlight spans or remove existing spans.\"]\n        }), \"\\n\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"\\n\", _jsxs(_components.p, {\n          children: [\"Drag across the token “Obama” or click on it to \", _jsx(_components.strong, {\n            children: \"assign it the label\"\n          }), \"\\n\", _jsx(_components.code, {\n            children: \"PERSON\"\n          }), \". Then select the label \", _jsx(_components.code, {\n            children: \"GPE\"\n          }), \" (geopolitical entity) at the top and do\\nthe same for “Hawaii” and “New York”. To select multiple tokens, drag across\\nthem and they will turn green, indicating the selection is valid. If you make\\na mistake, click on the span and then on the\\n\", _jsx(Icon, {\n            name: \"prodigy-delete\"\n          }), \" button to remove it.\"]\n        }), \"\\n\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"\\n\", _jsxs(_components.p, {\n          children: [\"Choose the \", _jsx(_components.strong, {\n            children: \"relations mode\"\n          }), \" by clicking the\\n\", _jsx(Icon, {\n            name: \"prodigy-rels\"\n          }), \" button. This will let you select tokens\\nor spans and assign relations to them.\"]\n        }), \"\\n\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"\\n\", _jsxs(_components.p, {\n          children: [\"Click “Obama” and then “born” to \", _jsx(_components.strong, {\n            children: \"assign it the relation\"\n          }), \" \", _jsx(_components.code, {\n            children: \"SUBJECT\"\n          }), \" and do\\nthe same for “Obama” and “studied”. Then select the label \", _jsx(_components.code, {\n            children: \"LOCATION\"\n          }), \" at the\\ntop and connect “born” and “Hawaii” and then “studied” and “New York”.\"]\n        }), \"\\n\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(Video, {\n      src: \"/docs/annotation_relations.mp4\",\n      width: 800,\n      height: 340\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"If you have a pretrained model that already predicts \", _jsx(_components.em, {\n        children: \"something\"\n      }), \", you can also\\nset the \", _jsx(_components.code, {\n        children: \"--add-ents\"\n      }), \" flag to pre-highlight entities suggested by the model for\\nyou. You can then delete incorrect spans or change their label and add missing\\nspans if needed.\"]\n    }), \"\\n\", _jsxs(Terminal, {\n      title: \"Recipe command\",\n      copy: true,\n      children: [_jsx(C, {\n        children: \"prodigy\"\n      }), _jsx(C, {\n        name: \"recipe\",\n        children: \"rel.manual\"\n      }), _jsx(C, {\n        name: \"dataset\",\n        children: \"ner_rels\"\n      }), _jsx(C, {\n        name: \"spacy_model\",\n        children: \"blank:en\"\n      }), _jsx(C, {\n        name: \"source\",\n        children: \"./data.jsonl\"\n      }), _jsx(C, {\n        name: \"label\",\n        children: \"--label SUBJECT,LOCATION\"\n      }), _jsx(C, {\n        name: \"span_label\",\n        children: \"--span-label PERSON,GPE\"\n      }), _jsx(C, {\n        name: \"wrap\",\n        children: \"--wrap\"\n      }), _jsx(C, {\n        name: \"add_ents\",\n        children: \"--add-ents\"\n      })]\n    }), \"\\n\", _jsxs(Infobox, {\n      title: \"When to annotate jointly vs. separately\",\n      variant: \"warning\",\n      children: [_jsxs(_components.p, {\n        children: [\"While it’s tempting to have everything annotated in one step, it can make the\\ndata collection process more consistent to split the annotation for different\\naspects into their own separate steps. If you’re annotating relations between\\nspans, the span boundaries can matter \", _jsx(_components.em, {\n          children: \"a lot\"\n        }), \" and inconsistencies can lead to\\nlower data quality for \", _jsx(_components.em, {\n          children: \"both\"\n        }), \" tasks. It can therefore help to \", _jsx(_components.strong, {\n          children: \"annotate and\\nreview entities first\"\n        }), \" and only add relations once you know that the data is\\ncorrect and consistent.\"]\n      }), _jsxs(_components.p, {\n        children: [\"If spans and relations don’t \", _jsx(_components.em, {\n          children: \"have to\"\n        }), \" be annotated at the same time, it can\\nalso make it easier for the annotators to \", _jsx(_components.strong, {\n          children: \"focus on one objective at a time\"\n        }), \".\\nThis reduces the steps per completed annotation and the cognitive load, which\\ncan also help prevent careless mistakes.\"]\n      })]\n    }), \"\\n\", _jsx(_components.h2, {\n      id: \"coref\",\n      children: \"Coreference Resolution \"\n    }), \"\\n\", _jsx(Infobox, {\n      variant: \"warning\",\n      children: _jsxs(_components.p, {\n        children: [\"Note that a coreference model is not yet a part of spaCy core. While you can\\ncreate coref annotations using Prodigy by itself, to export them with the\\n\", _jsx(_components.code, {\n          children: \"data-to-spacy\"\n        }), \" command you’ll need to install\\n\", _jsx(_components.a, {\n          href: \"https://github.com/explosion/spacy-experimental/\",\n          children: \"spacy-experimental\"\n        }), \" version\\n0.6.1 or higher.\"]\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Coreference resolution is the challenge of linking ambiguous mentions such as\\n“her” or “that woman” back to an antecedent providing more context about the\\nentity in question. You can use the built-in \", _jsx(R, {\n        children: \"coref.manual\"\n      }), \" recipe to\\nmanually create such links. This recipe allows you to \", _jsx(_components.strong, {\n        children: \"focus on nouns, proper\\nnouns and pronouns specifically\"\n      }), \", by disabling all other tokens. The following\\ncommand will start the web server, stream in movie summaries from\\n\", _jsx(_components.code, {\n        children: \"plot_summaries.jsonl\"\n      }), \" and provide the label \", _jsx(_components.code, {\n        children: \"COREF\"\n      }), \" to annotate coreference\\nrelations.\"]\n    }), \"\\n\", _jsx(Button, {\n      icon: \"download\",\n      href: \"https://raw.githubusercontent.com/explosion/prodigy-recipes/master/example-datasets/plot_summaries.jsonl\",\n      children: \"Download plot_summaries.jsonl\"\n    }), \"\\n\", _jsxs(Terminal, {\n      title: \"Recipe command\",\n      copy: true,\n      children: [_jsx(C, {\n        children: \"prodigy\"\n      }), _jsx(C, {\n        name: \"recipe\",\n        children: \"coref.manual\"\n      }), _jsx(C, {\n        name: \"dataset\",\n        children: \"coref_movies\"\n      }), _jsx(C, {\n        name: \"spacy_model\",\n        children: \"en_core_web_sm\"\n      }), _jsx(C, {\n        name: \"source\",\n        children: \"./plot_summaries.jsonl\"\n      }), _jsx(C, {\n        name: \"label\",\n        children: \"--label COREF\"\n      })]\n    }), \"\\n\", _jsx(ProdigyCard, {\n      view: \"relations\",\n      content: {\n        text: 'Lindy returns to the tent to check on her daughter Azaria and is certain she sees a dingo with something in its mouth running off as she approaches. When she discovers the infant is missing, everyone joins forces to search for her, without success.',\n        'tokens': [{\n          text: 'Lindy',\n          start: 0,\n          end: 5,\n          id: 0\n        }, {\n          text: 'returns',\n          start: 6,\n          end: 13,\n          id: 1,\n          disabled: true\n        }, {\n          text: 'to',\n          start: 14,\n          end: 16,\n          id: 2,\n          disabled: true\n        }, {\n          text: 'the',\n          start: 17,\n          end: 20,\n          id: 3\n        }, {\n          text: 'tent',\n          start: 21,\n          end: 25,\n          id: 4\n        }, {\n          text: 'to',\n          start: 26,\n          end: 28,\n          id: 5,\n          disabled: true\n        }, {\n          text: 'check',\n          start: 29,\n          end: 34,\n          id: 6,\n          disabled: true\n        }, {\n          text: 'on',\n          start: 35,\n          end: 37,\n          id: 7,\n          disabled: true\n        }, {\n          text: 'her',\n          start: 38,\n          end: 41,\n          id: 8\n        }, {\n          text: 'daughter',\n          start: 42,\n          end: 50,\n          id: 9\n        }, {\n          text: 'Azaria',\n          start: 51,\n          end: 57,\n          id: 10\n        }, {\n          text: 'and',\n          start: 58,\n          end: 61,\n          id: 11,\n          disabled: true\n        }, {\n          text: 'is',\n          start: 62,\n          end: 64,\n          id: 12,\n          disabled: true\n        }, {\n          text: 'certain',\n          start: 65,\n          end: 72,\n          id: 13,\n          disabled: true\n        }, {\n          text: 'she',\n          start: 73,\n          end: 76,\n          id: 14\n        }, {\n          text: 'sees',\n          start: 77,\n          end: 81,\n          id: 15,\n          disabled: true\n        }, {\n          text: 'a',\n          start: 82,\n          end: 83,\n          id: 16\n        }, {\n          text: 'dingo',\n          start: 84,\n          end: 89,\n          id: 17\n        }, {\n          text: 'with',\n          start: 90,\n          end: 94,\n          id: 18,\n          disabled: true\n        }, {\n          text: 'something',\n          start: 95,\n          end: 104,\n          id: 19\n        }, {\n          text: 'in',\n          start: 105,\n          end: 107,\n          id: 20,\n          disabled: true\n        }, {\n          text: 'its',\n          start: 108,\n          end: 111,\n          id: 21\n        }, {\n          text: 'mouth',\n          start: 112,\n          end: 117,\n          id: 22\n        }, {\n          text: 'running',\n          start: 118,\n          end: 125,\n          id: 23,\n          disabled: true\n        }, {\n          text: 'off',\n          start: 126,\n          end: 129,\n          id: 24,\n          disabled: true\n        }, {\n          text: 'as',\n          start: 130,\n          end: 132,\n          id: 25,\n          disabled: true\n        }, {\n          text: 'she',\n          start: 133,\n          end: 136,\n          id: 26\n        }, {\n          text: 'approaches',\n          start: 137,\n          end: 147,\n          id: 27,\n          ws: false,\n          disabled: true\n        }, {\n          text: '.',\n          start: 147,\n          end: 148,\n          id: 28,\n          disabled: true\n        }, {\n          text: 'When',\n          start: 149,\n          end: 153,\n          id: 29,\n          disabled: true\n        }, {\n          text: 'she',\n          start: 154,\n          end: 157,\n          id: 30\n        }, {\n          text: 'discovers',\n          start: 158,\n          end: 167,\n          id: 31,\n          disabled: true\n        }, {\n          text: 'the',\n          start: 168,\n          end: 171,\n          id: 32\n        }, {\n          text: 'infant',\n          start: 172,\n          end: 178,\n          id: 33\n        }, {\n          text: 'is',\n          start: 179,\n          end: 181,\n          id: 34,\n          disabled: true\n        }, {\n          text: 'missing',\n          start: 182,\n          end: 189,\n          id: 35,\n          ws: false,\n          disabled: true\n        }, {\n          text: ',',\n          start: 189,\n          end: 190,\n          id: 36,\n          disabled: true\n        }, {\n          text: 'everyone',\n          start: 191,\n          end: 199,\n          id: 37\n        }, {\n          text: 'joins',\n          start: 200,\n          end: 205,\n          id: 38,\n          disabled: true\n        }, {\n          text: 'forces',\n          start: 206,\n          end: 212,\n          id: 39\n        }, {\n          text: 'to',\n          start: 213,\n          end: 215,\n          id: 40,\n          disabled: true\n        }, {\n          text: 'search',\n          start: 216,\n          end: 222,\n          id: 41,\n          disabled: true\n        }, {\n          text: 'for',\n          start: 223,\n          end: 226,\n          id: 42,\n          disabled: true\n        }, {\n          text: 'her',\n          start: 227,\n          end: 230,\n          id: 43,\n          ws: false\n        }, {\n          text: ',',\n          start: 230,\n          end: 231,\n          id: 44,\n          disabled: true\n        }, {\n          text: 'without',\n          start: 232,\n          end: 239,\n          id: 45,\n          disabled: true\n        }, {\n          text: 'success',\n          start: 240,\n          end: 247,\n          id: 46,\n          ws: false\n        }, {\n          text: '.',\n          start: 247,\n          end: 248,\n          id: 47,\n          ws: false,\n          disabled: true\n        }],\n        spans: [{\n          text: 'Lindy',\n          start: 0,\n          token_start: 0,\n          token_end: 0,\n          end: 5,\n          type: 'ent',\n          label: 'PERSON'\n        }, {\n          text: 'the tent',\n          start: 17,\n          token_start: 3,\n          token_end: 4,\n          end: 25,\n          type: 'pattern',\n          label: 'NP'\n        }, {\n          text: 'daughter',\n          start: 42,\n          token_start: 9,\n          token_end: 9,\n          end: 50,\n          type: 'pattern',\n          label: 'NP'\n        }, {\n          text: 'Azaria',\n          start: 51,\n          token_start: 10,\n          token_end: 10,\n          end: 57,\n          type: 'ent',\n          label: 'PERSON'\n        }, {\n          text: 'a dingo',\n          start: 82,\n          token_start: 16,\n          token_end: 17,\n          end: 89,\n          type: 'pattern',\n          label: 'NP'\n        }, {\n          text: 'mouth',\n          start: 112,\n          token_start: 22,\n          token_end: 22,\n          end: 117,\n          type: 'pattern',\n          label: 'NP'\n        }, {\n          text: 'the infant',\n          start: 168,\n          token_start: 32,\n          token_end: 33,\n          end: 178,\n          type: 'pattern',\n          label: 'NP'\n        }, {\n          text: 'forces',\n          start: 206,\n          token_start: 39,\n          token_end: 39,\n          end: 212,\n          type: 'pattern',\n          label: 'NP'\n        }, {\n          text: 'success',\n          start: 240,\n          token_start: 46,\n          token_end: 46,\n          end: 247,\n          type: 'pattern',\n          label: 'NP'\n        }],\n        relations: [{\n          head: 8,\n          child: 0,\n          label: 'COREF'\n        }, {\n          head: 14,\n          child: 0,\n          label: 'COREF'\n        }]\n      },\n      config: {\n        labels: ['COREF'],\n        wrap_relations: true,\n        hide_relations_arrow: true\n      }\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The recipe will use the model to automatically detect potential candidates for a\\ncoreference relationship. You can customize the labels used for the extraction\\nvia the \", _jsx(_components.a, {\n        href: \"/docs/recipes#coref-manual\",\n        children: \"recipe arguments\"\n      }), \" to match the model you’re\\nusing. You can also set up your very own custom relation annotation workflow by\\ndefining \", _jsx(_components.a, {\n        href: \"#custom\",\n        children: \"custom rules\"\n      }), \" for spans and disabled tokens.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"To annotate, click a word or phrase and next the word or phrase you want to\\nconnect it to. To remove an existing relationship, you can click its label. In\\nthe above example, two coreference relationships are already annotated: “her”\\n→ “Lindy” and “she” → “Lindy”. Other mentions of “she” and “her” in\\nthe sentence should be carefully annotated as either referring back to “Lindy”\\nor “Azaria”. Each relation you annotate will be saved as an entry under the key\\n\", _jsx(_components.code, {\n        children: \"\\\"relations\\\"\"\n      }), \".\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-json\",\n        lang: \"json\",\n        title: \"Single relation (example)\",\n        children: \"{\\n   \\\"head\\\": 8,\\n   \\\"head_span\\\": {\\\"start\\\": 38, \\\"end\\\": 41, \\\"token_start\\\": 8, \\\"token_end\\\": 8, \\\"label\\\": null},\\n   \\\"child\\\": 0,\\n   \\\"child_span\\\": {\\\"start\\\": 0, \\\"end\\\": 5, \\\"token_start\\\": 0, \\\"token_end\\\": 0, \\\"label\\\": \\\"PERSON\\\"},\\n   \\\"label\\\": \\\"COREF\\\",\\n}\\n\"\n      })\n    }), \"\\n\", _jsx(Accordion, {\n      title: \"What's the difference between head and child?\",\n      children: _jsxs(_components.p, {\n        children: [\"Prodigy will record the direction of the relationship, from the “head” to the\\n“child”. This is relevant for many tasks like syntactic dependency annotation,\\nbut less relevant for tasks like coreference resolution, where you mostly care\\nabout pairs of coreference relations. For this use case, you can just treat the\\n\", _jsx(_components.code, {\n          children: \"\\\"head\\\"\"\n        }), \" and \", _jsx(_components.code, {\n          children: \"\\\"child\\\"\"\n        }), \" values of the relation as interchangable and just\\nconsider them as one coreference pair.\"]\n      })\n    }), \"\\n\", _jsx(_components.h2, {\n      id: \"custom\",\n      children: \"Custom dependencies and relations \"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Prodigy’s \", _jsx(R, {\n        children: \"rel.manual\"\n      }), \" recipe allows building very powerful custom\\nworkflows for semi-automated dependency and relation annotation. It’s based on\\nthe following philosophy:\"]\n    }), \"\\n\", _jsxs(_components.ol, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [\"\\n\", _jsxs(_components.p, {\n          children: [_jsx(_components.strong, {\n            children: \"Dependencies should refer to consistent units.\"\n          }), \" For example, relations\\nmight refer to named entities predicted by a named entity recognizer, or noun\\nphrases extracted using part-of-speech tags and syntactic dependency labels.\\nYou shouldn’t have to ask your annotator to label all of this from scratch,\\nif you can automate it – instead, they should only have to correct mistakes.\\nUsing a pretrained model and rules to \", _jsx(_components.strong, {\n            children: \"pre-highlight spans to annotate\"\n          }), \" can\\nmake data creation faster and more consistent.\"]\n        }), \"\\n\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"\\n\", _jsxs(_components.p, {\n          children: [_jsx(_components.strong, {\n            children: \"Not all tokens are relevant.\"\n          }), \" For instance, for many tasks, punctuation\\n(outside of entities) is never going to be part of a relation you’re\\nannotating. If you’re annotating nominal coreference, you only need to focus\\non nouns, proper nouns and pronouns. Or maybe you only want to annotate\\nrelations between entity spans and ignore all other tokens. \", _jsx(_components.strong, {\n            children: \"Disabling\\nirrelevant tokens\"\n          }), \" automatically lets you and your annotators focus on what\\nmatters, speeds up the process and prevents mistakes.\"]\n        }), \"\\n\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"You can customize your workflow using the following\\n\", _jsx(_components.a, {\n        href: \"/docs/recipes#rel-manual\",\n        children: \"recipe settings\"\n      }), \":\"]\n    }), \"\\n\", _jsxs(_components.table, {\n      children: [_jsx(_components.thead, {\n        children: _jsxs(_components.tr, {\n          children: [_jsx(_components.th, {}), _jsx(_components.th, {})]\n        })\n      }), _jsxs(_components.tbody, {\n        children: [_jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"--label\"\n            })\n          }), _jsxs(_components.td, {\n            children: [\"Relation label(s) to annotate manually in relation annotation mode \", _jsx(Icon, {\n              name: \"prodigy-rels\"\n            }), \".\"]\n          })]\n        }), _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"--span-label\"\n            })\n          }), _jsxs(_components.td, {\n            children: [\"Span label(s) to annotate manually in span annotation mode \", _jsx(Icon, {\n              name: \"prodigy-spans\"\n            }), \".\"]\n          })]\n        }), _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"--patterns\"\n            })\n          }), _jsxs(_components.td, {\n            children: [_jsx(_components.a, {\n              href: \"/docs/api-loaders#input-patterns\",\n              children: \"Match patterns\"\n            }), \" defining spans to be added.\"]\n          })]\n        }), _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"--disable-patterns\"\n            })\n          }), _jsxs(_components.td, {\n            children: [_jsx(_components.a, {\n              href: \"/docs/api-loaders#input-patterns\",\n              children: \"Match patterns\"\n            }), \" defining tokens to disable.\"]\n          })]\n        }), _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"--add-ents\"\n            })\n          }), _jsx(_components.td, {\n            children: \"Add entities predicted by the model as spans.\"\n          })]\n        }), _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"--add-nps\"\n            })\n          }), _jsx(_components.td, {\n            children: \"Add noun phrases based on tagger and parser, if rules are available.\"\n          })]\n        })]\n      })]\n    }), \"\\n\", _jsx(_components.h3, {\n      id: \"example-bio\",\n      children: \"Example: Custom biomedical relation annotation \"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Annotating biomedical events from literature is a complex task, and serves as a\\ngood example for the relation annotation functionality. Here, we follow the\\nannotation scheme from the\\n\", _jsx(_components.a, {\n        href: \"http://2011.bionlp-st.org/home/genia-event-extraction-genia\",\n        children: \"BioNLP 2011 GENIA Shared Task\"\n      }), \",\\nwhich has been the foundation of many bio-event extraction algorithms in the\\nlast decade and has become a \", _jsx(_components.em, {\n        children: \"de facto\"\n      }), \" standard. The annotation process\\ninvolves the following:\"]\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [\"Annotate spans of one or more tokens describing \", _jsx(_components.strong, {\n          children: \"genes and gene products\"\n        }), \"\\n(“GGPs”). In the original Shared Task, these were provided as gold\\nannotations.\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"Identify \", _jsx(_components.strong, {\n          children: \"trigger words or spans\"\n        }), \" like “stabilizes” referring to a positive\\nregulation. There are 9 different relation/event types: gene expression,\\ntranscription, protein catabolism, phosphorylation, localization, binding,\\nregulation, positive regulation and negative regulation.\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"Connect trigger words to at least the \", _jsx(_components.strong, {\n          children: \"object of the event\"\n        }), \", also called\\n“theme”, which is usually a GGP. Binding events can have multiple theme\\nannotations.\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"Connect regulation events to the \", _jsx(_components.strong, {\n          children: \"subject of the event\"\n        }), \", also called\\n“cause”, if available. For the regulation events, both the “theme” and “cause”\\narguments can be GGPs or other events, thus allowing a \", _jsx(_components.strong, {\n          children: \"nested structure\"\n        }), \" of\\nevents.\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"For this example, we have prepared a sample of 200 sentences in\\n\", _jsx(_components.code, {\n        children: \"bio_events.jsonl\"\n      }), \", taken from the Shared Task. As the Shared Task came with\\ngold-standard annotations of genes and proteins, we have already added those\\n\", _jsx(_components.code, {\n        children: \"GGP\"\n      }), \" spans to the input text. We also know that we’re only interested in\\n\", _jsx(_components.strong, {\n        children: \"nouns, proper nouns, verbs and adjectives\"\n      }), \" or other spans that have been\\npre-tagged as \", _jsx(_components.code, {\n        children: \"GGP\"\n      }), \". So we can write a disable pattern that disables all tokens\\nthat do not have those part-of-speech tags and are also not part of the\\npre-labelled \", _jsx(_components.code, {\n        children: \"GGP\"\n      }), \" spans.\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-json\",\n        lang: \"json\",\n        title: \"patterns_disable_bio_rel.jsonl\",\n        children: \"{\\\"pattern\\\": [{\\\"POS\\\": {\\\"NOT_IN\\\": [\\\"NOUN\\\", \\\"PROPN\\\", \\\"VERB\\\", \\\"ADJ\\\"]}, \\\"_\\\": {\\\"label\\\": {\\\"NOT_IN\\\": [\\\"GGP\\\"]}}}]}\\n\"\n      })\n    }), \"\\n\", _jsx(Infobox, {\n      children: _jsxs(_components.p, {\n        children: [\"Spans that are already present in the data or set by the recipe via \", _jsx(_components.code, {\n          children: \"--add-ents\"\n        }), \"\\nor \", _jsx(_components.code, {\n          children: \"--add-nps\"\n        }), \" will receive a custom\\n\", _jsx(_components.a, {\n          href: \"https://spacy.io/usage/processing-pipelines#custom-components-attributes\",\n          children: \"extension attribute\"\n        }), \"\\n\", _jsx(_components.code, {\n          children: \"label\"\n        }), \". You can then address them in your disable patterns via the \", _jsx(_components.code, {\n          children: \"\\\"_\\\"\"\n        }), \"\\nproperty, as shown in the example above – e.g., to disable all tokens that are\\n\", _jsx(_components.em, {\n          children: \"not\"\n        }), \" part of a certain entity.\"]\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The following command will start the web server, stream in the biomedical\\nsentences from \", _jsx(_components.code, {\n        children: \"bio_events.jsonl\"\n      }), \", apply the disable rules, and provide a list\\nof relevant span labels as well as the standard relations \", _jsx(_components.code, {\n        children: \"Cause\"\n      }), \" (the subject\\nof an event) and \", _jsx(_components.code, {\n        children: \"Theme\"\n      }), \" (the object of an event).\"]\n    }), \"\\n\", _jsx(Button, {\n      icon: \"download\",\n      href: \"https://raw.githubusercontent.com/explosion/prodigy-recipes/master/example-datasets/bio_events.jsonl\",\n      children: \"Download bio_events.jsonl\"\n    }), \"\\n\", _jsx(Button, {\n      icon: \"download\",\n      href: \"https://raw.githubusercontent.com/explosion/prodigy-recipes/master/example-patterns/patterns_disable_bio_rel.jsonl\",\n      children: \"Download patterns_disable_bio_rel.jsonl\"\n    }), \"\\n\", _jsxs(Terminal, {\n      title: \"Recipe command\",\n      copy: true,\n      children: [_jsx(C, {\n        children: \"prodigy\"\n      }), _jsx(C, {\n        name: \"recipe\",\n        children: \"rel.manual\"\n      }), _jsx(C, {\n        name: \"dataset\",\n        children: \"rel_bio\"\n      }), _jsx(C, {\n        name: \"spacy_model\",\n        children: \"en_core_web_sm\"\n      }), _jsx(C, {\n        name: \"source\",\n        children: \"./bio_events.jsonl\"\n      }), _jsx(C, {\n        name: \"label\",\n        children: \"--label Theme,Cause\"\n      }), _jsx(C, {\n        name: \"span_label\",\n        children: \"--span-label GGP,Gene_Expr,Transcr,Prot_Cat,Phosph,Loc,Bind,Reg,Reg+,Reg-\"\n      }), _jsx(C, {\n        name: \"disable_patterns\",\n        children: \"--disable-patterns patterns_disable_bio_rel.jsonl\"\n      }), _jsx(C, {\n        name: \"wrap\",\n        children: \"--wrap\"\n      })]\n    }), \"\\n\", _jsx(ProdigyCard, {\n      view: \"relations\",\n      content: {\n        text: 'MdmX stabilizes Mdm2, enabling its activities towards p53.',\n        'tokens': [{\n          text: 'MdmX',\n          start: 0,\n          end: 4,\n          id: 0\n        }, {\n          text: 'stabilizes',\n          start: 5,\n          end: 15,\n          id: 1\n        }, {\n          text: 'Mdm2',\n          start: 16,\n          end: 20,\n          id: 2,\n          ws: false\n        }, {\n          text: ',',\n          start: 20,\n          end: 21,\n          id: 3,\n          disabled: true\n        }, {\n          text: 'enabling',\n          start: 22,\n          end: 30,\n          id: 4\n        }, {\n          text: 'its',\n          start: 31,\n          end: 34,\n          id: 5,\n          disabled: true\n        }, {\n          text: 'activities',\n          start: 35,\n          end: 45,\n          id: 6\n        }, {\n          text: 'towards',\n          start: 46,\n          end: 53,\n          id: 7,\n          disabled: true\n        }, {\n          text: 'p53',\n          start: 54,\n          end: 57,\n          id: 8,\n          ws: false\n        }, {\n          text: '.',\n          start: 57,\n          end: 58,\n          id: 9,\n          ws: false,\n          disabled: true\n        }],\n        spans: [{\n          text: 'MdmX',\n          start: 0,\n          token_start: 0,\n          token_end: 0,\n          end: 4,\n          type: 'span',\n          label: 'GGP'\n        }, {\n          text: 'Mdm2',\n          start: 16,\n          token_start: 2,\n          token_end: 2,\n          end: 20,\n          type: 'span',\n          label: 'GGP'\n        }, {\n          text: 'p53',\n          start: 54,\n          token_start: 8,\n          token_end: 8,\n          end: 57,\n          type: 'span',\n          label: 'GGP'\n        }]\n      },\n      config: {\n        labels: ['Theme', 'Cause'],\n        relations_span_labels: ['GGP', 'Gene_Expr', 'Transcr', 'Prot_Cat', 'Phosph', 'Loc', 'Bind', 'Reg', 'Reg+', 'Reg-'],\n        wrap_relations: true\n      }\n    }), \"\\n\", _jsxs(_components.ol, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [\"\\n\", _jsxs(_components.p, {\n          children: [\"The BioNLP ST’11 annotation scheme has “trigger words” that refer to the span\\nof tokens that expresses a relation. For instance, “stabilizes” refers to a\\npositive regulation. You can annotate it as such by going to the \", _jsx(_components.strong, {\n            children: \"span\\nannotation mode\"\n          }), \" \", _jsx(Icon, {\n            name: \"prodigy-spans\"\n          }), \", selecting the label\\n\", _jsx(_components.code, {\n            children: \"Reg+\"\n          }), \" and clicking on the token “stabilizes”. Similarly, annotate “enabling”\\nas \", _jsx(_components.code, {\n            children: \"Reg+\"\n          }), \" and “activities” as \", _jsx(_components.code, {\n            children: \"Reg\"\n          }), \".\"]\n        }), \"\\n\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"\\n\", _jsxs(_components.p, {\n          children: [\"Now select the \", _jsx(_components.strong, {\n            children: \"relations mode\"\n          }), \" by clicking the\\n\", _jsx(Icon, {\n            name: \"prodigy-rels\"\n          }), \" button. To annotate the first relation,\\nselect the relation type “Cause”, click on the trigger “stabilizes” to select\\nit, then on the \", _jsx(_components.code, {\n            children: \"GGP\"\n          }), \" “Mdmx” to define it as the subject (cause) of this\\nevent. Similarly, you can annotate “Mdm2” as being the object of this same\\nevent by also connecting it to the “stabilizes” trigger with the \", _jsx(_components.code, {\n            children: \"Theme\"\n          }), \"\\nrelation type. This relation annotation style allows you to create \", _jsx(_components.strong, {\n            children: \"nested\\nevents\"\n          }), \", as one event “e.g. activities of p53” could be the \", _jsx(_components.code, {\n            children: \"Theme\"\n          }), \" of\\nanother event (“Mdm2 enabling it”).\"]\n        }), \"\\n\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"The final annotated task should look like this:\"\n    }), \"\\n\", _jsx(ProdigyCard, {\n      view: \"relations\",\n      content: {\n        text: 'MdmX stabilizes Mdm2, enabling its activities towards p53.',\n        'tokens': [{\n          text: 'MdmX',\n          start: 0,\n          end: 4,\n          id: 0\n        }, {\n          text: 'stabilizes',\n          start: 5,\n          end: 15,\n          id: 1\n        }, {\n          text: 'Mdm2',\n          start: 16,\n          end: 20,\n          id: 2,\n          ws: false\n        }, {\n          text: ',',\n          start: 20,\n          end: 21,\n          id: 3,\n          disabled: true\n        }, {\n          text: 'enabling',\n          start: 22,\n          end: 30,\n          id: 4\n        }, {\n          text: 'its',\n          start: 31,\n          end: 34,\n          id: 5,\n          disabled: true\n        }, {\n          text: 'activities',\n          start: 35,\n          end: 45,\n          id: 6\n        }, {\n          text: 'towards',\n          start: 46,\n          end: 53,\n          id: 7,\n          disabled: true\n        }, {\n          text: 'p53',\n          start: 54,\n          end: 57,\n          id: 8,\n          ws: false\n        }, {\n          text: '.',\n          start: 57,\n          end: 58,\n          id: 9,\n          ws: false,\n          disabled: true\n        }],\n        spans: [{\n          text: 'MdmX',\n          start: 0,\n          token_start: 0,\n          token_end: 0,\n          end: 4,\n          type: 'span',\n          label: 'GGP'\n        }, {\n          text: 'stabilizes',\n          start: 5,\n          end: 15,\n          token_start: 1,\n          token_end: 1,\n          type: 'span',\n          label: 'Reg+'\n        }, {\n          text: 'Mdm2',\n          start: 16,\n          token_start: 2,\n          token_end: 2,\n          end: 20,\n          type: 'span',\n          label: 'GGP'\n        }, {\n          text: 'enabling',\n          start: 22,\n          end: 30,\n          token_start: 4,\n          token_end: 4,\n          type: 'span',\n          label: 'Reg+'\n        }, {\n          text: 'activities',\n          start: 35,\n          end: 45,\n          token_start: 6,\n          token_end: 6,\n          type: 'span',\n          label: 'Reg'\n        }, {\n          text: 'p53',\n          start: 54,\n          token_start: 8,\n          token_end: 8,\n          end: 57,\n          type: 'span',\n          label: 'GGP'\n        }],\n        relations: [{\n          head: 1,\n          child: 0,\n          head_span: {\n            start: 5,\n            end: 15,\n            token_start: 1,\n            token_end: 1,\n            label: 'Reg+'\n          },\n          child_span: {\n            start: 0,\n            end: 4,\n            token_start: 0,\n            token_end: 0,\n            label: 'GGP'\n          },\n          label: 'Cause'\n        }, {\n          head: 1,\n          child: 2,\n          head_span: {\n            start: 5,\n            end: 15,\n            token_start: 1,\n            token_end: 1,\n            label: 'Reg+'\n          },\n          child_span: {\n            start: 16,\n            end: 20,\n            token_start: 2,\n            token_end: 2,\n            label: 'GGP'\n          },\n          label: 'Theme'\n        }, {\n          head: 4,\n          child: 1,\n          head_span: {\n            start: 22,\n            end: 30,\n            token_start: 4,\n            token_end: 4,\n            label: 'Reg'\n          },\n          child_span: {\n            start: 5,\n            end: 15,\n            token_start: 1,\n            token_end: 1,\n            label: 'Reg+'\n          },\n          label: 'Cause'\n        }, {\n          head: 4,\n          child: 6,\n          head_span: {\n            start: 22,\n            end: 30,\n            token_start: 4,\n            token_end: 4,\n            label: 'Reg'\n          },\n          child_span: {\n            start: 35,\n            end: 45,\n            token_start: 6,\n            token_end: 6,\n            label: 'Reg'\n          },\n          label: 'Theme'\n        }, {\n          head: 6,\n          child: 2,\n          head_span: {\n            start: 35,\n            end: 45,\n            token_start: 6,\n            token_end: 6,\n            label: 'Reg'\n          },\n          child_span: {\n            start: 16,\n            end: 20,\n            token_start: 2,\n            token_end: 2,\n            label: 'GGP'\n          },\n          label: 'Cause'\n        }, {\n          head: 6,\n          child: 8,\n          head_span: {\n            start: 35,\n            end: 45,\n            token_start: 6,\n            token_end: 6,\n            label: 'Reg'\n          },\n          child_span: {\n            start: 54,\n            end: 57,\n            token_start: 8,\n            token_end: 8,\n            label: 'GGP'\n          },\n          label: 'Theme'\n        }]\n      },\n      config: {\n        labels: ['Theme', 'Cause'],\n        relations_span_labels: ['GGP', 'Gene_Expr', 'Transcr', 'Prot_Cat', 'Phosph', 'Loc', 'Bind', 'Reg', 'Reg+', 'Reg-'],\n        wrap_relations: true\n      }\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"In an end-to-end setting, you could predict the gene/protein mentions with an\\nNER model trained for this challenge specifically, like for instance the models\\ntrained on scientific documents from the\\n\", _jsx(_components.a, {\n        href: \"https://github.com/allenai/scispacy#available-models\",\n        children: \"scispaCy\"\n      }), \" project.\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      id: \"custom-model\",\n      children: \"Using a custom model \"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"You don’t need to use spaCy to let a model highlight suggestions for you. Under\\nthe hood, the concept is pretty straightforward: if you stream in examples with\\npre-defined \", _jsx(_components.code, {\n        children: \"\\\"tokens\\\"\"\n      }), \", \", _jsx(_components.code, {\n        children: \"\\\"relations\\\"\"\n      }), \" and optional \", _jsx(_components.code, {\n        children: \"\\\"spans\\\"\"\n      }), \", Prodigy will\\naccept and pre-highlight them. This means you can either stream in pre-labelled\\ndata, or write a custom recipe that uses your model to add tokens and relations\\nto your data.\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-json\",\n        lang: \"json\",\n        title: \"Expected format\",\n        children: \"{\\n  \\\"text\\\": \\\"I like cute cats\\\",\\n  \\\"tokens\\\": [\\n    {\\\"text\\\": \\\"I\\\", \\\"start\\\": 0, \\\"end\\\": 1, \\\"id\\\": 0},\\n    {\\\"text\\\": \\\"like\\\", \\\"start\\\": 2, \\\"end\\\": 6, \\\"id\\\": 1},\\n    {\\\"text\\\": \\\"cute\\\", \\\"start\\\": 7, \\\"end\\\": 11, \\\"id\\\": 2},\\n    {\\\"text\\\": \\\"cats\\\", \\\"start\\\": 12, \\\"end\\\": 16, \\\"id\\\": 3}\\n  ],\\n  \\\"relations\\\": [\\n    {\\\"child\\\": 0, \\\"head\\\": 1, \\\"label\\\": \\\"nsubj\\\"},\\n    {\\\"child\\\": 1, \\\"head\\\": 1, \\\"label\\\": \\\"ROOT\\\"},\\n    {\\\"child\\\": 2, \\\"head\\\": 3, \\\"label\\\": \\\"amod\\\"},\\n    {\\\"child\\\": 3, \\\"head\\\": 1, \\\"label\\\": \\\"dobj\\\"}\\n  ]\\n}\\n\"\n      })\n    }), \"\\n\", _jsx(ProdigyCard, {\n      view: \"relations\",\n      content: {\n        text: 'I like cute cats',\n        'tokens': [{\n          text: 'I',\n          start: 0,\n          end: 1,\n          id: 0,\n          ws: true\n        }, {\n          text: 'like',\n          start: 2,\n          end: 6,\n          id: 1,\n          ws: true\n        }, {\n          text: 'cute',\n          start: 7,\n          end: 11,\n          id: 2,\n          ws: true\n        }, {\n          text: 'cats',\n          start: 12,\n          end: 16,\n          id: 3,\n          ws: false\n        }],\n        relations: [{\n          child: 0,\n          head: 1,\n          label: 'nsubj'\n        }, {\n          child: 1,\n          head: 1,\n          label: 'ROOT'\n        }, {\n          child: 2,\n          head: 3,\n          label: 'amod'\n        }, {\n          child: 3,\n          head: 1,\n          label: 'dobj'\n        }]\n      },\n      config: {\n        labels: ['ROOT', 'nsubj', 'amod', 'dobj'],\n        wrap_relations: true\n      }\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"For example, let’s say your model returns the syntactic dependencies as a list\\nof token-based tags like \", _jsx(_components.code, {\n        children: \"[\\\"nsubj\\\", \\\"ROOT\\\", \\\"amod\\\", \\\"dobj\\\"]\"\n      }), \" and head indices\\nlike \", _jsx(_components.code, {\n        children: \"[1, 1, 3, 1]\"\n      }), \". You could then generate your data like this and add a\\n\", _jsx(_components.code, {\n        children: \"\\\"head\\\"\"\n      }), \", \", _jsx(_components.code, {\n        children: \"\\\"child\\\"\"\n      }), \" and \", _jsx(_components.code, {\n        children: \"\\\"label\\\"\"\n      }), \" value for each relation:\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-python\",\n        lang: \"python\",\n        title: \"Step 1: Write the stream generator\",\n        pseudo: \"true\",\n        children: \"def add_relations_to_stream(stream):\\n   custom_model = load_your_custom_model()\\n   for eg in stream:\\n      deps, heads = custom_model(eg[\\\"text\\\"])\\n      eg[\\\"relations\\\"] = []\\n      for i, (label, head) in enumerate(zip(deps, heads)):\\n         eg[\\\"relations\\\"].append({\\\"child\\\": i, \\\"head\\\": head, \\\"label\\\": label})\\n      yield eg\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"If you want to extract and add the dependencies at runtime, you can write a\\n\", _jsx(_components.a, {\n        href: \"/docs/custom-recipes\",\n        children: \"custom recipe\"\n      }), \" that loads the raw data, uses your custom\\nmodel to add \", _jsx(_components.code, {\n        children: \"\\\"relations\\\"\"\n      }), \" to the stream, pre-tokenizes the text and then\\nrenders it all using the \", _jsx(UI, {\n        children: \"relations\"\n      }), \" interface.\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-python\",\n        lang: \"python\",\n        title: \"Step 2: Putting it all together in a recipe\",\n        pseudo: \"true\",\n        children: \"import prodigy\\nfrom prodigy.components.stream import get_stream\\nfrom prodigy.components.preprocess import add_tokens\\nimport spacy\\n\\n@prodigy.recipe(\\\"custom-dep\\\")\\ndef custom_dep_recipe(dataset, source):\\n    stream = get_stream(source)                     # load the data\\n    stream = add_relations_to_stream(stream)        # add custom relations\\n    stream = add_tokens(spacy.blank(\\\"en\\\"), stream)  # add \\\"tokens\\\" to stream\\n\\n    return {\\n        \\\"dataset\\\": dataset,      # dataset to save annotations to\\n        \\\"stream\\\": stream,        # the incoming stream of examples\\n        \\\"view_id\\\": \\\"relations\\\",  # annotation interface to use\\n        \\\"labels\\\": [\\\"ROOT\\\", \\\"nsubj\\\", \\\"amod\\\", \\\"dobj\\\"]  # labels to annotate\\n    }\\n\"\n      })\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\nfunction _missingMdxReference(id, component) {\n  throw new Error(\"Expected \" + (component ? \"component\" : \"object\") + \" `\" + id + \"` to be defined: you likely forgot to import, pass, or provide it.\");\n}\n","frontmatter":{},"scope":{}}},"__N_SSG":true},"page":"/docs/[id]","query":{"id":"dependencies-relations"},"buildId":"IUmjHA5LMQ1eQb0MNTwvU","isFallback":false,"gsp":true,"scriptLoader":[{"src":"https://transactions.sendowl.com/assets/sendowl.js","strategy":"afterInteractive"}]}</script></body></html>